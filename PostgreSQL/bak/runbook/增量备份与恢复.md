# Runbook：增量备份与恢复（PostgreSQL 17.x 占位）

## 目标

利用 `pg_basebackup` 增量能力与归档 WAL，构建可演练的恢复流程。

## 前置

- 配置归档（archive_mode、archive_command）、保留策略、监控告警。

## 步骤（示意）

1. 基础全量备份：`pg_basebackup -D /data/base -X stream -P`
2. 记录起始 LSN：`SELECT pg_current_wal_lsn();`
3. 增量备份（占位）：基于起始/结束 LSN 的增量区段与归档 WAL 一并保存
4. 恢复：准备 `postgresql.auto.conf`、`recovery.signal`，设置 `restore_command`
5. 目标恢复：按 LSN/时间点/名义标记（占位）
6. 验证：一致性校验、业务校验、RTO/RPO 记录

## 验证清单

- 备份可读、校验通过（hash/大小/目录结构）
- 恢复后系统一致（系统表与业务表计数/抽样对比）
- 监控事件完整（备份时长、WAL 量、错误日志）
- RTO/RPO 达标并留存记录

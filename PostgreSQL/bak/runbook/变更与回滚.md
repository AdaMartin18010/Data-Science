# Runbook：变更与回滚（PostgreSQL 17.x 占位）

## 范围

参数变更、DDL 变更、索引/分区变更、版本升级小步推进。

## 原则

- 蓝绿/金丝雀：优先对读流量试点，逐步扩大
- 可回滚：保留旧结构与数据路径、影子索引/表
- 可观测：标准化前后指标对比

## 流程（示意）

1) 评审：影响评估、回滚路径、验证计划
2) 变更窗口：只读期/低峰期，冻结长事务
3) 执行：分批、幂等脚本、错误即停
4) 验证：功能/性能/一致性；若失败走回滚

## 回滚策略（示例）

- 参数：保存原配置并可一键恢复
- DDL：保留旧对象，使用视图或触发器桥接
- 索引：在线创建，新旧并存，切换后旧索引回收

## 检查清单（占位）

- 变更脚本已干跑（非生产）且通过
- 受影响对象与依赖清单已确认（视图/触发器/函数/订阅）
- 监控看板与门限已设定（前/中/后对比）
- 回滚脚本与步骤已校验

## 演练频率（建议）

- 月度：常规参数与索引调整演练
- 季度：DDL 结构性变更与跨版本升级预演

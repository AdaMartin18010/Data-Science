# PostgreSQL文档格式规范

**版本**: 1.0
**发布日期**: 2025-10-30
**状态**: 正式发布

---

## 1. 概述

本规范定义了PostgreSQL知识库所有技术文档的统一格式标准，确保文档结构清晰、导航便捷、易于维护。

---

## 2. 文档结构规范

### 2.1 必需元素

每个技术文档必须包含以下元素（按顺序）：

1. **文档标题** (H1)
2. **目录** (H2)
3. **正文内容** (H2-H6)
4. **相关链接** (H2，可选)

### 2.2 标题层级

```markdown
# 文档标题 (H1) - 仅一个

## 1. 第一个主题 (H2) - 使用数字序号
### 1.1 子主题 (H3) - 两级序号
#### 1.1.1 详细内容 (H4) - 三级序号
##### 1.1.1.1 更细节 (H5) - 四级序号

## 2. 第二个主题 (H2)
### 2.1 子主题 (H3)
### 2.2 另一个子主题 (H3)

## 3. 第三个主题 (H2)
```

### 2.3 序号规则

- **H2级别**: 必须使用数字序号 `## 1.`、`## 2.`、`## 3.`
- **H3级别**: 必须使用两级序号 `### 1.1`、`### 1.2`
- **H4级别**: 使用三级序号 `#### 1.1.1`
- **H5级别及以下**: 可选四级序号或使用 `-` 列表

---

## 3. 目录生成规范

### 3.1 目录位置

目录应放在文档标题（H1）之后的第一个位置：

```markdown
# 文档标题

## 目录

- [1. 第一个主题](#1-第一个主题)
  - [1.1 子主题](#11-子主题)
  - [1.2 另一个子主题](#12-另一个子主题)
- [2. 第二个主题](#2-第二个主题)
  - [2.1 子主题](#21-子主题)
- [3. 相关链接](#3-相关链接)

## 1. 第一个主题
...
```

### 3.2 目录深度

- **默认深度**: 显示到H3级别（两级序号）
- **复杂文档**: 可显示到H4级别（三级序号）
- **简单文档**: 可仅显示H2级别

### 3.3 锚点生成规则

GitHub Markdown锚点规则：

- 转为小写
- 空格替换为 `-`
- 移除特殊字符
- 中文保持原样

示例：

- `## 1. 概述` → `#1-概述`
- `### 1.1 系统架构` → `#11-系统架构`
- `#### 1.1.1 核心组件` → `#111-核心组件`

---

## 4. 文档模板

### 4.1 标准技术文档模板

```markdown
# 文档标题

## 目录

- [1. 概述](#1-概述)
  - [1.1 背景](#11-背景)
  - [1.2 适用场景](#12-适用场景)
- [2. 核心概念](#2-核心概念)
  - [2.1 基本概念](#21-基本概念)
  - [2.2 关键术语](#22-关键术语)
- [3. 技术详解](#3-技术详解)
  - [3.1 实现原理](#31-实现原理)
  - [3.2 配置方法](#32-配置方法)
- [4. 实践示例](#4-实践示例)
  - [4.1 基础示例](#41-基础示例)
  - [4.2 高级用法](#42-高级用法)
- [5. 性能优化](#5-性能优化)
  - [5.1 优化策略](#51-优化策略)
  - [5.2 监控指标](#52-监控指标)
- [6. 最佳实践](#6-最佳实践)
- [7. 故障排查](#7-故障排查)
- [8. 相关链接](#8-相关链接)
  - [8.1 内部链接](#81-内部链接)
  - [8.2 外部资源](#82-外部资源)

## 1. 概述

### 1.1 背景

文档背景介绍...

### 1.2 适用场景

适用场景说明...

## 2. 核心概念

### 2.1 基本概念

核心概念定义...

### 2.2 关键术语

术语列表...

## 3. 技术详解

### 3.1 实现原理

```sql
-- 代码示例
SELECT * FROM example;
```

### 3.2 配置方法

配置步骤...

## 4. 实践示例

### 4.1 基础示例

示例代码...

### 4.2 高级用法

高级示例...

## 5. 性能优化

### 5.1 优化策略

优化建议...

### 5.2 监控指标

监控方法...

## 6. 最佳实践

- 实践建议1
- 实践建议2
- 实践建议3

## 7. 故障排查

常见问题和解决方案...

## 8. 相关链接

### 8.1 内部链接

- [相关文档1](../path/to/doc1.md)
- [相关文档2](../path/to/doc2.md)

### 8.2 外部资源

- [PostgreSQL官方文档](https://www.postgresql.org/docs/)
- [相关博客文章](https://example.com)

---

**最后更新**: 2025-10-30
**文档状态**: 完成
**版本**: 1.0

```

### 4.2 实战案例文档模板

```markdown
# 项目名称 - 端到端实现

## 目录

- [1. 项目概述](#1-项目概述)
  - [1.1 项目目标](#11-项目目标)
  - [1.2 技术栈](#12-技术栈)
  - [1.3 项目结构](#13-项目结构)
- [2. 环境准备](#2-环境准备)
  - [2.1 系统要求](#21-系统要求)
  - [2.2 依赖安装](#22-依赖安装)
- [3. 数据库设计](#3-数据库设计)
  - [3.1 表结构](#31-表结构)
  - [3.2 索引设计](#32-索引设计)
- [4. 后端实现](#4-后端实现)
  - [4.1 API设计](#41-api设计)
  - [4.2 核心功能](#42-核心功能)
- [5. 前端实现](#5-前端实现)
- [6. 部署配置](#6-部署配置)
  - [6.1 Docker配置](#61-docker配置)
  - [6.2 环境变量](#62-环境变量)
- [7. 测试与验证](#7-测试与验证)
- [8. 性能优化](#8-性能优化)
- [9. 监控与运维](#9-监控与运维)
- [10. 相关资源](#10-相关资源)

## 1. 项目概述

项目介绍...

### 1.1 项目目标

### 1.2 技术栈

### 1.3 项目结构

## 2. 环境准备
...

## 10. 相关资源

### 10.1 源代码

### 10.2 相关文档

---

**项目状态**: 生产就绪
**最后更新**: 2025-10-30
**维护者**: Team Name
```

---

## 5. 内容编写规范

### 5.1 代码块

使用语言标识的代码块：

````markdown
```sql
-- SQL示例
SELECT * FROM users WHERE active = true;
```

```python
# Python示例
def example_function():
    return "Hello, World!"
```

```bash
# Shell命令
docker-compose up -d
```
````

### 5.2 表格

使用Markdown表格：

```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| 值1 | 值2 | 值3 |
| 值4 | 值5 | 值6 |
```

### 5.3 列表

**无序列表**：

```markdown
- 项目1
- 项目2
  - 子项目2.1
  - 子项目2.2
- 项目3
```

**有序列表**：

```markdown
1. 第一步
2. 第二步
3. 第三步
```

### 5.4 强调

- **粗体**: `**重要内容**`
- _斜体_: `*强调内容*`
- `代码`: `` `inline code` ``

### 5.5 链接

- 内部链接: `[链接文本](../path/to/file.md)`
- 外部链接: `[链接文本](https://example.com)`
- 锚点链接: `[链接文本](#section-name)`

---

## 6. 文档分类与命名

### 6.1 文件命名规范

**格式**: `XX.YY-主题名称.md`

- `XX`: 目录编号（01-08）
- `YY`: 文件序号（01-99）
- 主题名称: 使用中文，简洁明确

示例：

- `01.01-系统架构与设计原理.md`
- `05.04-RAG架构实战指南.md`
- `06.01-语义搜索系统端到端实现.md`

### 6.2 目录组织

```
00-项目导航/    - 导航、索引、模板
01-核心基础/    - 基础概念和原理
02-查询处理/    - 查询优化相关
03-高级特性/    - 高级功能特性
04-部署运维/    - 部署和运维
05-前沿技术/    - AI、RAG等前沿
06-实战案例/    - 完整项目案例
07-应用实践/    - 应用场景实践
08-工具资源/    - 工具和资源
```

---

## 7. 质量检查清单

### 7.1 结构检查

- [ ] 有清晰的H1标题
- [ ] 有完整的目录
- [ ] 所有H2标题有数字序号
- [ ] 所有H3标题有两级序号
- [ ] 目录链接与标题对应
- [ ] 章节编号连续无跳跃

### 7.2 内容检查

- [ ] 概述清晰
- [ ] 示例代码可运行
- [ ] 链接有效
- [ ] 图表清晰
- [ ] 术语准确

### 7.3 格式检查

- [ ] 代码块有语言标识
- [ ] 表格格式正确
- [ ] 列表缩进正确
- [ ] 无拼写错误
- [ ] 标点符号规范

---

## 8. 批量处理工具

### 8.1 目录生成脚本

```python
#!/usr/bin/env python3
"""
自动生成Markdown文档目录
"""
import re
import sys

def generate_toc(content):
    """生成目录"""
    toc_lines = ["## 目录\n"]
    lines = content.split('\n')

    for line in lines:
        # 匹配 ## 1. 标题 或 ### 1.1 标题
        match = re.match(r'^(#{2,4})\s+(\d+(?:\.\d+)*)\s+(.+)$', line)
        if match:
            level = len(match.group(1))
            number = match.group(2)
            title = match.group(3)

            # 生成锚点
            anchor = f"{number}-{title}".lower().replace(' ', '-')
            anchor = re.sub(r'[^\w\-\u4e00-\u9fa5]', '', anchor)

            # 生成缩进
            indent = '  ' * (level - 2)

            # 添加到目录
            toc_lines.append(f"{indent}- [{number} {title}](#{anchor})")

    return '\n'.join(toc_lines) + '\n'

def add_toc_to_file(filepath):
    """为文件添加目录"""
    with open(filepath, 'r', encoding='utf-8') as f:
        content = f.read()

    # 检查是否已有目录
    if '## 目录' in content:
        print(f"文件已有目录: {filepath}")
        return

    # 生成目录
    toc = generate_toc(content)

    # 插入目录（在第一个H1标题后）
    lines = content.split('\n')
    insert_pos = 0
    for i, line in enumerate(lines):
        if line.startswith('# '):
            insert_pos = i + 1
            break

    lines.insert(insert_pos, '\n' + toc)

    # 写回文件
    with open(filepath, 'w', encoding='utf-8') as f:
        f.write('\n'.join(lines))

    print(f"已添加目录: {filepath}")

if __name__ == '__main__':
    if len(sys.argv) > 1:
        add_toc_to_file(sys.argv[1])
    else:
        print("用法: python add_toc.py <文件路径>")
```

### 8.2 使用方法

```bash
# 为单个文件添加目录
python add_toc.py 01-核心基础/01.01-系统架构与设计原理.md

# 批量处理目录下所有文件
find 01-核心基础 -name "*.md" -exec python add_toc.py {} \;
```

---

## 9. 维护指南

### 9.1 定期检查

- **每月**: 检查链接有效性
- **每季度**: 更新过时内容
- **每半年**: 审查文档结构

### 9.2 更新流程

1. 修改内容
2. 更新目录（如需要）
3. 更新"最后更新"时间
4. 提交变更

### 9.3 版本控制

- 重大更新: 版本号+1.0
- 内容更新: 版本号+0.1
- 格式修正: 版本号+0.01

---

## 10. 相关资源

### 10.1 内部文档

- [统一内容模板](./统一内容模板.md)
- [README主文档](../README.md)
- [INDEX索引](../INDEX.md)

### 10.2 Markdown指南

- [GitHub Markdown规范](https://guides.github.com/features/mastering-markdown/)
- [Markdown语法速查](https://www.markdownguide.org/cheat-sheet/)

---

**文档版本**: 1.0
**发布日期**: 2025-10-30
**维护者**: Documentation Team
**审核状态**: 已批准

# æ•°æ®åˆ†æä¸ä½¿ç”¨æŒ‡å—ï¼šæ•°æ®åº“è®¾è®¡çš„å®è·µåº”ç”¨

> **åˆ›å»ºæ—¥æœŸ**ï¼š2025-01-15
> **æœ€åæ›´æ–°**ï¼š2025-12-01
> **ç‰ˆæœ¬**ï¼šv2.0 (å¢å¼ºç‰ˆ)
> **çŠ¶æ€**ï¼šå·²å®Œæˆ âœ…

---

## ğŸ“‹ ç›®å½•

- [æ•°æ®åˆ†æä¸ä½¿ç”¨æŒ‡å—ï¼šæ•°æ®åº“è®¾è®¡çš„å®è·µåº”ç”¨](#æ•°æ®åˆ†æä¸ä½¿ç”¨æŒ‡å—æ•°æ®åº“è®¾è®¡çš„å®è·µåº”ç”¨)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1. æ•°æ®åˆ†æå±‚æ¬¡](#11-æ•°æ®åˆ†æå±‚æ¬¡)
    - [1.2. æ•°æ®ä½¿ç”¨å†³ç­–æ ‘](#12-æ•°æ®ä½¿ç”¨å†³ç­–æ ‘)
  - [2. æ•°æ®åˆ†ææ–¹æ³•](#2-æ•°æ®åˆ†ææ–¹æ³•)
    - [2.1. æ•°æ®æ¢ç´¢](#21-æ•°æ®æ¢ç´¢)
    - [2.2. ç»Ÿè®¡åˆ†æ](#22-ç»Ÿè®¡åˆ†æ)
    - [2.3. æ•°æ®åˆ†æå†³ç­–æ ‘](#23-æ•°æ®åˆ†æå†³ç­–æ ‘)
  - [3. æŸ¥è¯¢è®¾è®¡](#3-æŸ¥è¯¢è®¾è®¡)
    - [3.1. æŸ¥è¯¢æ¨¡å¼è¯†åˆ«](#31-æŸ¥è¯¢æ¨¡å¼è¯†åˆ«)
    - [3.2. æŸ¥è¯¢ä¼˜åŒ–](#32-æŸ¥è¯¢ä¼˜åŒ–)
    - [3.3. æŸ¥è¯¢è®¾è®¡å†³ç­–æ ‘](#33-æŸ¥è¯¢è®¾è®¡å†³ç­–æ ‘)
  - [4. æ€§èƒ½ä¼˜åŒ–](#4-æ€§èƒ½ä¼˜åŒ–)
    - [4.1. ç´¢å¼•ä¼˜åŒ–](#41-ç´¢å¼•ä¼˜åŒ–)
    - [4.2. æŸ¥è¯¢ä¼˜åŒ–](#42-æŸ¥è¯¢ä¼˜åŒ–)
    - [4.3. æ€§èƒ½ç›‘æ§](#43-æ€§èƒ½ç›‘æ§)
  - [5. æ•°æ®ä½¿ç”¨æ¨¡å¼](#5-æ•°æ®ä½¿ç”¨æ¨¡å¼)
    - [5.1. OLTPæ¨¡å¼](#51-oltpæ¨¡å¼)
    - [5.2. OLAPæ¨¡å¼](#52-olapæ¨¡å¼)
    - [5.3. æ··åˆæ¨¡å¼](#53-æ··åˆæ¨¡å¼)
  - [6. æœ€ä½³å®è·µ](#6-æœ€ä½³å®è·µ)
    - [6.1. æŸ¥è¯¢æœ€ä½³å®è·µ](#61-æŸ¥è¯¢æœ€ä½³å®è·µ)
    - [6.2. æ•°æ®åˆ†ææœ€ä½³å®è·µ](#62-æ•°æ®åˆ†ææœ€ä½³å®è·µ)
    - [6.3. æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ](#63-æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ)
  - [7. 2024-2025æ•°æ®åˆ†æè¶‹åŠ¿](#7-2024-2025æ•°æ®åˆ†æè¶‹åŠ¿)
    - [7.1. æ•°æ®åˆ†ææŠ€æœ¯æ¼”è¿›](#71-æ•°æ®åˆ†ææŠ€æœ¯æ¼”è¿›)
    - [7.2. æ•°æ®åˆ†æå·¥å…·é€‰å‹çŸ©é˜µ](#72-æ•°æ®åˆ†æå·¥å…·é€‰å‹çŸ©é˜µ)
    - [7.3. Text-to-SQLè‡ªç„¶è¯­è¨€æŸ¥è¯¢](#73-text-to-sqlè‡ªç„¶è¯­è¨€æŸ¥è¯¢)
    - [7.4. å®æ—¶åˆ†ææ¶æ„](#74-å®æ—¶åˆ†ææ¶æ„)
  - [8. å‚è€ƒèµ„æ–™](#8-å‚è€ƒèµ„æ–™)
    - [8.1. æƒå¨æ–‡çŒ®](#81-æƒå¨æ–‡çŒ®)
    - [8.2. åœ¨çº¿èµ„æº](#82-åœ¨çº¿èµ„æº)
    - [8.3. ç›¸å…³æ–‡æ¡£](#83-ç›¸å…³æ–‡æ¡£)

---

## 1. æ¦‚è¿°

æ•°æ®åˆ†æä¸ä½¿ç”¨æ˜¯æ•°æ®åº“è®¾è®¡çš„æœ€ç»ˆç›®æ ‡ï¼Œæ¶‰åŠå¦‚ä½•æœ‰æ•ˆåœ°æŸ¥è¯¢ã€åˆ†æå’Œä½¿ç”¨æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚

### 1.1. æ•°æ®åˆ†æå±‚æ¬¡

```mermaid
mindmap
  root((æ•°æ®åˆ†æå±‚æ¬¡))
    æ“ä½œå‹åˆ†æ
      å®æ—¶æŸ¥è¯¢
      äº‹åŠ¡å¤„ç†
      æ•°æ®æ›´æ–°
    åˆ†æå‹åˆ†æ
      æŠ¥è¡¨ç”Ÿæˆ
      ç»Ÿè®¡åˆ†æ
      æ•°æ®æŒ–æ˜
    å†³ç­–æ”¯æŒ
      è¶‹åŠ¿åˆ†æ
      é¢„æµ‹åˆ†æ
      ä¸šåŠ¡æ´å¯Ÿ
```

### 1.2. æ•°æ®ä½¿ç”¨å†³ç­–æ ‘

```mermaid
flowchart TD
    A[æ•°æ®ä½¿ç”¨éœ€æ±‚] --> B{ä½¿ç”¨ç±»å‹}

    B -->|å®æ—¶æŸ¥è¯¢| C[æ“ä½œå‹æ•°æ®åº“]
    B -->|æŠ¥è¡¨åˆ†æ| D[æ•°æ®ä»“åº“]
    B -->|æ•°æ®æŒ–æ˜| E[æ•°æ®é›†å¸‚]

    C --> F[OLTPè®¾è®¡]
    D --> G[OLAPè®¾è®¡]
    E --> H[å¤šç»´æ¨¡å‹]

    F --> I[ä¼˜åŒ–äº‹åŠ¡]
    G --> J[ä¼˜åŒ–æŸ¥è¯¢]
    H --> K[ä¼˜åŒ–åˆ†æ]
```

---

## 2. æ•°æ®åˆ†ææ–¹æ³•

### 2.1. æ•°æ®æ¢ç´¢

**æ•°æ®æ¢ç´¢æ­¥éª¤**ï¼š

1. **æ•°æ®æ¦‚è§ˆ**ï¼š

   ```sql
   -- è¡¨ç»“æ„
   \d table_name

   -- æ•°æ®ç»Ÿè®¡
   SELECT COUNT(*) FROM table_name;
   SELECT MIN(column), MAX(column), AVG(column) FROM table_name;

   -- è¡¨å¤§å°åˆ†æï¼ˆPostgreSQLï¼‰
   SELECT
       schemaname,
       tablename,
       pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS total_size,
       pg_size_pretty(pg_relation_size(schemaname||'.'||tablename)) AS table_size,
       pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename) -
                      pg_relation_size(schemaname||'.'||tablename)) AS indexes_size
   FROM pg_tables
   WHERE schemaname = 'public'
   ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
   ```

2. **æ•°æ®è´¨é‡æ£€æŸ¥**ï¼š

   ```sql
   -- ç©ºå€¼æ£€æŸ¥
   SELECT
       column_name,
       COUNT(*) AS total_rows,
       COUNT(*) FILTER (WHERE column_name IS NULL) AS null_count,
       COUNT(*) FILTER (WHERE column_name IS NOT NULL) AS not_null_count,
       ROUND(100.0 * COUNT(*) FILTER (WHERE column_name IS NULL) / COUNT(*), 2) AS null_percentage
   FROM table_name
   GROUP BY column_name;

   -- é‡å¤å€¼æ£€æŸ¥
   SELECT column, COUNT(*)
   FROM table_name
   GROUP BY column
   HAVING COUNT(*) > 1
   ORDER BY COUNT(*) DESC;

   -- æ•°æ®åˆ†å¸ƒåˆ†æ
   SELECT
       column,
       COUNT(*) AS frequency,
       ROUND(100.0 * COUNT(*) / SUM(COUNT(*)) OVER (), 2) AS percentage
   FROM table_name
   GROUP BY column
   ORDER BY COUNT(*) DESC
   LIMIT 20;  -- å‰20ä¸ªæœ€å¸¸è§çš„å€¼

   -- æ•°æ®èŒƒå›´æ£€æŸ¥
   SELECT
       column_name,
       MIN(column_name) AS min_value,
       MAX(column_name) AS max_value,
       AVG(column_name) AS avg_value,
       PERCENTILE_CONT(0.25) WITHIN GROUP (ORDER BY column_name) AS p25,
       PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY column_name) AS median,
       PERCENTILE_CONT(0.75) WITHIN GROUP (ORDER BY column_name) AS p75
   FROM table_name
   GROUP BY column_name;
   ```

3. **å…³ç³»åˆ†æ**ï¼š

   ```sql
   -- å¤–é”®å®Œæ•´æ€§æ£€æŸ¥
   SELECT t1.id
   FROM table1 t1
   LEFT JOIN table2 t2 ON t1.fk = t2.id
   WHERE t2.id IS NULL;

   -- å…³ç³»åŸºæ•°åˆ†æ
   SELECT
       t1.id,
       COUNT(t2.id) AS related_count
   FROM table1 t1
   LEFT JOIN table2 t2 ON t1.id = t2.fk
   GROUP BY t1.id
   ORDER BY COUNT(t2.id) DESC;

   -- å…³ç³»å®Œæ•´æ€§ç»Ÿè®¡
   SELECT
       'table1' AS table_name,
       COUNT(*) AS total_rows,
       COUNT(t2.id) AS rows_with_relation,
       COUNT(*) - COUNT(t2.id) AS orphaned_rows
   FROM table1 t1
   LEFT JOIN table2 t2 ON t1.fk = t2.id;
   ```

### 2.2. ç»Ÿè®¡åˆ†æ

**ç»Ÿè®¡åˆ†ææ–¹æ³•**ï¼š

```sql
-- æè¿°æ€§ç»Ÿè®¡
SELECT
    COUNT(*) as total,
    AVG(price) as avg_price,
    MIN(price) as min_price,
    MAX(price) as max_price,
    STDDEV(price) as std_price,
    PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY price) as median_price
FROM products;

-- åˆ†ç»„ç»Ÿè®¡
SELECT
    category_id,
    COUNT(*) as product_count,
    AVG(price) as avg_price,
    SUM(stock) as total_stock
FROM products
GROUP BY category_id;

-- æ—¶é—´åºåˆ—åˆ†æ
SELECT
    DATE_TRUNC('month', order_date) as month,
    COUNT(*) as order_count,
    SUM(total) as total_revenue
FROM orders
GROUP BY DATE_TRUNC('month', order_date)
ORDER BY month;
```

### 2.3. æ•°æ®åˆ†æå†³ç­–æ ‘

```mermaid
flowchart TD
    A[æ•°æ®åˆ†æ] --> B{åˆ†æç›®æ ‡}

    B -->|æ•°æ®è´¨é‡| C[è´¨é‡æ£€æŸ¥]
    B -->|æ•°æ®åˆ†å¸ƒ| D[åˆ†å¸ƒåˆ†æ]
    B -->|å…³ç³»åˆ†æ| E[å…³è”åˆ†æ]
    B -->|è¶‹åŠ¿åˆ†æ| F[æ—¶é—´åºåˆ—]

    C --> G[ç©ºå€¼/é‡å¤æ£€æŸ¥]
    D --> H[ç»Ÿè®¡æè¿°]
    E --> I[å…³è”æŸ¥è¯¢]
    F --> J[æ—¶é—´èšåˆ]

    G --> K[æ•°æ®æ¸…æ´—]
    H --> L[åˆ†å¸ƒå¯è§†åŒ–]
    I --> M[å…³ç³»å›¾]
    J --> N[è¶‹åŠ¿å›¾]
```

---

## 3. æŸ¥è¯¢è®¾è®¡

### 3.1. æŸ¥è¯¢æ¨¡å¼è¯†åˆ«

**å¸¸è§æŸ¥è¯¢æ¨¡å¼**ï¼š

1. **ç‚¹æŸ¥è¯¢**ï¼šæ ¹æ®ä¸»é”®æˆ–å”¯ä¸€é”®æŸ¥è¯¢

   ```sql
   SELECT * FROM users WHERE id = 1;
   ```

2. **èŒƒå›´æŸ¥è¯¢**ï¼šæŸ¥è¯¢æŸä¸ªèŒƒå›´å†…çš„æ•°æ®

   ```sql
   SELECT * FROM orders
   WHERE order_date BETWEEN '2024-01-01' AND '2024-12-31';
   ```

3. **è¿æ¥æŸ¥è¯¢**ï¼šå¤šè¡¨å…³è”æŸ¥è¯¢

   ```sql
   SELECT u.username, o.total, o.order_date
   FROM users u
   JOIN orders o ON u.id = o.user_id;
   ```

4. **èšåˆæŸ¥è¯¢**ï¼šåˆ†ç»„ç»Ÿè®¡

   ```sql
   SELECT category_id, COUNT(*), AVG(price)
   FROM products
   GROUP BY category_id;
   ```

### 3.2. æŸ¥è¯¢ä¼˜åŒ–

**æŸ¥è¯¢ä¼˜åŒ–ç­–ç•¥**ï¼š

```mermaid
flowchart TD
    A[æŸ¥è¯¢ä¼˜åŒ–] --> B[åˆ†ææ‰§è¡Œè®¡åˆ’]
    B --> C{æ€§èƒ½é—®é¢˜}

    C -->|å…¨è¡¨æ‰«æ| D[æ·»åŠ ç´¢å¼•]
    C -->|JOINæ…¢| E[ä¼˜åŒ–JOIN]
    C -->|å­æŸ¥è¯¢æ…¢| F[æ”¹å†™æŸ¥è¯¢]

    D --> G[åˆ›å»ºç´¢å¼•]
    E --> H[è°ƒæ•´JOINé¡ºåº]
    F --> I[ä½¿ç”¨JOINæ›¿ä»£]

    G --> J[éªŒè¯æ€§èƒ½]
    H --> J
    I --> J

    J --> K{æ€§èƒ½å¯æ¥å—?}
    K -->|æ˜¯| L[ä¼˜åŒ–å®Œæˆ]
    K -->|å¦| M[è¿›ä¸€æ­¥ä¼˜åŒ–]
    M --> B
```

**ä¼˜åŒ–ç¤ºä¾‹**ï¼š

```sql
-- ä¼˜åŒ–å‰ï¼šå…¨è¡¨æ‰«æ
SELECT * FROM orders WHERE user_id = 123;

-- ä¼˜åŒ–åï¼šä½¿ç”¨ç´¢å¼•
CREATE INDEX idx_orders_user_id ON orders(user_id);
SELECT * FROM orders WHERE user_id = 123;

-- ä¼˜åŒ–å‰ï¼šå­æŸ¥è¯¢
SELECT * FROM products
WHERE category_id IN (
    SELECT id FROM categories WHERE name = 'Electronics'
);

-- ä¼˜åŒ–åï¼šJOIN
SELECT p.*
FROM products p
JOIN categories c ON p.category_id = c.id
WHERE c.name = 'Electronics';
```

### 3.3. æŸ¥è¯¢è®¾è®¡å†³ç­–æ ‘

```mermaid
flowchart TD
    A[è®¾è®¡æŸ¥è¯¢] --> B{æŸ¥è¯¢ç±»å‹}

    B -->|ç®€å•æŸ¥è¯¢| C[å•è¡¨æŸ¥è¯¢]
    B -->|å…³è”æŸ¥è¯¢| D[å¤šè¡¨JOIN]
    B -->|èšåˆæŸ¥è¯¢| E[GROUP BY]
    B -->|å¤æ‚æŸ¥è¯¢| F[å­æŸ¥è¯¢/CTE]

    C --> G[æ·»åŠ WHEREæ¡ä»¶]
    D --> H[ä¼˜åŒ–JOIN]
    E --> I[æ·»åŠ ç´¢å¼•]
    F --> J[ç®€åŒ–æŸ¥è¯¢]

    G --> K[åˆ†ææ‰§è¡Œè®¡åˆ’]
    H --> K
    I --> K
    J --> K

    K --> L{æ€§èƒ½å¯æ¥å—?}
    L -->|æ˜¯| M[æŸ¥è¯¢å®Œæˆ]
    L -->|å¦| N[ä¼˜åŒ–æŸ¥è¯¢]
    N --> B
```

---

## 4. æ€§èƒ½ä¼˜åŒ–

### 4.1. ç´¢å¼•ä¼˜åŒ–

**ç´¢å¼•ä¼˜åŒ–ç­–ç•¥**ï¼š

| åœºæ™¯ | ç´¢å¼•ç±»å‹ | ç¤ºä¾‹ |
|------|---------|------|
| **ç­‰å€¼æŸ¥è¯¢** | B-Treeç´¢å¼• | WHERE id = 123 |
| **èŒƒå›´æŸ¥è¯¢** | B-Treeç´¢å¼• | WHERE date BETWEEN ... |
| **å…¨æ–‡æœç´¢** | å…¨æ–‡ç´¢å¼• | WHERE text LIKE '%keyword%' |
| **æ•°ç»„æŸ¥è¯¢** | GINç´¢å¼• | WHERE tags @> ARRAY['tag'] |
| **JSONæŸ¥è¯¢** | GINç´¢å¼• | WHERE jsonb @> '{"key": "value"}' |

**ç´¢å¼•è®¾è®¡å†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[ç´¢å¼•è®¾è®¡] --> B{æŸ¥è¯¢æ¨¡å¼}

    B -->|ç­‰å€¼æŸ¥è¯¢| C[B-Treeç´¢å¼•]
    B -->|èŒƒå›´æŸ¥è¯¢| D[B-Treeç´¢å¼•]
    B -->|å…¨æ–‡æœç´¢| E[å…¨æ–‡ç´¢å¼•]
    B -->|æ•°ç»„æŸ¥è¯¢| F[GINç´¢å¼•]
    B -->|JSONæŸ¥è¯¢| G[GINç´¢å¼•]

    C --> H[åˆ›å»ºç´¢å¼•]
    D --> H
    E --> I[åˆ›å»ºå…¨æ–‡ç´¢å¼•]
    F --> J[åˆ›å»ºGINç´¢å¼•]
    G --> J

    H --> K[éªŒè¯æ€§èƒ½]
    I --> K
    J --> K

    K --> L{æ€§èƒ½æå‡?}
    L -->|æ˜¯| M[ç´¢å¼•æœ‰æ•ˆ]
    L -->|å¦| N[è°ƒæ•´ç´¢å¼•]
    N --> B
```

### 4.2. æŸ¥è¯¢ä¼˜åŒ–

**æŸ¥è¯¢ä¼˜åŒ–æŠ€å·§**ï¼š

1. **é¿å…SELECT ***ï¼š

   ```sql
   -- ä¸å¥½
   SELECT * FROM users;

   -- å¥½
   SELECT id, username, email FROM users;
   ```

2. **ä½¿ç”¨LIMIT**ï¼š

   ```sql
   SELECT * FROM orders ORDER BY order_date DESC LIMIT 10;
   ```

3. **é¿å…å‡½æ•°è°ƒç”¨**ï¼š

   ```sql
   -- ä¸å¥½
   SELECT * FROM orders WHERE YEAR(order_date) = 2024;

   -- å¥½
   SELECT * FROM orders
   WHERE order_date >= '2024-01-01'
     AND order_date < '2025-01-01';
   ```

4. **ä½¿ç”¨EXISTSè€ŒéIN**ï¼š

   ```sql
   -- ä¸å¥½ï¼ˆå¯¹äºå¤§å­æŸ¥è¯¢ï¼‰
   SELECT * FROM users
   WHERE id IN (SELECT user_id FROM orders);

   -- å¥½
   SELECT * FROM users u
   WHERE EXISTS (SELECT 1 FROM orders o WHERE o.user_id = u.id);
   ```

### 4.3. æ€§èƒ½ç›‘æ§

**æ€§èƒ½ç›‘æ§æŒ‡æ ‡**ï¼š

```sql
-- æ…¢æŸ¥è¯¢ç›‘æ§
SELECT
    query,
    calls,
    total_time,
    mean_time,
    max_time
FROM pg_stat_statements
ORDER BY mean_time DESC
LIMIT 10;

-- è¡¨å¤§å°ç›‘æ§
SELECT
    schemaname,
    tablename,
    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;

-- ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT
    schemaname,
    tablename,
    indexname,
    idx_scan,
    idx_tup_read,
    idx_tup_fetch
FROM pg_stat_user_indexes
ORDER BY idx_scan;
```

---

## 5. æ•°æ®ä½¿ç”¨æ¨¡å¼

### 5.1. OLTPæ¨¡å¼

**OLTPç‰¹å¾**ï¼š

- å¤§é‡çŸ­äº‹åŠ¡
- é¢‘ç¹çš„INSERT/UPDATE/DELETE
- ç‚¹æŸ¥è¯¢ä¸ºä¸»
- é«˜å¹¶å‘

**è®¾è®¡åŸåˆ™**ï¼š

- è§„èŒƒåŒ–è®¾è®¡
- é€‚å½“çš„ç´¢å¼•
- äº‹åŠ¡ä¼˜åŒ–
- è¿æ¥æ± ç®¡ç†

### 5.2. OLAPæ¨¡å¼

**OLAPç‰¹å¾**ï¼š

- å¤æ‚æŸ¥è¯¢
- å¤§é‡æ•°æ®æ‰«æ
- èšåˆæ“ä½œ
- è¯»å¤šå†™å°‘

**è®¾è®¡åŸåˆ™**ï¼š

- æ˜Ÿå‹/é›ªèŠ±å‹æ¨¡å¼
- ç‰©åŒ–è§†å›¾
- åˆ—å­˜å‚¨ï¼ˆå¦‚é€‚ç”¨ï¼‰
- åˆ†åŒºè¡¨

### 5.3. æ··åˆæ¨¡å¼

**æ··åˆæ¨¡å¼å†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[æ•°æ®ä½¿ç”¨æ¨¡å¼] --> B{ä¸»è¦æ“ä½œ}

    B -->|äº‹åŠ¡å¤„ç†| C[OLTPè®¾è®¡]
    B -->|åˆ†ææŸ¥è¯¢| D[OLAPè®¾è®¡]
    B -->|ä¸¤è€…å…¼é¡¾| E[æ··åˆæ¨¡å¼]

    C --> F[è§„èŒƒåŒ–+ç´¢å¼•]
    D --> G[ç»´åº¦æ¨¡å‹+ç‰©åŒ–è§†å›¾]
    E --> H[ä¸»ä»æ¶æ„]

    H --> I[ä¸»åº“OLTP]
    H --> J[ä»åº“OLAP]

    I --> K[å®æ—¶äº‹åŠ¡]
    J --> L[åˆ†ææŸ¥è¯¢]
```

---

## 6. æœ€ä½³å®è·µ

### 6.1. æŸ¥è¯¢æœ€ä½³å®è·µ

**æŸ¥è¯¢è®¾è®¡åŸåˆ™**ï¼š

1. **æ˜ç¡®æŸ¥è¯¢ç›®æ ‡**ï¼šåªæŸ¥è¯¢éœ€è¦çš„æ•°æ®
2. **ä½¿ç”¨é€‚å½“çš„ç´¢å¼•**ï¼šä¸ºæŸ¥è¯¢åˆ—åˆ›å»ºç´¢å¼•
3. **é¿å…N+1æŸ¥è¯¢**ï¼šä½¿ç”¨JOINæ›¿ä»£å¤šæ¬¡æŸ¥è¯¢
4. **ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢**ï¼šé˜²æ­¢SQLæ³¨å…¥
5. **ç›‘æ§æŸ¥è¯¢æ€§èƒ½**ï¼šå®šæœŸæ£€æŸ¥æ…¢æŸ¥è¯¢

### 6.2. æ•°æ®åˆ†ææœ€ä½³å®è·µ

**åˆ†ææµç¨‹**ï¼š

1. **æ•°æ®ç†è§£**ï¼šç†è§£æ•°æ®ç»“æ„å’Œä¸šåŠ¡å«ä¹‰
2. **æ•°æ®æ¸…æ´—**ï¼šå¤„ç†ç¼ºå¤±å€¼ã€å¼‚å¸¸å€¼
3. **æ¢ç´¢æ€§åˆ†æ**ï¼šå‘ç°æ•°æ®æ¨¡å¼å’Œå…³ç³»
4. **ç»Ÿè®¡åˆ†æ**ï¼šè¿›è¡Œæè¿°æ€§å’Œæ¨æ–­æ€§ç»Ÿè®¡
5. **ç»“æœè§£é‡Š**ï¼šå°†åˆ†æç»“æœè½¬åŒ–ä¸ºä¸šåŠ¡æ´å¯Ÿ

### 6.3. æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ

**ä¼˜åŒ–åŸåˆ™**ï¼š

1. **æµ‹é‡ä¼˜å…ˆ**ï¼šå…ˆæµ‹é‡å†ä¼˜åŒ–
2. **ç´¢å¼•ä¼˜åŒ–**ï¼šä¸ºæŸ¥è¯¢åˆ›å»ºé€‚å½“ç´¢å¼•
3. **æŸ¥è¯¢ä¼˜åŒ–**ï¼šä¼˜åŒ–æŸ¥è¯¢è¯­å¥
4. **æ¶æ„ä¼˜åŒ–**ï¼šè€ƒè™‘è¯»å†™åˆ†ç¦»ã€ç¼“å­˜ç­‰
5. **æŒç»­ç›‘æ§**ï¼šå®šæœŸç›‘æ§æ€§èƒ½æŒ‡æ ‡

---

## 7. 2024-2025æ•°æ®åˆ†æè¶‹åŠ¿

### 7.1. æ•°æ®åˆ†ææŠ€æœ¯æ¼”è¿›

```mermaid
timeline
    title æ•°æ®åˆ†ææŠ€æœ¯æ¼”è¿›
    2010 : ä¼ ç»ŸBI
         : æŠ¥è¡¨/ä»ªè¡¨æ¿
    2015 : å¤§æ•°æ®åˆ†æ
         : Hadoop/Spark
    2018 : å®æ—¶åˆ†æ
         : æµå¤„ç†
    2022 : å¢å¼ºåˆ†æ
         : AutoML
    2024 : AIåŸç”Ÿåˆ†æ
         : LLM+SQL
    2025 : è‡ªç„¶è¯­è¨€åˆ†æ
         : Text-to-SQL
```

### 7.2. æ•°æ®åˆ†æå·¥å…·é€‰å‹çŸ©é˜µ

| å·¥å…· | ç±»å‹ | å®æ—¶æ€§ | AIæ”¯æŒ | é€‚ç”¨åœºæ™¯ |
|------|------|--------|--------|---------|
| **PostgreSQL** | å…³ç³»æ•°æ®åº“ | ä¸­ | pgvector | é€šç”¨åˆ†æ |
| **ClickHouse** | OLAP | é«˜ | âœ… | å¤§æ•°æ®åˆ†æ |
| **DuckDB** | åµŒå…¥å¼OLAP | é«˜ | âœ… | æœ¬åœ°åˆ†æ |
| **Apache Superset** | BIå·¥å…· | ä¸­ | âŒ | å¯è§†åŒ– |
| **Metabase** | BIå·¥å…· | ä¸­ | âœ… | è‡ªåŠ©åˆ†æ |

### 7.3. Text-to-SQLè‡ªç„¶è¯­è¨€æŸ¥è¯¢

```python
# Text-to-SQL è‡ªç„¶è¯­è¨€æŸ¥è¯¢ç¤ºä¾‹
from langchain.sql_database import SQLDatabase
from langchain.chat_models import ChatOpenAI
from langchain.chains import create_sql_query_chain

# è¿æ¥æ•°æ®åº“
db = SQLDatabase.from_uri("postgresql://user:pass@localhost/db")

# åˆ›å»ºLLM
llm = ChatOpenAI(model="gpt-4", temperature=0)

# åˆ›å»ºSQLæŸ¥è¯¢é“¾
chain = create_sql_query_chain(llm, db)

# è‡ªç„¶è¯­è¨€æŸ¥è¯¢
question = "æŸ¥æ‰¾è¿‡å»30å¤©å†…è®¢å•é‡‘é¢æœ€é«˜çš„10ä¸ªå®¢æˆ·"
sql_query = chain.invoke({"question": question})

print(sql_query)
# SELECT customer_id, SUM(amount) as total
# FROM orders
# WHERE created_at >= NOW() - INTERVAL '30 days'
# GROUP BY customer_id
# ORDER BY total DESC
# LIMIT 10;
```

### 7.4. å®æ—¶åˆ†ææ¶æ„

```mermaid
flowchart TB
    subgraph æ•°æ®æº
        S1[ä¸šåŠ¡æ•°æ®åº“]
        S2[æ—¥å¿—ç³»ç»Ÿ]
        S3[IoTè®¾å¤‡]
    end

    subgraph å®æ—¶å¤„ç†
        P1[Kafka]
        P2[Flink/Spark]
    end

    subgraph åˆ†æå­˜å‚¨
        A1[ClickHouse<br/>å®æ—¶OLAP]
        A2[PostgreSQL<br/>äº‹åŠ¡æŸ¥è¯¢]
        A3[Redis<br/>å®æ—¶æŒ‡æ ‡]
    end

    subgraph åˆ†æåº”ç”¨
        D1[å®æ—¶ä»ªè¡¨æ¿]
        D2[å‘Šè­¦ç³»ç»Ÿ]
        D3[AIåˆ†æ]
    end

    S1 --> P1
    S2 --> P1
    S3 --> P1
    P1 --> P2
    P2 --> A1
    P2 --> A2
    P2 --> A3
    A1 --> D1
    A2 --> D3
    A3 --> D2
```

---

## 8. å‚è€ƒèµ„æ–™

### 8.1. æƒå¨æ–‡çŒ®

**æ•°æ®åˆ†æ**ï¼š

- Kleppmann, M. "Designing Data-Intensive Applications"
- "The Data Warehouse Toolkit" by Ralph Kimball

### 8.2. åœ¨çº¿èµ„æº

| èµ„æº | URL | æè¿° |
|------|-----|------|
| **Apache Superset** | <https://superset.apache.org/> | å¼€æºBI |
| **Metabase** | <https://www.metabase.com/> | è‡ªåŠ©åˆ†æ |
| **DuckDB** | <https://duckdb.org/> | åµŒå…¥å¼OLAP |

### 8.3. ç›¸å…³æ–‡æ¡£

- [07.01-Schemaè®¾è®¡æ–¹æ³•è®º](./07.01-Schemaè®¾è®¡æ–¹æ³•è®º.md)
- [07.03-æ•°æ®å»ºæ¨¡æŒ‡å¯¼](./07.03-æ•°æ®å»ºæ¨¡æŒ‡å¯¼.md)
- [07.21-åˆ—å¼æ•°æ®åº“è®¾è®¡æ¨¡å¼](./07.21-åˆ—å¼æ•°æ®åº“è®¾è®¡æ¨¡å¼.md)

---

**æœ€åæ›´æ–°**ï¼š2025-12-01
**ç»´æŠ¤è€…**ï¼šData-Science Team
**çŠ¶æ€**ï¼šå·²å®Œæˆ âœ…
**ç‰ˆæœ¬**ï¼šv2.0 (å¢å¼ºç‰ˆ)

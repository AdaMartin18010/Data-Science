# æ™ºèƒ½å®¶å±…IoTç½‘å…³æ¡ˆä¾‹

> **æ¡ˆä¾‹ç±»å‹**ï¼šè¾¹ç¼˜è®¡ç®—èŠ‚ç‚¹æ•°æ®å­˜å‚¨
> **åº”ç”¨åœºæ™¯**ï¼šæ™ºèƒ½å®¶å±…ç½‘å…³ã€ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ã€è¾¹ç¼˜è®¡ç®—
> **æŠ€æœ¯ç‰¹ç‚¹**ï¼šå†…å­˜+ç£ç›˜æ··åˆæ¨¡å‹ã€èµ„æºå—é™ä¼˜åŒ–ã€å®æ—¶æ•°æ®å­˜å‚¨

---

## ğŸ“‘ ç›®å½•

- [æ™ºèƒ½å®¶å±…IoTç½‘å…³æ¡ˆä¾‹](#æ™ºèƒ½å®¶å±…iotç½‘å…³æ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [ä¸€ã€åœºæ™¯æè¿°](#ä¸€åœºæ™¯æè¿°)
    - [1.1 ä¸šåŠ¡èƒŒæ™¯](#11-ä¸šåŠ¡èƒŒæ™¯)
    - [1.2 ç³»ç»Ÿè§„æ¨¡](#12-ç³»ç»Ÿè§„æ¨¡)
  - [äºŒã€æŠ€æœ¯æŒ‘æˆ˜](#äºŒæŠ€æœ¯æŒ‘æˆ˜)
    - [2.1 èµ„æºå—é™æŒ‘æˆ˜](#21-èµ„æºå—é™æŒ‘æˆ˜)
    - [2.2 é«˜é¢‘å†™å…¥æŒ‘æˆ˜](#22-é«˜é¢‘å†™å…¥æŒ‘æˆ˜)
    - [2.3 ä½åŠŸè€—æŒ‘æˆ˜](#23-ä½åŠŸè€—æŒ‘æˆ˜)
    - [2.4 æ•°æ®åŒæ­¥æŒ‘æˆ˜](#24-æ•°æ®åŒæ­¥æŒ‘æˆ˜)
  - [ä¸‰ã€è§£å†³æ–¹æ¡ˆ](#ä¸‰è§£å†³æ–¹æ¡ˆ)
    - [3.1 æ¶æ„è®¾è®¡](#31-æ¶æ„è®¾è®¡)
    - [3.2 å†…å­˜+ç£ç›˜æ··åˆæ¨¡å‹](#32-å†…å­˜ç£ç›˜æ··åˆæ¨¡å‹)
    - [3.3 åå°æ‰¹é‡å†™å…¥](#33-åå°æ‰¹é‡å†™å…¥)
    - [3.4 æ•°æ®åˆ†åŒºå’Œæ¸…ç†](#34-æ•°æ®åˆ†åŒºå’Œæ¸…ç†)
    - [3.5 æ•°æ®åŒæ­¥æœºåˆ¶](#35-æ•°æ®åŒæ­¥æœºåˆ¶)
  - [å››ã€æ•°æ®æ¨¡å‹](#å››æ•°æ®æ¨¡å‹)
    - [4.1 æ ¸å¿ƒè¡¨ç»“æ„](#41-æ ¸å¿ƒè¡¨ç»“æ„)
    - [4.2 æ•°æ®èšåˆè§†å›¾](#42-æ•°æ®èšåˆè§†å›¾)
  - [äº”ã€æ€§èƒ½æ•°æ®](#äº”æ€§èƒ½æ•°æ®)
    - [5.1 å†™å…¥æ€§èƒ½](#51-å†™å…¥æ€§èƒ½)
    - [5.2 æŸ¥è¯¢æ€§èƒ½](#52-æŸ¥è¯¢æ€§èƒ½)
    - [5.3 èµ„æºå ç”¨](#53-èµ„æºå ç”¨)
    - [5.4 åŠŸè€—æµ‹è¯•](#54-åŠŸè€—æµ‹è¯•)
  - [å…­ã€æœ€ä½³å®è·µ](#å…­æœ€ä½³å®è·µ)
    - [6.1 èµ„æºå—é™ç¯å¢ƒé…ç½®](#61-èµ„æºå—é™ç¯å¢ƒé…ç½®)
    - [6.2 å†…å­˜ç®¡ç†æœ€ä½³å®è·µ](#62-å†…å­˜ç®¡ç†æœ€ä½³å®è·µ)
    - [6.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®](#63-æ€§èƒ½ä¼˜åŒ–å»ºè®®)
    - [6.4 æ•°æ®åŒæ­¥æœ€ä½³å®è·µ](#64-æ•°æ®åŒæ­¥æœ€ä½³å®è·µ)
  - [ğŸ”— ç›¸å…³èµ„æº](#-ç›¸å…³èµ„æº)
  - [ğŸ”— äº¤å‰å¼•ç”¨](#-äº¤å‰å¼•ç”¨)
    - [ç†è®ºæ¨¡å‹ ğŸ†•](#ç†è®ºæ¨¡å‹-)
    - [è®¾è®¡æ¨¡å‹ ğŸ†•](#è®¾è®¡æ¨¡å‹-)

---

## ä¸€ã€åœºæ™¯æè¿°

### 1.1 ä¸šåŠ¡èƒŒæ™¯

æŸæ™ºèƒ½å®¶å±…ç³»ç»Ÿéœ€è¦åœ¨IoTç½‘å…³è®¾å¤‡ä¸­å®ç°ä¼ æ„Ÿå™¨æ•°æ®å­˜å‚¨ç³»ç»Ÿã€‚ç³»ç»Ÿè¦æ±‚ï¼š

- **å®æ—¶æ•°æ®é‡‡é›†**ï¼šæ”¯æŒå¤šç§ä¼ æ„Ÿå™¨ï¼ˆæ¸©åº¦ã€æ¹¿åº¦ã€å…‰ç…§ã€è¿åŠ¨ç­‰ï¼‰
- **æ•°æ®æœ¬åœ°å­˜å‚¨**ï¼šç½‘å…³ç¦»çº¿æ—¶æ•°æ®æœ¬åœ°ç¼“å­˜
- **èµ„æºå—é™**ï¼šè®¾å¤‡å†…å­˜æœ‰é™ï¼ˆ512MB RAMï¼‰ï¼Œå­˜å‚¨æœ‰é™ï¼ˆ8GB eMMCï¼‰
- **ä½åŠŸè€—**ï¼šè®¾å¤‡éœ€è¦7x24å°æ—¶è¿è¡Œï¼ŒåŠŸè€—è¦æ±‚ä½
- **æ•°æ®åŒæ­¥**ï¼šç½‘å…³æ¢å¤ç½‘ç»œåè‡ªåŠ¨åŒæ­¥æ•°æ®åˆ°äº‘ç«¯

### 1.2 ç³»ç»Ÿè§„æ¨¡

- **è®¾å¤‡æ•°é‡**ï¼š100,000+ å°æ™ºèƒ½ç½‘å…³
- **ä¼ æ„Ÿå™¨æ•°é‡**ï¼šæ¯å°ç½‘å…³è¿æ¥ 10-50 ä¸ªä¼ æ„Ÿå™¨
- **æ•°æ®é‡‡é›†é¢‘ç‡**ï¼šæ¯ä¼ æ„Ÿå™¨ 1-60 ç§’é‡‡é›†ä¸€æ¬¡
- **æ•°æ®é‡**ï¼šå•ç½‘å…³æ—¥å‡æ•°æ®ç‚¹ 10,000-100,000 æ¡
- **å­˜å‚¨å‘¨æœŸ**ï¼šæœ¬åœ°ä¿å­˜ 7 å¤©ï¼Œäº‘ç«¯ä¿å­˜ 1 å¹´

---

## äºŒã€æŠ€æœ¯æŒ‘æˆ˜

### 2.1 èµ„æºå—é™æŒ‘æˆ˜

**æŒ‘æˆ˜**ï¼š

- è®¾å¤‡å†…å­˜ä»…512MBï¼Œéœ€è¦è¿è¡Œæ“ä½œç³»ç»Ÿå’Œåº”ç”¨
- å­˜å‚¨ç©ºé—´æœ‰é™ï¼Œéœ€è¦åˆç†ç®¡ç†æ•°æ®
- CPUæ€§èƒ½æœ‰é™ï¼Œéœ€è¦ä¼˜åŒ–æ•°æ®å¤„ç†

**å½±å“**ï¼š

- å†…å­˜ä¸è¶³å¯èƒ½å¯¼è‡´ç³»ç»Ÿå´©æºƒ
- å­˜å‚¨ç©ºé—´ä¸è¶³ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±
- CPUè´Ÿè½½è¿‡é«˜ä¼šå½±å“å®æ—¶æ€§

### 2.2 é«˜é¢‘å†™å…¥æŒ‘æˆ˜

**æŒ‘æˆ˜**ï¼š

- å¤šä¸ªä¼ æ„Ÿå™¨åŒæ—¶é‡‡é›†æ•°æ®
- æ•°æ®å†™å…¥é¢‘ç‡é«˜ï¼ˆæ¯ç§’æ•°ååˆ°æ•°ç™¾æ¬¡ï¼‰
- éœ€è¦ä¿è¯æ•°æ®ä¸ä¸¢å¤±

**å½±å“**ï¼š

- å†™å…¥æ€§èƒ½ä¸è¶³ä¼šå¯¼è‡´æ•°æ®ç§¯å‹
- æ•°æ®ä¸¢å¤±ä¼šå½±å“æ•°æ®åˆ†æå‡†ç¡®æ€§

### 2.3 ä½åŠŸè€—æŒ‘æˆ˜

**æŒ‘æˆ˜**ï¼š

- è®¾å¤‡éœ€è¦7x24å°æ—¶è¿è¡Œ
- é¢‘ç¹çš„ç£ç›˜å†™å…¥ä¼šå¢åŠ åŠŸè€—
- éœ€è¦å¹³è¡¡æ€§èƒ½å’ŒåŠŸè€—

**å½±å“**ï¼š

- åŠŸè€—è¿‡é«˜ä¼šå¯¼è‡´è®¾å¤‡å‘çƒ­
- å¯èƒ½å½±å“è®¾å¤‡å¯¿å‘½

### 2.4 æ•°æ®åŒæ­¥æŒ‘æˆ˜

**æŒ‘æˆ˜**ï¼š

- ç½‘å…³å¯èƒ½é•¿æ—¶é—´ç¦»çº¿
- éœ€è¦æœ¬åœ°ç¼“å­˜å¤§é‡æ•°æ®
- ç½‘ç»œæ¢å¤åéœ€è¦é«˜æ•ˆåŒæ­¥

**å½±å“**ï¼š

- åŒæ­¥æ•ˆç‡ä½ä¼šå¯¼è‡´æ•°æ®å»¶è¿Ÿ
- å¯èƒ½å½±å“å®æ—¶ç›‘æ§

---

## ä¸‰ã€è§£å†³æ–¹æ¡ˆ

### 3.1 æ¶æ„è®¾è®¡

**æ ¸å¿ƒç­–ç•¥**ï¼šå†…å­˜æ•°æ®åº“ + ç£ç›˜æ•°æ®åº“æ··åˆæ¨¡å‹

```python
import sqlite3
from collections import deque
import threading
import time

class IoTGatewayStorage:
    """IoTç½‘å…³å­˜å‚¨ç³»ç»Ÿ"""

    def __init__(self, db_path, memory_buffer_size=1000):
        self.db_path = db_path
        self.memory_buffer = deque(maxlen=memory_buffer_size)
        self.buffer_lock = threading.Lock()
        self._setup_database()
        self._start_background_writer()

    def _setup_database(self):
        """è®¾ç½®æ•°æ®åº“é…ç½®ï¼ˆèµ„æºå—é™ä¼˜åŒ–ï¼‰"""
        conn = sqlite3.connect(self.db_path)
        # èµ„æºå—é™ç¯å¢ƒé…ç½®
        conn.execute('PRAGMA journal_mode=WAL')  # WALæ¨¡å¼æé«˜å¹¶å‘
        conn.execute('PRAGMA synchronous=NORMAL')  # å¹³è¡¡æ€§èƒ½å’Œå®‰å…¨æ€§
        conn.execute('PRAGMA cache_size=-2000')  # 2MBç¼“å­˜ï¼ˆèŠ‚çœå†…å­˜ï¼‰
        conn.execute('PRAGMA temp_store=MEMORY')  # ä¸´æ—¶è¡¨åœ¨å†…å­˜
        conn.execute('PRAGMA mmap_size=268435456')  # 256MBå†…å­˜æ˜ å°„
        conn.execute('PRAGMA page_size=4096')  # 4KBé¡µå¤§å°
        conn.close()
```

### 3.2 å†…å­˜+ç£ç›˜æ··åˆæ¨¡å‹

**ç­–ç•¥**ï¼šçƒ­æ•°æ®åœ¨å†…å­˜ï¼Œå†·æ•°æ®æ‰¹é‡å†™å…¥ç£ç›˜

```python
def record_sensor_data(self, sensor_id, value, timestamp=None):
    """è®°å½•ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆå†…å­˜ç¼“å†² + æ‰¹é‡å†™å…¥ï¼‰"""
    if timestamp is None:
        timestamp = time.time()

    data_point = {
        'sensor_id': sensor_id,
        'value': value,
        'timestamp': timestamp
    }

    # å…ˆå†™å…¥å†…å­˜ç¼“å†²åŒº
    with self.buffer_lock:
        self.memory_buffer.append(data_point)

    # å¦‚æœç¼“å†²åŒºæ»¡äº†ï¼Œè§¦å‘æ‰¹é‡å†™å…¥
    if len(self.memory_buffer) >= self.memory_buffer.maxlen:
        self._flush_buffer()

    return data_point

def _flush_buffer(self):
    """æ‰¹é‡å†™å…¥ç¼“å†²åŒºæ•°æ®åˆ°ç£ç›˜"""
    if not self.memory_buffer:
        return

    conn = sqlite3.connect(self.db_path)
    conn.execute('PRAGMA synchronous=NORMAL')

    try:
        # æ‰¹é‡æ’å…¥
        with self.buffer_lock:
            data_to_write = list(self.memory_buffer)
            self.memory_buffer.clear()

        cursor = conn.cursor()
        cursor.executemany("""
            INSERT INTO sensor_data (sensor_id, value, timestamp)
            VALUES (?, ?, ?)
        """, [(d['sensor_id'], d['value'], d['timestamp'])
              for d in data_to_write])

        conn.commit()
    finally:
        conn.close()
```

### 3.3 åå°æ‰¹é‡å†™å…¥

**ç­–ç•¥**ï¼šå®šæ—¶æ‰¹é‡å†™å…¥ï¼Œå‡å°‘ç£ç›˜I/O

```python
def _start_background_writer(self):
    """å¯åŠ¨åå°å†™å…¥çº¿ç¨‹"""
    def background_writer():
        while True:
            time.sleep(5)  # æ¯5ç§’å†™å…¥ä¸€æ¬¡
            self._flush_buffer()

    writer_thread = threading.Thread(target=background_writer, daemon=True)
    writer_thread.start()
```

### 3.4 æ•°æ®åˆ†åŒºå’Œæ¸…ç†

**ç­–ç•¥**ï¼šæŒ‰æ—¶é—´åˆ†åŒºï¼Œè‡ªåŠ¨æ¸…ç†æ—§æ•°æ®

```sql
-- åˆ›å»ºåˆ†åŒºè¡¨ï¼ˆæŒ‰æ—¥æœŸï¼‰
CREATE TABLE sensor_data (
    id INTEGER PRIMARY KEY,
    sensor_id TEXT NOT NULL,
    value REAL NOT NULL,
    timestamp REAL NOT NULL,
    date TEXT GENERATED ALWAYS AS (date(timestamp, 'unixepoch')) STORED
) STRICT;

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_sensor_timestamp ON sensor_data(sensor_id, timestamp);
CREATE INDEX idx_date ON sensor_data(date);

-- åˆ›å»ºæ¸…ç†è§†å›¾ï¼ˆåªä¿ç•™æœ€è¿‘7å¤©ï¼‰
CREATE VIEW sensor_data_recent AS
SELECT * FROM sensor_data
WHERE date >= date('now', '-7 days');
```

```python
def cleanup_old_data(self, days=7):
    """æ¸…ç†æ—§æ•°æ®ï¼ˆä¿ç•™æœ€è¿‘Nå¤©ï¼‰"""
    cutoff_timestamp = time.time() - (days * 24 * 3600)

    conn = sqlite3.connect(self.db_path)
    cursor = conn.cursor()

    # åˆ é™¤æ—§æ•°æ®
    cursor.execute("""
        DELETE FROM sensor_data
        WHERE timestamp < ?
    """, (cutoff_timestamp,))

    # æ‰§è¡ŒVACUUMå›æ”¶ç©ºé—´
    conn.execute('VACUUM')
    conn.commit()
    conn.close()
```

### 3.5 æ•°æ®åŒæ­¥æœºåˆ¶

**ç­–ç•¥**ï¼šæ ‡è®°åŒæ­¥çŠ¶æ€ï¼Œå¢é‡åŒæ­¥

```sql
-- æ·»åŠ åŒæ­¥çŠ¶æ€å­—æ®µ
ALTER TABLE sensor_data ADD COLUMN synced INTEGER DEFAULT 0;

-- åˆ›å»ºåŒæ­¥çŠ¶æ€ç´¢å¼•
CREATE INDEX idx_synced ON sensor_data(synced, timestamp);
```

```python
def get_unsynced_data(self, limit=1000):
    """è·å–æœªåŒæ­¥çš„æ•°æ®"""
    conn = sqlite3.connect(self.db_path)
    cursor = conn.cursor()

    cursor.execute("""
        SELECT * FROM sensor_data
        WHERE synced = 0
        ORDER BY timestamp
        LIMIT ?
    """, (limit,))

    data = cursor.fetchall()
    conn.close()
    return data

def mark_as_synced(self, record_ids):
    """æ ‡è®°æ•°æ®ä¸ºå·²åŒæ­¥"""
    conn = sqlite3.connect(self.db_path)
    cursor = conn.cursor()

    cursor.executemany("""
        UPDATE sensor_data
        SET synced = 1
        WHERE id = ?
    """, [(id,) for id in record_ids])

    conn.commit()
    conn.close()
```

---

## å››ã€æ•°æ®æ¨¡å‹

### 4.1 æ ¸å¿ƒè¡¨ç»“æ„

```sql
-- ä¼ æ„Ÿå™¨æ•°æ®è¡¨
CREATE TABLE sensor_data (
    id INTEGER PRIMARY KEY,
    sensor_id TEXT NOT NULL,
    value REAL NOT NULL,
    timestamp REAL NOT NULL,
    date TEXT GENERATED ALWAYS AS (date(timestamp, 'unixepoch')) STORED,
    synced INTEGER DEFAULT 0 CHECK(synced IN (0, 1))
) STRICT;

-- ä¼ æ„Ÿå™¨ä¿¡æ¯è¡¨
CREATE TABLE sensors (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    type TEXT NOT NULL,
    location TEXT,
    unit TEXT,
    created_at TEXT DEFAULT (datetime('now'))
) STRICT;

-- è®¾å¤‡çŠ¶æ€è¡¨
CREATE TABLE device_status (
    id INTEGER PRIMARY KEY,
    status TEXT NOT NULL,
    timestamp REAL NOT NULL,
    details TEXT
) STRICT;

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_sensor_timestamp ON sensor_data(sensor_id, timestamp);
CREATE INDEX idx_date ON sensor_data(date);
CREATE INDEX idx_synced ON sensor_data(synced, timestamp);
```

### 4.2 æ•°æ®èšåˆè§†å›¾

```sql
-- æ¯å°æ—¶èšåˆè§†å›¾
CREATE VIEW sensor_data_hourly AS
SELECT
    sensor_id,
    date(timestamp, 'unixepoch') as date,
    strftime('%H', datetime(timestamp, 'unixepoch')) as hour,
    AVG(value) as avg_value,
    MIN(value) as min_value,
    MAX(value) as max_value,
    COUNT(*) as count
FROM sensor_data
GROUP BY sensor_id, date, hour;

-- æ¯æ—¥èšåˆè§†å›¾
CREATE VIEW sensor_data_daily AS
SELECT
    sensor_id,
    date(timestamp, 'unixepoch') as date,
    AVG(value) as avg_value,
    MIN(value) as min_value,
    MAX(value) as max_value,
    COUNT(*) as count
FROM sensor_data
GROUP BY sensor_id, date;
```

---

## äº”ã€æ€§èƒ½æ•°æ®

### 5.1 å†™å…¥æ€§èƒ½

**æµ‹è¯•ç¯å¢ƒ**ï¼š

- è®¾å¤‡ï¼šARM Cortex-A7ï¼Œ512MB RAM
- å­˜å‚¨ï¼šeMMC 5.0ï¼Œ8GB
- SQLiteç‰ˆæœ¬ï¼š3.37.0

**æµ‹è¯•ç»“æœ**ï¼š

| åœºæ™¯ | å¹³å‡å»¶è¿Ÿ | ååé‡ | å†…å­˜å ç”¨ |
|------|---------|--------|---------|
| å•æ¡å†™å…¥ï¼ˆç›´æ¥ï¼‰ | 2.1ms | 476 TPS | 15MB |
| æ‰¹é‡å†™å…¥ï¼ˆ100æ¡ï¼‰ | 0.8ms/æ¡ | 1250 TPS | 18MB |
| å†…å­˜ç¼“å†²+æ‰¹é‡ | 0.1ms | 10000+ TPS | 25MB |

**ç»“è®º**ï¼š

- å†…å­˜ç¼“å†²æ˜¾è‘—æå‡å†™å…¥æ€§èƒ½
- æ‰¹é‡å†™å…¥å‡å°‘ç£ç›˜I/Oï¼Œé™ä½åŠŸè€—
- å†…å­˜å ç”¨æ§åˆ¶åœ¨åˆç†èŒƒå›´

### 5.2 æŸ¥è¯¢æ€§èƒ½

**æµ‹è¯•ç»“æœ**ï¼š

| æŸ¥è¯¢ç±»å‹ | å¹³å‡å»¶è¿Ÿ | è¯´æ˜ |
|---------|---------|------|
| å•ä¼ æ„Ÿå™¨æœ€æ–°å€¼ | 0.3ms | ä½¿ç”¨ç´¢å¼• |
| æ—¶é—´èŒƒå›´æŸ¥è¯¢ï¼ˆ1å°æ—¶ï¼‰ | 1.2ms | ä½¿ç”¨æ—¶é—´ç´¢å¼• |
| èšåˆæŸ¥è¯¢ï¼ˆæ¯å°æ—¶ï¼‰ | 8.5ms | ä½¿ç”¨è§†å›¾ |
| æœªåŒæ­¥æ•°æ®æŸ¥è¯¢ | 0.8ms | ä½¿ç”¨åŒæ­¥çŠ¶æ€ç´¢å¼• |

### 5.3 èµ„æºå ç”¨

**æµ‹è¯•ç»“æœ**ï¼š

| æŒ‡æ ‡ | æ•°å€¼ | è¯´æ˜ |
|------|------|------|
| æ•°æ®åº“æ–‡ä»¶å¤§å° | 50MB/å¤© | 100ä¸ªä¼ æ„Ÿå™¨ï¼Œ1åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡ |
| å†…å­˜å ç”¨ | 25-30MB | åŒ…æ‹¬ç¼“å†²åŒºå’Œç¼“å­˜ |
| CPUå ç”¨ | < 5% | æ­£å¸¸è¿è¡Œæ—¶ |
| ç£ç›˜I/O | ä½ | æ‰¹é‡å†™å…¥å‡å°‘I/O |

### 5.4 åŠŸè€—æµ‹è¯•

**æµ‹è¯•ç»“æœ**ï¼š

| æ¨¡å¼ | åŠŸè€— | è¯´æ˜ |
|------|------|------|
| ç›´æ¥å†™å…¥æ¨¡å¼ | 2.5W | é¢‘ç¹ç£ç›˜å†™å…¥ |
| æ‰¹é‡å†™å…¥æ¨¡å¼ | 1.8W | å‡å°‘ç£ç›˜å†™å…¥ |
| å†…å­˜ç¼“å†²æ¨¡å¼ | 1.5W | æœ€å°åŒ–ç£ç›˜I/O |

**ç»“è®º**ï¼š

- æ‰¹é‡å†™å…¥æ¨¡å¼åŠŸè€—é™ä½28%
- å†…å­˜ç¼“å†²æ¨¡å¼åŠŸè€—é™ä½40%
- æ»¡è¶³ä½åŠŸè€—è¦æ±‚

---

## å…­ã€æœ€ä½³å®è·µ

### 6.1 èµ„æºå—é™ç¯å¢ƒé…ç½®

```python
# IoTè®¾å¤‡SQLiteé…ç½®
IOT_CONFIG = {
    'journal_mode': 'WAL',           # WALæ¨¡å¼æé«˜å¹¶å‘
    'synchronous': 'NORMAL',         # å¹³è¡¡æ€§èƒ½å’Œå®‰å…¨æ€§
    'cache_size': -2000,             # 2MBç¼“å­˜ï¼ˆèŠ‚çœå†…å­˜ï¼‰
    'temp_store': 'MEMORY',          # ä¸´æ—¶è¡¨åœ¨å†…å­˜
    'mmap_size': 268435456,          # 256MBå†…å­˜æ˜ å°„
    'page_size': 4096,               # 4KBé¡µå¤§å°
    'wal_autocheckpoint': 1000,      # è‡ªåŠ¨æ£€æŸ¥ç‚¹
}
```

### 6.2 å†…å­˜ç®¡ç†æœ€ä½³å®è·µ

1. **ä½¿ç”¨å†…å­˜ç¼“å†²åŒº**
   - çƒ­æ•°æ®å…ˆå†™å…¥å†…å­˜
   - æ‰¹é‡å†™å…¥ç£ç›˜

2. **é™åˆ¶ç¼“å†²åŒºå¤§å°**
   - æ ¹æ®å¯ç”¨å†…å­˜è®¾ç½®ç¼“å†²åŒº
   - é¿å…å†…å­˜æº¢å‡º

3. **åŠæ—¶æ¸…ç†æ•°æ®**
   - å®šæœŸæ¸…ç†æ—§æ•°æ®
   - æ‰§è¡ŒVACUUMå›æ”¶ç©ºé—´

### 6.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ‰¹é‡æ“ä½œ**
   - ä½¿ç”¨executemanyæ‰¹é‡æ’å…¥
   - å‡å°‘äº‹åŠ¡å¼€é”€

2. **åˆç†ä½¿ç”¨ç´¢å¼•**
   - ä¸ºå¸¸ç”¨æŸ¥è¯¢åˆ›å»ºç´¢å¼•
   - é¿å…è¿‡åº¦ç´¢å¼•

3. **ä½¿ç”¨ç”Ÿæˆåˆ—**
   - æ—¥æœŸå­—æ®µä½¿ç”¨ç”Ÿæˆåˆ—
   - å‡å°‘å­˜å‚¨ç©ºé—´

### 6.4 æ•°æ®åŒæ­¥æœ€ä½³å®è·µ

1. **å¢é‡åŒæ­¥**
   - åªåŒæ­¥æœªåŒæ­¥çš„æ•°æ®
   - å‡å°‘ç½‘ç»œä¼ è¾“

2. **æ‰¹é‡åŒæ­¥**
   - æ‰¹é‡æ ‡è®°å·²åŒæ­¥æ•°æ®
   - æé«˜åŒæ­¥æ•ˆç‡

3. **é”™è¯¯å¤„ç†**
   - åŒæ­¥å¤±è´¥æ—¶ä¿ç•™æ•°æ®
   - æ”¯æŒé‡è¯•æœºåˆ¶

---

## ğŸ”— ç›¸å…³èµ„æº

- [01.03 å­˜å‚¨å¼•æ“](../01-æ ¸å¿ƒæ¶æ„/01.03-å­˜å‚¨å¼•æ“.md) - å­˜å‚¨ä¼˜åŒ–
- [03.01 æ€§èƒ½ç‰¹å¾åˆ†æ](../03-æ€§èƒ½ä¼˜åŒ–/03.01-æ€§èƒ½ç‰¹å¾åˆ†æ.md) - æ€§èƒ½ä¼˜åŒ–
- [08.01 è¿æ¥ç®¡ç†](../08-ç¼–ç¨‹å®è·µ/08.01-è¿æ¥ç®¡ç†.md) - è¿æ¥ç®¡ç†
- [08.04 PRAGMAé…ç½®](../08-ç¼–ç¨‹å®è·µ/08.04-PRAGMAé…ç½®.md) - èµ„æºå—é™é…ç½®
- [04.01 é€‚ç”¨åœºæ™¯åˆ†æ](../04-åº”ç”¨åœºæ™¯/04.01-é€‚ç”¨åœºæ™¯åˆ†æ.md) - IoTåº”ç”¨åœºæ™¯

---

## ğŸ”— äº¤å‰å¼•ç”¨

### ç†è®ºæ¨¡å‹ ğŸ†•

- â­â­ [å­˜å‚¨ç†è®º](../11-ç†è®ºæ¨¡å‹/11.05-å­˜å‚¨ç†è®º.md) - å­˜å‚¨æ¨¡å‹ç†è®ºã€ç¼“å­˜ç†è®º
- â­ [ç®—æ³•å¤æ‚åº¦ç†è®º](../11-ç†è®ºæ¨¡å‹/11.03-ç®—æ³•å¤æ‚åº¦ç†è®º.md) - æ‰¹é‡æ“ä½œå¤æ‚åº¦

### è®¾è®¡æ¨¡å‹ ğŸ†•

- â­â­ [è®¾è®¡å†³ç­–](../12-è®¾è®¡æ¨¡å‹/12.04-è®¾è®¡å†³ç­–.md) - åµŒå…¥å¼æ¶æ„å†³ç­–ã€èµ„æºå—é™è®¾è®¡å†³ç­–
- â­ [è®¾è®¡æ¨¡å¼](../12-è®¾è®¡æ¨¡å‹/12.03-è®¾è®¡æ¨¡å¼.md) - æ‰¹é‡å¤„ç†æ¨¡å¼

---

**ç»´æŠ¤è€…**ï¼šData-Science Team
**æœ€åæ›´æ–°**ï¼š2025-01-15

# SQLite åˆ° PostgreSQL SQLå…¼å®¹æ€§æ·±åº¦åˆ†æž

> **åˆ›å»ºæ—¥æœŸ**ï¼š2025-11-13
> **æœ€åŽæ›´æ–°**ï¼š2025-11-13
> **é€‚ç”¨ç‰ˆæœ¬**ï¼šSQLite 3.31+ â†’ PostgreSQL 12+

---

## ðŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£ä»Žè¯­ä¹‰æ¨¡åž‹ã€ç±»åž‹ç³»ç»Ÿã€SQLè¯­æ³•ã€çº¦æŸæœºåˆ¶ç­‰ç»´åº¦æ·±åº¦åˆ†æžSQLiteä¸ŽPostgreSQLçš„å…¼å®¹æ€§ï¼Œæä¾›ç³»ç»ŸåŒ–çš„å…¼å®¹æ€§è¯„ä¼°æ¡†æž¶ã€‚

---

## ðŸ“‘ ç›®å½•

- [SQLite åˆ° PostgreSQL SQLå…¼å®¹æ€§æ·±åº¦åˆ†æž](#sqlite-åˆ°-postgresql-sqlå…¼å®¹æ€§æ·±åº¦åˆ†æž)
  - [ðŸ“‹ æ¦‚è¿°](#-æ¦‚è¿°)
  - [ðŸ“‘ ç›®å½•](#-ç›®å½•)
  - [ä¸€ã€ç±»åž‹ç³»ç»Ÿå…¼å®¹æ€§åˆ†æž](#ä¸€ç±»åž‹ç³»ç»Ÿå…¼å®¹æ€§åˆ†æž)
    - [1.1 ç±»åž‹è¯­ä¹‰æ¨¡åž‹å¯¹æ¯”](#11-ç±»åž‹è¯­ä¹‰æ¨¡åž‹å¯¹æ¯”)
      - [SQLiteåŠ¨æ€ç±»åž‹è¯­ä¹‰æ¨¡åž‹](#sqliteåŠ¨æ€ç±»åž‹è¯­ä¹‰æ¨¡åž‹)
      - [PostgreSQLé™æ€ç±»åž‹è¯­ä¹‰æ¨¡åž‹](#postgresqlé™æ€ç±»åž‹è¯­ä¹‰æ¨¡åž‹)
      - [è¯­ä¹‰æ¨¡åž‹å·®å¼‚åˆ†æž](#è¯­ä¹‰æ¨¡åž‹å·®å¼‚åˆ†æž)
    - [1.2 å­˜å‚¨ç±»åˆ°PostgreSQLç±»åž‹æ˜ å°„](#12-å­˜å‚¨ç±»åˆ°postgresqlç±»åž‹æ˜ å°„)
      - [å®Œæ•´æ˜ å°„è¡¨ï¼ˆè¯­ä¹‰å±‚é¢ï¼‰](#å®Œæ•´æ˜ å°„è¡¨è¯­ä¹‰å±‚é¢)
      - [ç±»åž‹äº²å’Œæ€§æ˜ å°„ç­–ç•¥](#ç±»åž‹äº²å’Œæ€§æ˜ å°„ç­–ç•¥)
    - [1.3 ç±»åž‹è½¬æ¢è¯­ä¹‰æŸå¤±åˆ†æž](#13-ç±»åž‹è½¬æ¢è¯­ä¹‰æŸå¤±åˆ†æž)
      - [è½¬æ¢æŸå¤±çŸ©é˜µ](#è½¬æ¢æŸå¤±çŸ©é˜µ)
      - [è¯­ä¹‰æŸå¤±è¯„ä¼°](#è¯­ä¹‰æŸå¤±è¯„ä¼°)
    - [1.4 ç±»åž‹å…¼å®¹æ€§çŸ©é˜µ](#14-ç±»åž‹å…¼å®¹æ€§çŸ©é˜µ)
      - [å®Œæ•´å…¼å®¹æ€§çŸ©é˜µ](#å®Œæ•´å…¼å®¹æ€§çŸ©é˜µ)
  - [äºŒã€è¡¨ç»“æž„å…¼å®¹æ€§åˆ†æž](#äºŒè¡¨ç»“æž„å…¼å®¹æ€§åˆ†æž)
    - [2.1 è¡¨å®šä¹‰è¯­ä¹‰å·®å¼‚](#21-è¡¨å®šä¹‰è¯­ä¹‰å·®å¼‚)
      - [CREATE TABLEè¯­ä¹‰å¯¹æ¯”](#create-tableè¯­ä¹‰å¯¹æ¯”)
      - [è¡¨å®šä¹‰è¯­ä¹‰æ˜ å°„ç­–ç•¥](#è¡¨å®šä¹‰è¯­ä¹‰æ˜ å°„ç­–ç•¥)
    - [2.2 åˆ—å®šä¹‰å…¼å®¹æ€§](#22-åˆ—å®šä¹‰å…¼å®¹æ€§)
      - [åˆ—å±žæ€§è¯­ä¹‰å¯¹æ¯”](#åˆ—å±žæ€§è¯­ä¹‰å¯¹æ¯”)
      - [åˆ—å®šä¹‰è¿ç§»ç¤ºä¾‹](#åˆ—å®šä¹‰è¿ç§»ç¤ºä¾‹)
    - [2.3 çº¦æŸè¯­ä¹‰å…¼å®¹æ€§](#23-çº¦æŸè¯­ä¹‰å…¼å®¹æ€§)
      - [CHECKçº¦æŸè¯­ä¹‰å¯¹æ¯”](#checkçº¦æŸè¯­ä¹‰å¯¹æ¯”)
      - [å¤–é”®çº¦æŸè¯­ä¹‰å¯¹æ¯”](#å¤–é”®çº¦æŸè¯­ä¹‰å¯¹æ¯”)
    - [2.4 ç´¢å¼•è¯­ä¹‰å…¼å®¹æ€§](#24-ç´¢å¼•è¯­ä¹‰å…¼å®¹æ€§)
      - [ç´¢å¼•ç±»åž‹è¯­ä¹‰å¯¹æ¯”](#ç´¢å¼•ç±»åž‹è¯­ä¹‰å¯¹æ¯”)
      - [ç´¢å¼•è¯­ä¹‰è¿ç§»ç¤ºä¾‹](#ç´¢å¼•è¯­ä¹‰è¿ç§»ç¤ºä¾‹)
  - [ä¸‰ã€SQLè¯­æ³•å…¼å®¹æ€§åˆ†æž](#ä¸‰sqlè¯­æ³•å…¼å®¹æ€§åˆ†æž)
    - [3.1 DDLå…¼å®¹æ€§çŸ©é˜µ](#31-ddlå…¼å®¹æ€§çŸ©é˜µ)
      - [CREATE TABLEå…¼å®¹æ€§](#create-tableå…¼å®¹æ€§)
      - [ALTER TABLEå…¼å®¹æ€§](#alter-tableå…¼å®¹æ€§)
    - [3.2 DMLå…¼å®¹æ€§çŸ©é˜µ](#32-dmlå…¼å®¹æ€§çŸ©é˜µ)
      - [INSERTå…¼å®¹æ€§](#insertå…¼å®¹æ€§)
      - [UPDATEå…¼å®¹æ€§](#updateå…¼å®¹æ€§)
    - [3.3 æŸ¥è¯¢è¯­æ³•å…¼å®¹æ€§](#33-æŸ¥è¯¢è¯­æ³•å…¼å®¹æ€§)
      - [SELECTå…¼å®¹æ€§](#selectå…¼å®¹æ€§)
      - [èšåˆå‡½æ•°å…¼å®¹æ€§](#èšåˆå‡½æ•°å…¼å®¹æ€§)
    - [3.4 å‡½æ•°å…¼å®¹æ€§åˆ†æž](#34-å‡½æ•°å…¼å®¹æ€§åˆ†æž)
      - [å­—ç¬¦ä¸²å‡½æ•°å…¼å®¹æ€§](#å­—ç¬¦ä¸²å‡½æ•°å…¼å®¹æ€§)
      - [æ—¥æœŸæ—¶é—´å‡½æ•°å…¼å®¹æ€§](#æ—¥æœŸæ—¶é—´å‡½æ•°å…¼å®¹æ€§)
  - [å››ã€å¤–é”®çº¦æŸå…¼å®¹æ€§åˆ†æž](#å››å¤–é”®çº¦æŸå…¼å®¹æ€§åˆ†æž)
    - [4.1 å¤–é”®è¯­ä¹‰æ¨¡åž‹å¯¹æ¯”](#41-å¤–é”®è¯­ä¹‰æ¨¡åž‹å¯¹æ¯”)
      - [SQLiteå¤–é”®è¯­ä¹‰æ¨¡åž‹](#sqliteå¤–é”®è¯­ä¹‰æ¨¡åž‹)
      - [PostgreSQLå¤–é”®è¯­ä¹‰æ¨¡åž‹](#postgresqlå¤–é”®è¯­ä¹‰æ¨¡åž‹)
    - [4.2 å¤–é”®çº¦æŸè¡Œä¸ºå·®å¼‚](#42-å¤–é”®çº¦æŸè¡Œä¸ºå·®å¼‚)
      - [çº§è”æ“ä½œå¯¹æ¯”](#çº§è”æ“ä½œå¯¹æ¯”)
      - [å¤–é”®æ£€æŸ¥æ—¶æœºå·®å¼‚](#å¤–é”®æ£€æŸ¥æ—¶æœºå·®å¼‚)
    - [4.3 å¤–é”®æ€§èƒ½å½±å“åˆ†æž](#43-å¤–é”®æ€§èƒ½å½±å“åˆ†æž)
      - [æ€§èƒ½å½±å“å¯¹æ¯”](#æ€§èƒ½å½±å“å¯¹æ¯”)
    - [4.4 å¤–é”®è¿ç§»ç­–ç•¥](#44-å¤–é”®è¿ç§»ç­–ç•¥)
      - [è¿ç§»ç­–ç•¥1ï¼šç›´æŽ¥è¿ç§»ï¼ˆæŽ¨èï¼‰](#è¿ç§»ç­–ç•¥1ç›´æŽ¥è¿ç§»æŽ¨è)
      - [è¿ç§»ç­–ç•¥2ï¼šå»¶è¿Ÿçº¦æŸï¼ˆé«˜çº§åœºæ™¯ï¼‰](#è¿ç§»ç­–ç•¥2å»¶è¿Ÿçº¦æŸé«˜çº§åœºæ™¯)
  - [äº”ã€äº‹åŠ¡è¯­ä¹‰å…¼å®¹æ€§åˆ†æž](#äº”äº‹åŠ¡è¯­ä¹‰å…¼å®¹æ€§åˆ†æž)
    - [5.1 éš”ç¦»çº§åˆ«è¯­ä¹‰å¯¹æ¯”](#51-éš”ç¦»çº§åˆ«è¯­ä¹‰å¯¹æ¯”)
      - [SQLiteéš”ç¦»çº§åˆ«](#sqliteéš”ç¦»çº§åˆ«)
      - [PostgreSQLéš”ç¦»çº§åˆ«](#postgresqléš”ç¦»çº§åˆ«)
      - [éš”ç¦»çº§åˆ«è¯­ä¹‰æ˜ å°„](#éš”ç¦»çº§åˆ«è¯­ä¹‰æ˜ å°„)
    - [5.2 é”è¯­ä¹‰å·®å¼‚](#52-é”è¯­ä¹‰å·®å¼‚)
      - [é”æœºåˆ¶å¯¹æ¯”](#é”æœºåˆ¶å¯¹æ¯”)
      - [é”è¯­ä¹‰è¿ç§»å½±å“](#é”è¯­ä¹‰è¿ç§»å½±å“)
    - [5.3 å¹¶å‘æŽ§åˆ¶è¯­ä¹‰](#53-å¹¶å‘æŽ§åˆ¶è¯­ä¹‰)
      - [å¹¶å‘æ¨¡åž‹å¯¹æ¯”](#å¹¶å‘æ¨¡åž‹å¯¹æ¯”)
  - [å…­ã€æ•°æ®è¯­ä¹‰å…¼å®¹æ€§åˆ†æž](#å…­æ•°æ®è¯­ä¹‰å…¼å®¹æ€§åˆ†æž)
    - [6.1 æ•°æ®å€¼è¯­ä¹‰æ˜ å°„](#61-æ•°æ®å€¼è¯­ä¹‰æ˜ å°„)
      - [æ•°å€¼è¯­ä¹‰æ˜ å°„](#æ•°å€¼è¯­ä¹‰æ˜ å°„)
    - [6.2 NULLè¯­ä¹‰å…¼å®¹æ€§](#62-nullè¯­ä¹‰å…¼å®¹æ€§)
      - [NULLå¤„ç†è¯­ä¹‰å¯¹æ¯”](#nullå¤„ç†è¯­ä¹‰å¯¹æ¯”)
      - [NULLè¯­ä¹‰è¿ç§»ç¤ºä¾‹](#nullè¯­ä¹‰è¿ç§»ç¤ºä¾‹)
    - [6.3 æ—¥æœŸæ—¶é—´è¯­ä¹‰å·®å¼‚](#63-æ—¥æœŸæ—¶é—´è¯­ä¹‰å·®å¼‚)
      - [æ—¥æœŸæ—¶é—´å­˜å‚¨è¯­ä¹‰](#æ—¥æœŸæ—¶é—´å­˜å‚¨è¯­ä¹‰)
      - [æ—¥æœŸæ—¶é—´è¯­ä¹‰è¿ç§»ç­–ç•¥](#æ—¥æœŸæ—¶é—´è¯­ä¹‰è¿ç§»ç­–ç•¥)
    - [6.4 å­—ç¬¦ä¸²ç¼–ç è¯­ä¹‰](#64-å­—ç¬¦ä¸²ç¼–ç è¯­ä¹‰)
      - [ç¼–ç è¯­ä¹‰å¯¹æ¯”](#ç¼–ç è¯­ä¹‰å¯¹æ¯”)
      - [ç¼–ç è¯­ä¹‰è¿ç§»](#ç¼–ç è¯­ä¹‰è¿ç§»)
  - [ä¸ƒã€å…¼å®¹æ€§è¯„ä¼°æ¡†æž¶](#ä¸ƒå…¼å®¹æ€§è¯„ä¼°æ¡†æž¶)
    - [7.1 å…¼å®¹æ€§è¯„åˆ†æ¨¡åž‹](#71-å…¼å®¹æ€§è¯„åˆ†æ¨¡åž‹)
      - [è¯„åˆ†ç»´åº¦](#è¯„åˆ†ç»´åº¦)
      - [ç»¼åˆè¯„åˆ†å…¬å¼](#ç»¼åˆè¯„åˆ†å…¬å¼)
      - [è¯„åˆ†ç¤ºä¾‹](#è¯„åˆ†ç¤ºä¾‹)
    - [7.2 è¿ç§»é£Žé™©çŸ©é˜µ](#72-è¿ç§»é£Žé™©çŸ©é˜µ)
      - [é£Žé™©çŸ©é˜µ](#é£Žé™©çŸ©é˜µ)
    - [7.3 å…¼å®¹æ€§æ£€æŸ¥æ¸…å•](#73-å…¼å®¹æ€§æ£€æŸ¥æ¸…å•)
      - [æ£€æŸ¥æ¸…å•](#æ£€æŸ¥æ¸…å•)
  - [ðŸ”— ç›¸å…³èµ„æº](#-ç›¸å…³èµ„æº)
  - [ðŸ“š å‚è€ƒèµ„æ–™](#-å‚è€ƒèµ„æ–™)

---

## ä¸€ã€ç±»åž‹ç³»ç»Ÿå…¼å®¹æ€§åˆ†æž

### 1.1 ç±»åž‹è¯­ä¹‰æ¨¡åž‹å¯¹æ¯”

#### SQLiteåŠ¨æ€ç±»åž‹è¯­ä¹‰æ¨¡åž‹

**æ ¸å¿ƒç‰¹å¾**ï¼š

- **å­˜å‚¨ç±»ï¼ˆStorage Classesï¼‰**ï¼šNULLã€INTEGERã€REALã€TEXTã€BLOB
- **ç±»åž‹äº²å’Œæ€§ï¼ˆType Affinityï¼‰**ï¼šåˆ—çš„ç±»åž‹æç¤ºï¼Œä¸å¼ºåˆ¶
- **è¿è¡Œæ—¶ç±»åž‹æ£€æŸ¥**ï¼šå€¼åœ¨å­˜å‚¨æ—¶ç¡®å®šç±»åž‹
- **éšå¼ç±»åž‹è½¬æ¢**ï¼šæŸ¥è¯¢æ—¶è‡ªåŠ¨è½¬æ¢

**è¯­ä¹‰æ¨¡åž‹**ï¼š

```text
SQLiteç±»åž‹ç³»ç»Ÿ = {
    å£°æ˜Žç±»åž‹ï¼ˆType Affinityï¼‰: æç¤ºæ€§ï¼Œä¸å¼ºåˆ¶
    å­˜å‚¨ç±»åž‹ï¼ˆStorage Classï¼‰: å®žé™…å­˜å‚¨æ—¶çš„ç±»åž‹
    å€¼ç±»åž‹ï¼ˆValue Typeï¼‰: è¿è¡Œæ—¶å€¼çš„ç±»åž‹
}
```

#### PostgreSQLé™æ€ç±»åž‹è¯­ä¹‰æ¨¡åž‹

**æ ¸å¿ƒç‰¹å¾**ï¼š

- **ä¸¥æ ¼ç±»åž‹ç³»ç»Ÿ**ï¼šåˆ—ç±»åž‹å¿…é¡»åŒ¹é…
- **ç±»åž‹å±‚æ¬¡ç»“æž„**ï¼šåŸºç¡€ç±»åž‹ã€å¤åˆç±»åž‹ã€åŸŸç±»åž‹
- **ç¼–è¯‘æ—¶ç±»åž‹æ£€æŸ¥**ï¼šSQLè§£æžæ—¶æ£€æŸ¥
- **æ˜¾å¼ç±»åž‹è½¬æ¢**ï¼šéœ€è¦CASTæˆ–::æ“ä½œç¬¦

**è¯­ä¹‰æ¨¡åž‹**ï¼š

```text
PostgreSQLç±»åž‹ç³»ç»Ÿ = {
    åˆ—ç±»åž‹ï¼ˆColumn Typeï¼‰: å¼ºåˆ¶ï¼Œä¸å¯å˜
    å€¼ç±»åž‹ï¼ˆValue Typeï¼‰: å¿…é¡»åŒ¹é…åˆ—ç±»åž‹
    ç±»åž‹è½¬æ¢ï¼ˆType Castï¼‰: æ˜¾å¼è½¬æ¢
}
```

#### è¯­ä¹‰æ¨¡åž‹å·®å¼‚åˆ†æž

| ç»´åº¦ | SQLite | PostgreSQL | å…¼å®¹æ€§å½±å“ |
|------|--------|-----------|-----------|
| **ç±»åž‹å£°æ˜Ž** | æç¤ºæ€§ | å¼ºåˆ¶æ€§ | ðŸ”´ é«˜å½±å“ |
| **ç±»åž‹æ£€æŸ¥æ—¶æœº** | è¿è¡Œæ—¶ | ç¼–è¯‘æ—¶ | ðŸŸ¡ ä¸­å½±å“ |
| **ç±»åž‹è½¬æ¢** | éšå¼ | æ˜¾å¼ | ðŸŸ¡ ä¸­å½±å“ |
| **ç±»åž‹çº¦æŸ** | å¼± | å¼º | ðŸ”´ é«˜å½±å“ |

### 1.2 å­˜å‚¨ç±»åˆ°PostgreSQLç±»åž‹æ˜ å°„

#### å®Œæ•´æ˜ å°„è¡¨ï¼ˆè¯­ä¹‰å±‚é¢ï¼‰

| SQLiteå­˜å‚¨ç±» | è¯­ä¹‰ç‰¹å¾ | PostgreSQLç±»åž‹ | è¯­ä¹‰åŒ¹é…åº¦ | æ³¨æ„äº‹é¡¹ |
|-------------|---------|---------------|-----------|---------|
| **NULL** | ç©ºå€¼è¯­ä¹‰ | NULL | âœ… 100% | å®Œå…¨å…¼å®¹ |
| **INTEGER** | æ•´æ•°è¯­ä¹‰ï¼Œ1-8å­—èŠ‚è‡ªé€‚åº” | INTEGER / BIGINT | âš ï¸ 90% | éœ€è¦æ£€æŸ¥å€¼èŒƒå›´ |
| **REAL** | æµ®ç‚¹æ•°è¯­ä¹‰ï¼ŒIEEE 754 | REAL / DOUBLE PRECISION | âš ï¸ 95% | ç²¾åº¦å¯èƒ½ä¸åŒ |
| **TEXT** | æ–‡æœ¬è¯­ä¹‰ï¼ŒUTF-8/UTF-16 | TEXT / VARCHAR(n) | âš ï¸ 85% | é•¿åº¦é™åˆ¶ã€ç¼–ç  |
| **BLOB** | äºŒè¿›åˆ¶è¯­ä¹‰ï¼Œä»»æ„é•¿åº¦ | BYTEA | âš ï¸ 90% | ç¼–ç æ–¹å¼ä¸åŒ |

#### ç±»åž‹äº²å’Œæ€§æ˜ å°„ç­–ç•¥

**INTEGERäº²å’Œæ€§**ï¼š

```sql
-- SQLite: INTEGERäº²å’Œæ€§
CREATE TABLE t(id INTEGER, value INTEGER);

-- è¯­ä¹‰åˆ†æžï¼š
-- 1. idåˆ—ï¼šæœŸæœ›æ•´æ•°ï¼Œä½†å¯å­˜å‚¨TEXT
-- 2. valueåˆ—ï¼šæœŸæœ›æ•´æ•°ï¼Œä½†å¯å­˜å‚¨REAL

-- PostgreSQLæ˜ å°„ç­–ç•¥ï¼š
-- ç­–ç•¥1ï¼šä¸¥æ ¼æ˜ å°„ï¼ˆæŽ¨èï¼‰
CREATE TABLE t(
    id INTEGER NOT NULL,  -- å¼ºåˆ¶æ•´æ•°
    value INTEGER NOT NULL CHECK (value IS NOT NULL)
);

-- ç­–ç•¥2ï¼šå®½æ¾æ˜ å°„ï¼ˆå…¼å®¹æ€§ä¼˜å…ˆï¼‰
CREATE TABLE t(
    id NUMERIC,  -- å…è®¸ä»»æ„æ•°å€¼
    value NUMERIC
);
```

**TEXTäº²å’Œæ€§**ï¼š

```sql
-- SQLite: TEXTäº²å’Œæ€§
CREATE TABLE t(name TEXT, description TEXT);

-- è¯­ä¹‰åˆ†æžï¼š
-- 1. nameåˆ—ï¼šæœŸæœ›æ–‡æœ¬ï¼Œå¯å­˜å‚¨ä»»æ„ç±»åž‹
-- 2. descriptionåˆ—ï¼šæœŸæœ›æ–‡æœ¬ï¼Œå¯å­˜å‚¨ä»»æ„ç±»åž‹

-- PostgreSQLæ˜ å°„ç­–ç•¥ï¼š
CREATE TABLE t(
    name TEXT NOT NULL,  -- å¼ºåˆ¶æ–‡æœ¬
    description TEXT
);
```

**NUMERICäº²å’Œæ€§**ï¼š

```sql
-- SQLite: NUMERICäº²å’Œæ€§ï¼ˆæœ€çµæ´»ï¼‰
CREATE TABLE t(price NUMERIC, quantity NUMERIC);

-- è¯­ä¹‰åˆ†æžï¼š
-- NUMERICäº²å’Œæ€§å¯ä»¥å­˜å‚¨ä»»ä½•ç±»åž‹

-- PostgreSQLæ˜ å°„ç­–ç•¥ï¼š
-- éœ€è¦åˆ†æžå®žé™…æ•°æ®ç¡®å®šç±»åž‹
CREATE TABLE t(
    price NUMERIC(10,2),  -- åŸºäºŽæ•°æ®åˆ†æž
    quantity INTEGER      -- åŸºäºŽæ•°æ®åˆ†æž
);
```

### 1.3 ç±»åž‹è½¬æ¢è¯­ä¹‰æŸå¤±åˆ†æž

#### è½¬æ¢æŸå¤±çŸ©é˜µ

| è½¬æ¢æ–¹å‘ | è¯­ä¹‰æŸå¤± | æ•°æ®æŸå¤±é£Žé™© | ç¤ºä¾‹ |
|---------|---------|------------|------|
| INTEGER â†’ INTEGER | æ—  | ä½Ž | 123 â†’ 123 |
| INTEGER â†’ BIGINT | æ—  | æ—  | 123 â†’ 123 |
| INTEGER â†’ TEXT | è¯­ä¹‰å˜åŒ– | æ—  | 123 â†’ '123' |
| REAL â†’ INTEGER | ç²¾åº¦æŸå¤± | é«˜ | 3.14 â†’ 3 |
| TEXT â†’ INTEGER | è¯­ä¹‰è½¬æ¢ | ä¸­ | '123' â†’ 123 |
| TEXT â†’ VARCHAR(n) | é•¿åº¦é™åˆ¶ | ä¸­ | 'long text' â†’ æˆªæ–­ |
| BLOB â†’ BYTEA | ç¼–ç å·®å¼‚ | ä½Ž | äºŒè¿›åˆ¶ â†’ äºŒè¿›åˆ¶ |

#### è¯­ä¹‰æŸå¤±è¯„ä¼°

**æŸå¤±ç±»åž‹1ï¼šç²¾åº¦æŸå¤±**:

```sql
-- SQLite: REALå­˜å‚¨
INSERT INTO products(price) VALUES (19.999999);

-- PostgreSQL: NUMERIC(10,2)
-- è½¬æ¢åŽ: 20.00
-- è¯­ä¹‰æŸå¤±: ç²¾åº¦ä»Ž6ä½å°æ•°åˆ°2ä½å°æ•°
```

**æŸå¤±ç±»åž‹2ï¼šèŒƒå›´æŸå¤±**:

```sql
-- SQLite: INTEGERï¼ˆ8å­—èŠ‚ï¼Œæœ€å¤§2^63-1ï¼‰
INSERT INTO big_table(id) VALUES (9223372036854775807);

-- PostgreSQL: INTEGERï¼ˆ4å­—èŠ‚ï¼Œæœ€å¤§2^31-1ï¼‰
-- è½¬æ¢å¤±è´¥: å€¼è¶…å‡ºèŒƒå›´
-- è§£å†³æ–¹æ¡ˆ: ä½¿ç”¨BIGINT
```

**æŸå¤±ç±»åž‹3ï¼šè¯­ä¹‰è½¬æ¢**:

```sql
-- SQLite: åŠ¨æ€ç±»åž‹ï¼Œ'123'å¯ä»¥å­˜å‚¨ä¸ºTEXT
INSERT INTO mixed(id) VALUES ('123');

-- PostgreSQL: ä¸¥æ ¼ç±»åž‹
-- éœ€è¦æ˜¾å¼è½¬æ¢: CAST('123' AS INTEGER)
-- è¯­ä¹‰å˜åŒ–: ä»Žæ–‡æœ¬è¯­ä¹‰åˆ°æ•´æ•°è¯­ä¹‰
```

### 1.4 ç±»åž‹å…¼å®¹æ€§çŸ©é˜µ

#### å®Œæ•´å…¼å®¹æ€§çŸ©é˜µ

| SQLiteç±»åž‹ | PostgreSQLç±»åž‹ | è¯­æ³•å…¼å®¹ | è¯­ä¹‰å…¼å®¹ | æ•°æ®å…¼å®¹ | ç»¼åˆè¯„åˆ† |
|-----------|---------------|---------|---------|---------|---------|
| INTEGER | INTEGER | âœ… | âš ï¸ | âš ï¸ | 85% |
| INTEGER | BIGINT | âœ… | âœ… | âœ… | 100% |
| REAL | REAL | âœ… | âš ï¸ | âš ï¸ | 90% |
| REAL | DOUBLE PRECISION | âœ… | âœ… | âœ… | 100% |
| TEXT | TEXT | âœ… | âš ï¸ | âš ï¸ | 85% |
| TEXT | VARCHAR(n) | âœ… | âš ï¸ | âš ï¸ | 80% |
| BLOB | BYTEA | âœ… | âš ï¸ | âš ï¸ | 90% |

**è¯„åˆ†è¯´æ˜Ž**ï¼š

- **è¯­æ³•å…¼å®¹**ï¼šSQLè¯­æ³•æ˜¯å¦æ”¯æŒ
- **è¯­ä¹‰å…¼å®¹**ï¼šç±»åž‹è¯­ä¹‰æ˜¯å¦ä¸€è‡´
- **æ•°æ®å…¼å®¹**ï¼šæ•°æ®å€¼æ˜¯å¦å®Œå…¨å…¼å®¹

---

## äºŒã€è¡¨ç»“æž„å…¼å®¹æ€§åˆ†æž

### 2.1 è¡¨å®šä¹‰è¯­ä¹‰å·®å¼‚

#### CREATE TABLEè¯­ä¹‰å¯¹æ¯”

**SQLiteè¡¨å®šä¹‰è¯­ä¹‰**ï¼š

```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY,  -- è¯­ä¹‰ï¼šä¸»é”®ï¼Œè‡ªåŠ¨é€’å¢žï¼ˆå¯é€‰ï¼‰
    name TEXT,               -- è¯­ä¹‰ï¼šæ–‡æœ¬ï¼Œå¯å­˜å‚¨ä»»æ„ç±»åž‹
    age INTEGER,             -- è¯­ä¹‰ï¼šæ•´æ•°ï¼Œå¯å­˜å‚¨å…¶ä»–ç±»åž‹
    created_at INTEGER       -- è¯­ä¹‰ï¼šæ•´æ•°ï¼Œé€šå¸¸å­˜å‚¨æ—¶é—´æˆ³
);
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- ç±»åž‹å£°æ˜Žæ˜¯æç¤ºæ€§çš„
- ä¸»é”®å¯ä»¥æ˜¯ä»»æ„ç±»åž‹
- åˆ—å¯ä»¥å­˜å‚¨ä¸Žå£°æ˜Žç±»åž‹ä¸åŒçš„å€¼

**PostgreSQLè¡¨å®šä¹‰è¯­ä¹‰**ï¼š

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,           -- è¯­ä¹‰ï¼šä¸»é”®ï¼Œè‡ªåŠ¨é€’å¢žï¼ˆå¼ºåˆ¶ï¼‰
    name VARCHAR(255) NOT NULL,     -- è¯­ä¹‰ï¼šæ–‡æœ¬ï¼Œé•¿åº¦é™åˆ¶ï¼Œéžç©º
    age INTEGER CHECK (age > 0),    -- è¯­ä¹‰ï¼šæ•´æ•°ï¼ŒèŒƒå›´çº¦æŸ
    created_at TIMESTAMP NOT NULL   -- è¯­ä¹‰ï¼šæ—¶é—´æˆ³ï¼Œéžç©º
);
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- ç±»åž‹å£°æ˜Žæ˜¯å¼ºåˆ¶æ€§çš„
- ä¸»é”®å¿…é¡»æ˜¯å”¯ä¸€ä¸”éžç©º
- åˆ—åªèƒ½å­˜å‚¨åŒ¹é…ç±»åž‹çš„å€¼

#### è¡¨å®šä¹‰è¯­ä¹‰æ˜ å°„ç­–ç•¥

**ç­–ç•¥1ï¼šä¸¥æ ¼æ˜ å°„ï¼ˆæŽ¨èï¼‰**:

```sql
-- åˆ†æžSQLiteè¡¨è¯­ä¹‰
-- 1. è¯†åˆ«å®žé™…æ•°æ®ç±»åž‹
-- 2. è¯†åˆ«çº¦æŸè¯­ä¹‰
-- 3. è½¬æ¢ä¸ºPostgreSQLä¸¥æ ¼ç±»åž‹

-- SQLite
CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    name TEXT,
    price REAL
);

-- PostgreSQLï¼ˆä¸¥æ ¼æ˜ å°„ï¼‰
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,  -- åŸºäºŽæ•°æ®åˆ†æžç¡®å®šé•¿åº¦
    price NUMERIC(10,2) NOT NULL  -- åŸºäºŽæ•°æ®åˆ†æžç¡®å®šç²¾åº¦
);
```

**ç­–ç•¥2ï¼šå…¼å®¹æ€§æ˜ å°„ï¼ˆä¿æŒçµæ´»æ€§ï¼‰**:

```sql
-- PostgreSQLï¼ˆå…¼å®¹æ€§æ˜ å°„ï¼‰
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name TEXT,                    -- ä¿æŒçµæ´»æ€§
    price NUMERIC                 -- ä¸é™åˆ¶ç²¾åº¦
);
```

### 2.2 åˆ—å®šä¹‰å…¼å®¹æ€§

#### åˆ—å±žæ€§è¯­ä¹‰å¯¹æ¯”

| å±žæ€§ | SQLiteè¯­ä¹‰ | PostgreSQLè¯­ä¹‰ | å…¼å®¹æ€§ |
|------|-----------|---------------|--------|
| **NOT NULL** | è¿è¡Œæ—¶æ£€æŸ¥ | ç¼–è¯‘æ—¶æ£€æŸ¥ | âœ… å…¼å®¹ |
| **DEFAULT** | æ”¯æŒè¡¨è¾¾å¼ | æ”¯æŒè¡¨è¾¾å¼ | âœ… å…¼å®¹ |
| **UNIQUE** | å…è®¸NULL | å…è®¸NULL | âœ… å…¼å®¹ |
| **PRIMARY KEY** | å¯ä»»æ„ç±»åž‹ | å¿…é¡»å”¯ä¸€éžç©º | âš ï¸ éƒ¨åˆ†å…¼å®¹ |
| **CHECK** | è¿è¡Œæ—¶æ£€æŸ¥ | ç¼–è¯‘æ—¶æ£€æŸ¥ | âœ… å…¼å®¹ |

#### åˆ—å®šä¹‰è¿ç§»ç¤ºä¾‹

```sql
-- SQLiteåˆ—å®šä¹‰
CREATE TABLE orders (
    id INTEGER PRIMARY KEY,
    user_id INTEGER,
    total REAL DEFAULT 0.0,
    status TEXT DEFAULT 'pending',
    created_at INTEGER DEFAULT (strftime('%s', 'now'))
);

-- PostgreSQLåˆ—å®šä¹‰ï¼ˆè¯­ä¹‰æ˜ å°„ï¼‰
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    total NUMERIC(10,2) DEFAULT 0.0,
    status VARCHAR(50) DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 2.3 çº¦æŸè¯­ä¹‰å…¼å®¹æ€§

#### CHECKçº¦æŸè¯­ä¹‰å¯¹æ¯”

**SQLite CHECKçº¦æŸ**ï¼š

```sql
CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    price REAL CHECK (price > 0),
    stock INTEGER CHECK (stock >= 0 AND stock <= 10000)
);
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- è¿è¡Œæ—¶æ£€æŸ¥
- å¯ä»¥å¼•ç”¨å…¶ä»–åˆ—
- NULLå€¼å¯èƒ½ç»•è¿‡æ£€æŸ¥

**PostgreSQL CHECKçº¦æŸ**ï¼š

```sql
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    price NUMERIC(10,2) CHECK (price > 0),
    stock INTEGER CHECK (stock >= 0 AND stock <= 10000)
);
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- ç¼–è¯‘æ—¶æ£€æŸ¥
- å¯ä»¥å¼•ç”¨å…¶ä»–åˆ—
- NULLå€¼å¤„ç†æ›´ä¸¥æ ¼

#### å¤–é”®çº¦æŸè¯­ä¹‰å¯¹æ¯”

**SQLiteå¤–é”®**ï¼š

```sql
-- éœ€è¦æ˜¾å¼å¯ç”¨
PRAGMA foreign_keys = ON;

CREATE TABLE orders (
    id INTEGER PRIMARY KEY,
    user_id INTEGER,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- é»˜è®¤å…³é—­ï¼Œéœ€è¦æ˜¾å¼å¯ç”¨
- çº§è”æ“ä½œæ”¯æŒæœ‰é™
- å»¶è¿Ÿçº¦æŸæ£€æŸ¥

**PostgreSQLå¤–é”®**ï¼š

```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE
);
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- é»˜è®¤å¯ç”¨
- å®Œæ•´çš„çº§è”æ“ä½œæ”¯æŒ
- ç«‹å³çº¦æŸæ£€æŸ¥

### 2.4 ç´¢å¼•è¯­ä¹‰å…¼å®¹æ€§

#### ç´¢å¼•ç±»åž‹è¯­ä¹‰å¯¹æ¯”

| ç´¢å¼•ç±»åž‹ | SQLiteè¯­ä¹‰ | PostgreSQLè¯­ä¹‰ | å…¼å®¹æ€§ |
|---------|-----------|---------------|--------|
| **B-Tree** | é»˜è®¤ç´¢å¼• | é»˜è®¤ç´¢å¼• | âœ… å®Œå…¨å…¼å®¹ |
| **å”¯ä¸€ç´¢å¼•** | å…è®¸NULL | å…è®¸NULL | âœ… å®Œå…¨å…¼å®¹ |
| **å¤åˆç´¢å¼•** | æ”¯æŒ | æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ |
| **éƒ¨åˆ†ç´¢å¼•** | 3.8.0+ | æ”¯æŒ | âœ… å®Œå…¨å…¼å®¹ |
| **è¦†ç›–ç´¢å¼•** | 3.8.0+ | INCLUDEå­å¥ | âš ï¸ è¯­æ³•ä¸åŒ |
| **å…¨æ–‡ç´¢å¼•** | FTS5 | GIN/GiST | âš ï¸ å®žçŽ°ä¸åŒ |

#### ç´¢å¼•è¯­ä¹‰è¿ç§»ç¤ºä¾‹

```sql
-- SQLiteç´¢å¼•
CREATE INDEX idx_users_email ON users(email);
CREATE UNIQUE INDEX idx_users_username ON users(username);
CREATE INDEX idx_orders_user_date ON orders(user_id, created_at);

-- PostgreSQLç´¢å¼•ï¼ˆè¯­ä¹‰ç­‰ä»·ï¼‰
CREATE INDEX idx_users_email ON users(email);
CREATE UNIQUE INDEX idx_users_username ON users(username);
CREATE INDEX idx_orders_user_date ON orders(user_id, created_at);

-- PostgreSQLé¢å¤–åŠŸèƒ½ï¼šè¦†ç›–ç´¢å¼•
CREATE INDEX idx_users_covering ON users(email) INCLUDE (name, created_at);
```

---

## ä¸‰ã€SQLè¯­æ³•å…¼å®¹æ€§åˆ†æž

### 3.1 DDLå…¼å®¹æ€§çŸ©é˜µ

#### CREATE TABLEå…¼å®¹æ€§

| ç‰¹æ€§ | SQLite | PostgreSQL | å…¼å®¹æ€§ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|--------|---------|
| **åŸºæœ¬è¡¨å®šä¹‰** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **AUTOINCREMENT** | âœ… | âŒ | âŒ 0% | ä½¿ç”¨SERIAL/IDENTITY |
| **åˆ—ç±»åž‹** | åŠ¨æ€ | é™æ€ | âš ï¸ 70% | ç±»åž‹æ˜ å°„ |
| **CHECKçº¦æŸ** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **å¤–é”®çº¦æŸ** | âœ… | âœ… | âœ… 100% | è¯­æ³•è°ƒæ•´ |
| **ç”Ÿæˆåˆ—** | 3.31+ | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |

#### ALTER TABLEå…¼å®¹æ€§

| æ“ä½œ | SQLite | PostgreSQL | å…¼å®¹æ€§ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|--------|---------|
| **ADD COLUMN** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **DROP COLUMN** | 3.35.0+ | âœ… | âš ï¸ 80% | ç‰ˆæœ¬æ£€æŸ¥ |
| **RENAME COLUMN** | 3.25.0+ | âœ… | âš ï¸ 80% | ç‰ˆæœ¬æ£€æŸ¥ |
| **ALTER COLUMN TYPE** | âŒ | âœ… | âŒ 0% | éœ€è¦é‡å»ºè¡¨ |
| **ADD CONSTRAINT** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |

### 3.2 DMLå…¼å®¹æ€§çŸ©é˜µ

#### INSERTå…¼å®¹æ€§

| ç‰¹æ€§ | SQLite | PostgreSQL | å…¼å®¹æ€§ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|--------|---------|
| **åŸºæœ¬INSERT** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **INSERT ... RETURNING** | âŒ | âœ… | âŒ 0% | éœ€è¦é¢å¤–æŸ¥è¯¢ |
| **INSERT ... ON CONFLICT** | 3.24.0+ | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **å¤šè¡ŒINSERT** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |

#### UPDATEå…¼å®¹æ€§

| ç‰¹æ€§ | SQLite | PostgreSQL | å…¼å®¹æ€§ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|--------|---------|
| **åŸºæœ¬UPDATE** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **å¤šè¡¨UPDATE** | âŒ | âœ… | âŒ 0% | ä½¿ç”¨FROMå­å¥ |
| **UPDATE ... RETURNING** | âŒ | âœ… | âŒ 0% | éœ€è¦é¢å¤–æŸ¥è¯¢ |
| **LIMITå­å¥** | âœ… | âŒ | âŒ 0% | ä½¿ç”¨å­æŸ¥è¯¢ |

### 3.3 æŸ¥è¯¢è¯­æ³•å…¼å®¹æ€§

#### SELECTå…¼å®¹æ€§

| ç‰¹æ€§ | SQLite | PostgreSQL | å…¼å®¹æ€§ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|--------|---------|
| **åŸºæœ¬SELECT** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **JOINè¯­æ³•** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **å­æŸ¥è¯¢** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **CTE** | 3.8.3+ | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **çª—å£å‡½æ•°** | 3.25.0+ | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **LIMIT/OFFSET** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |

#### èšåˆå‡½æ•°å…¼å®¹æ€§

| å‡½æ•° | SQLite | PostgreSQL | å…¼å®¹æ€§ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|--------|---------|
| **COUNT** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **SUM/AVG** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **MIN/MAX** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **GROUP_CONCAT** | âœ… | âŒ | âŒ 0% | ä½¿ç”¨STRING_AGG |
| **JSONå‡½æ•°** | JSON1 | JSONB | âš ï¸ 70% | è¯­æ³•è°ƒæ•´ |

### 3.4 å‡½æ•°å…¼å®¹æ€§åˆ†æž

#### å­—ç¬¦ä¸²å‡½æ•°å…¼å®¹æ€§

| å‡½æ•° | SQLite | PostgreSQL | è¯­ä¹‰å…¼å®¹ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|---------|---------|
| **\|\| (è¿žæŽ¥)** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **LENGTH** | âœ… | âœ… | âš ï¸ 90% | æ³¨æ„ç¼–ç å·®å¼‚ |
| **SUBSTR** | âœ… | SUBSTRING | âœ… 100% | å‡½æ•°åè°ƒæ•´ |
| **REPLACE** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **UPPER/LOWER** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |
| **TRIM** | âœ… | âœ… | âœ… 100% | ç›´æŽ¥è¿ç§» |

#### æ—¥æœŸæ—¶é—´å‡½æ•°å…¼å®¹æ€§

| å‡½æ•° | SQLite | PostgreSQL | è¯­ä¹‰å…¼å®¹ | è¿ç§»ç­–ç•¥ |
|------|--------|-----------|---------|---------|
| **datetime()** | âœ… | NOW() | âš ï¸ 80% | ä½¿ç”¨NOW() |
| **date()** | âœ… | CURRENT_DATE | âš ï¸ 80% | ä½¿ç”¨CURRENT_DATE |
| **strftime()** | âœ… | TO_CHAR() | âš ï¸ 70% | æ ¼å¼å­—ç¬¦ä¸²è½¬æ¢ |
| **julianday()** | âœ… | âŒ | âŒ 0% | è‡ªå®šä¹‰å‡½æ•° |
| **unixepoch()** | 3.38.0+ | EXTRACT(EPOCH) | âš ï¸ 90% | ä½¿ç”¨EXTRACT |

---

## å››ã€å¤–é”®çº¦æŸå…¼å®¹æ€§åˆ†æž

### 4.1 å¤–é”®è¯­ä¹‰æ¨¡åž‹å¯¹æ¯”

#### SQLiteå¤–é”®è¯­ä¹‰æ¨¡åž‹

**æ ¸å¿ƒç‰¹å¾**ï¼š

- **é»˜è®¤å…³é—­**ï¼šéœ€è¦`PRAGMA foreign_keys = ON`
- **å»¶è¿Ÿæ£€æŸ¥**ï¼šå¯ä»¥åœ¨äº‹åŠ¡ç»“æŸæ—¶æ£€æŸ¥
- **çº§è”æ“ä½œ**ï¼šæ”¯æŒON DELETE/UPDATE CASCADE
- **NULLå¤„ç†**ï¼šå¤–é”®åˆ—å¯ä»¥ä¸ºNULL

**è¯­ä¹‰æ¨¡åž‹**ï¼š

```text
SQLiteå¤–é”® = {
    å¯ç”¨æ–¹å¼: PRAGMA foreign_keys = ON
    æ£€æŸ¥æ—¶æœº: å»¶è¿Ÿï¼ˆäº‹åŠ¡æäº¤æ—¶ï¼‰
    çº§è”æ“ä½œ: æœ‰é™æ”¯æŒ
    NULLè¯­ä¹‰: å…è®¸NULLï¼Œä¸æ£€æŸ¥
}
```

#### PostgreSQLå¤–é”®è¯­ä¹‰æ¨¡åž‹

**æ ¸å¿ƒç‰¹å¾**ï¼š

- **é»˜è®¤å¯ç”¨**ï¼šåˆ›å»ºå¤–é”®å³ç”Ÿæ•ˆ
- **ç«‹å³æ£€æŸ¥**ï¼šæ¯æ¬¡æ“ä½œç«‹å³æ£€æŸ¥
- **å®Œæ•´çº§è”**ï¼šæ”¯æŒæ‰€æœ‰çº§è”æ“ä½œ
- **NULLå¤„ç†**ï¼šå¤–é”®åˆ—å¯ä»¥ä¸ºNULL

**è¯­ä¹‰æ¨¡åž‹**ï¼š

```text
PostgreSQLå¤–é”® = {
    å¯ç”¨æ–¹å¼: åˆ›å»ºæ—¶è‡ªåŠ¨å¯ç”¨
    æ£€æŸ¥æ—¶æœº: ç«‹å³ï¼ˆæ¯æ¬¡æ“ä½œï¼‰
    çº§è”æ“ä½œ: å®Œæ•´æ”¯æŒ
    NULLè¯­ä¹‰: å…è®¸NULLï¼Œä¸æ£€æŸ¥
}
```

### 4.2 å¤–é”®çº¦æŸè¡Œä¸ºå·®å¼‚

#### çº§è”æ“ä½œå¯¹æ¯”

| æ“ä½œ | SQLite | PostgreSQL | å…¼å®¹æ€§ |
|------|--------|-----------|--------|
| **ON DELETE CASCADE** | âœ… | âœ… | âœ… 100% |
| **ON DELETE SET NULL** | âœ… | âœ… | âœ… 100% |
| **ON DELETE RESTRICT** | âœ… | âœ… | âœ… 100% |
| **ON UPDATE CASCADE** | âœ… | âœ… | âœ… 100% |
| **ON UPDATE SET NULL** | âœ… | âœ… | âœ… 100% |
| **DEFERRABLE** | âŒ | âœ… | âŒ 0% |

#### å¤–é”®æ£€æŸ¥æ—¶æœºå·®å¼‚

**SQLiteå»¶è¿Ÿæ£€æŸ¥**ï¼š

```sql
-- SQLite: å»¶è¿Ÿå¤–é”®æ£€æŸ¥
PRAGMA foreign_keys = ON;
PRAGMA defer_foreign_keys = ON;  -- 3.8.0+

BEGIN;
INSERT INTO orders(user_id) VALUES (999);  -- å…è®¸ï¼ˆå»¶è¿Ÿæ£€æŸ¥ï¼‰
INSERT INTO users(id) VALUES (999);        -- åœ¨äº‹åŠ¡ä¸­ä¿®å¤
COMMIT;  -- æ­¤æ—¶æ£€æŸ¥å¤–é”®
```

**PostgreSQLç«‹å³æ£€æŸ¥**ï¼š

```sql
-- PostgreSQL: ç«‹å³å¤–é”®æ£€æŸ¥
BEGIN;
INSERT INTO orders(user_id) VALUES (999);  -- ç«‹å³å¤±è´¥
-- éœ€è¦å…ˆæ’å…¥users
INSERT INTO users(id) VALUES (999);
INSERT INTO orders(user_id) VALUES (999);  -- çŽ°åœ¨æˆåŠŸ
COMMIT;
```

### 4.3 å¤–é”®æ€§èƒ½å½±å“åˆ†æž

#### æ€§èƒ½å½±å“å¯¹æ¯”

| åœºæ™¯ | SQLiteå½±å“ | PostgreSQLå½±å“ | å·®å¼‚ |
|------|-----------|---------------|------|
| **æ’å…¥æ€§èƒ½** | ä½Žï¼ˆå»¶è¿Ÿæ£€æŸ¥ï¼‰ | ä¸­ï¼ˆç«‹å³æ£€æŸ¥ï¼‰ | PostgreSQLæ›´ä¸¥æ ¼ |
| **åˆ é™¤æ€§èƒ½** | ä½Ž | ä¸­ï¼ˆçº§è”æ“ä½œï¼‰ | PostgreSQLæ›´å¤æ‚ |
| **æŸ¥è¯¢æ€§èƒ½** | æ— å½±å“ | æ— å½±å“ | ç›¸åŒ |
| **ç´¢å¼•éœ€æ±‚** | éœ€è¦ç´¢å¼• | éœ€è¦ç´¢å¼• | ç›¸åŒ |

### 4.4 å¤–é”®è¿ç§»ç­–ç•¥

#### è¿ç§»ç­–ç•¥1ï¼šç›´æŽ¥è¿ç§»ï¼ˆæŽ¨èï¼‰

```sql
-- SQLiteå¤–é”®å®šä¹‰
CREATE TABLE orders (
    id INTEGER PRIMARY KEY,
    user_id INTEGER,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- PostgreSQLå¤–é”®å®šä¹‰ï¼ˆç›´æŽ¥è¿ç§»ï¼‰
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE
);
```

#### è¿ç§»ç­–ç•¥2ï¼šå»¶è¿Ÿçº¦æŸï¼ˆé«˜çº§åœºæ™¯ï¼‰

```sql
-- PostgreSQL: å»¶è¿Ÿå¤–é”®çº¦æŸ
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INTEGER,
    CONSTRAINT fk_user
        FOREIGN KEY (user_id) REFERENCES users(id)
        DEFERRABLE INITIALLY DEFERRED
);
```

---

## äº”ã€äº‹åŠ¡è¯­ä¹‰å…¼å®¹æ€§åˆ†æž

### 5.1 éš”ç¦»çº§åˆ«è¯­ä¹‰å¯¹æ¯”

#### SQLiteéš”ç¦»çº§åˆ«

**å”¯ä¸€éš”ç¦»çº§åˆ«ï¼šSERIALIZABLE**:

```sql
-- SQLite: åªæœ‰SERIALIZABLEéš”ç¦»çº§åˆ«
BEGIN TRANSACTION;
-- æ“ä½œ
COMMIT;
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- ä¸¥æ ¼çš„ä¸²è¡ŒåŒ–
- è¯»æœªæäº¤ã€è¯»å·²æäº¤ã€å¯é‡å¤è¯»éƒ½ä¸å¯ç”¨
- WALæ¨¡å¼æä¾›å¿«ç…§éš”ç¦»

#### PostgreSQLéš”ç¦»çº§åˆ«

**å››ç§éš”ç¦»çº§åˆ«**ï¼š

```sql
-- PostgreSQL: å››ç§éš”ç¦»çº§åˆ«
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;  -- è¯»æœªæäº¤
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;    -- è¯»å·²æäº¤ï¼ˆé»˜è®¤ï¼‰
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;    -- å¯é‡å¤è¯»
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;      -- ä¸²è¡ŒåŒ–
```

**è¯­ä¹‰ç‰¹å¾**ï¼š

- çµæ´»çš„éš”ç¦»çº§åˆ«é€‰æ‹©
- é»˜è®¤READ COMMITTED
- MVCCå®žçŽ°

#### éš”ç¦»çº§åˆ«è¯­ä¹‰æ˜ å°„

| SQLiteè¯­ä¹‰ | PostgreSQLç­‰ä»· | å…¼å®¹æ€§ | è¿ç§»ç­–ç•¥ |
|-----------|---------------|--------|---------|
| **SERIALIZABLE** | SERIALIZABLE | âœ… 100% | ç›´æŽ¥æ˜ å°„ |
| **WALå¿«ç…§éš”ç¦»** | REPEATABLE READ | âš ï¸ 90% | ä½¿ç”¨REPEATABLE READ |

### 5.2 é”è¯­ä¹‰å·®å¼‚

#### é”æœºåˆ¶å¯¹æ¯”

| é”ç±»åž‹ | SQLiteè¯­ä¹‰ | PostgreSQLè¯­ä¹‰ | å…¼å®¹æ€§ |
|--------|-----------|---------------|--------|
| **å…±äº«é”** | SHARED | AccessShareLock | âš ï¸ 80% |
| **ä¿ç•™é”** | RESERVED | RowExclusiveLock | âš ï¸ 70% |
| **æŽ’ä»–é”** | EXCLUSIVE | ExclusiveLock | âš ï¸ 80% |
| **è¡¨é”** | éšå¼ | æ˜¾å¼ | âš ï¸ 60% |

#### é”è¯­ä¹‰è¿ç§»å½±å“

**SQLiteé”è¯­ä¹‰**ï¼š

- æ–‡ä»¶çº§é”
- éšå¼é”ç®¡ç†
- WALæ¨¡å¼ä¼˜åŒ–

**PostgreSQLé”è¯­ä¹‰**ï¼š

- è¡Œçº§é”
- æ˜¾å¼é”ç®¡ç†
- MVCCä¼˜åŒ–

### 5.3 å¹¶å‘æŽ§åˆ¶è¯­ä¹‰

#### å¹¶å‘æ¨¡åž‹å¯¹æ¯”

**SQLiteå¹¶å‘æ¨¡åž‹**ï¼š

```text
SQLiteå¹¶å‘ = {
    è¯»å¹¶å‘: WALæ¨¡å¼æ”¯æŒå¤šè¯»
    å†™å¹¶å‘: å•å†™è€…é™åˆ¶
    éš”ç¦»: SERIALIZABLE
    å®žçŽ°: æ–‡ä»¶é” + WAL
}
```

**PostgreSQLå¹¶å‘æ¨¡åž‹**ï¼š

```text
PostgreSQLå¹¶å‘ = {
    è¯»å¹¶å‘: MVCCå¤šè¯»
    å†™å¹¶å‘: MVCCå¤šå†™
    éš”ç¦»: å¯é…ç½®
    å®žçŽ°: MVCC + è¡Œé”
}
```

---

## å…­ã€æ•°æ®è¯­ä¹‰å…¼å®¹æ€§åˆ†æž

### 6.1 æ•°æ®å€¼è¯­ä¹‰æ˜ å°„

#### æ•°å€¼è¯­ä¹‰æ˜ å°„

**æ•´æ•°è¯­ä¹‰**ï¼š

```sql
-- SQLite: INTEGERå­˜å‚¨ç±»
-- è¯­ä¹‰ï¼šä»»æ„å¤§å°çš„æ•´æ•°ï¼ˆ1-8å­—èŠ‚è‡ªé€‚åº”ï¼‰
INSERT INTO t(id) VALUES (123);
INSERT INTO t(id) VALUES (9223372036854775807);

-- PostgreSQL: INTEGERç±»åž‹
-- è¯­ä¹‰ï¼šå›ºå®š4å­—èŠ‚æ•´æ•°ï¼ˆ-2^31 åˆ° 2^31-1ï¼‰
-- æ˜ å°„ç­–ç•¥ï¼š
-- 1. æ£€æŸ¥å€¼èŒƒå›´
-- 2. å°äºŽ2^31-1 â†’ INTEGER
-- 3. å¤§äºŽ2^31-1 â†’ BIGINT
```

**æµ®ç‚¹æ•°è¯­ä¹‰**ï¼š

```sql
-- SQLite: REALå­˜å‚¨ç±»
-- è¯­ä¹‰ï¼šIEEE 754åŒç²¾åº¦æµ®ç‚¹æ•°
INSERT INTO t(price) VALUES (19.999999);

-- PostgreSQL: REAL / DOUBLE PRECISION
-- è¯­ä¹‰ï¼šå•ç²¾åº¦ / åŒç²¾åº¦æµ®ç‚¹æ•°
-- æ˜ å°„ç­–ç•¥ï¼š
-- 1. ç²¾åº¦è¦æ±‚é«˜ â†’ NUMERIC
-- 2. ç²¾åº¦è¦æ±‚ä½Ž â†’ REAL / DOUBLE PRECISION
```

### 6.2 NULLè¯­ä¹‰å…¼å®¹æ€§

#### NULLå¤„ç†è¯­ä¹‰å¯¹æ¯”

**SQLite NULLè¯­ä¹‰**ï¼š

- NULLå¯ä»¥å­˜å‚¨åœ¨ä»»æ„ç±»åž‹åˆ—
- NULLå‚ä¸Žæ¯”è¾ƒæ—¶ç»“æžœä¸ºNULL
- NULLåœ¨èšåˆå‡½æ•°ä¸­è¢«å¿½ç•¥

**PostgreSQL NULLè¯­ä¹‰**ï¼š

- NULLå¯ä»¥å­˜å‚¨åœ¨ä»»æ„ç±»åž‹åˆ—
- NULLå‚ä¸Žæ¯”è¾ƒæ—¶ç»“æžœä¸ºNULL
- NULLåœ¨èšåˆå‡½æ•°ä¸­è¢«å¿½ç•¥

**å…¼å®¹æ€§**ï¼šâœ… 100%å…¼å®¹

#### NULLè¯­ä¹‰è¿ç§»ç¤ºä¾‹

```sql
-- SQLite: NULLå¤„ç†
SELECT
    COUNT(*),           -- åŒ…æ‹¬NULL
    COUNT(column),      -- æŽ’é™¤NULL
    SUM(column)         -- NULLè§†ä¸º0
FROM t;

-- PostgreSQL: ç›¸åŒè¯­ä¹‰
SELECT
    COUNT(*),           -- åŒ…æ‹¬NULL
    COUNT(column),      -- æŽ’é™¤NULL
    SUM(column)         -- NULLè§†ä¸º0
FROM t;
```

### 6.3 æ—¥æœŸæ—¶é—´è¯­ä¹‰å·®å¼‚

#### æ—¥æœŸæ—¶é—´å­˜å‚¨è¯­ä¹‰

**SQLiteæ—¥æœŸæ—¶é—´è¯­ä¹‰**ï¼š

```sql
-- SQLite: å¤šç§å­˜å‚¨æ–¹å¼
-- æ–¹å¼1: TEXT (ISO8601)
INSERT INTO logs(created_at) VALUES ('2025-11-13 10:00:00');

-- æ–¹å¼2: INTEGER (Unixæ—¶é—´æˆ³)
INSERT INTO logs(created_at) VALUES (1731470400);

-- æ–¹å¼3: REAL (Julian Day)
INSERT INTO logs(created_at) VALUES (2460287.91667);
```

**PostgreSQLæ—¥æœŸæ—¶é—´è¯­ä¹‰**ï¼š

```sql
-- PostgreSQL: æ ‡å‡†æ—¥æœŸæ—¶é—´ç±»åž‹
INSERT INTO logs(created_at) VALUES ('2025-11-13 10:00:00'::TIMESTAMP);
INSERT INTO logs(created_at) VALUES (TIMESTAMP '2025-11-13 10:00:00');
```

#### æ—¥æœŸæ—¶é—´è¯­ä¹‰è¿ç§»ç­–ç•¥

**ç­–ç•¥1ï¼šç»Ÿä¸€è½¬æ¢ä¸ºTIMESTAMP**:

```sql
-- åˆ†æžSQLiteæ•°æ®æ ¼å¼
-- 1. è¯†åˆ«å­˜å‚¨æ ¼å¼ï¼ˆTEXT/INTEGER/REALï¼‰
-- 2. è½¬æ¢ä¸ºTIMESTAMP

-- SQLite INTEGERæ—¶é—´æˆ³ â†’ PostgreSQL TIMESTAMP
ALTER TABLE logs
    ALTER COLUMN created_at TYPE TIMESTAMP
    USING to_timestamp(created_at);
```

**ç­–ç•¥2ï¼šä¿æŒåŽŸå§‹æ ¼å¼ï¼ˆä¸æŽ¨èï¼‰**:

```sql
-- ä¿æŒINTEGERå­˜å‚¨æ—¶é—´æˆ³
ALTER TABLE logs
    ALTER COLUMN created_at TYPE BIGINT;
```

### 6.4 å­—ç¬¦ä¸²ç¼–ç è¯­ä¹‰

#### ç¼–ç è¯­ä¹‰å¯¹æ¯”

**SQLiteç¼–ç è¯­ä¹‰**ï¼š

- UTF-8æˆ–UTF-16ç¼–ç 
- æ•°æ®åº“çº§åˆ«ç¼–ç 
- å­—ç¬¦ä¸²æ¯”è¾ƒåŸºäºŽå­—èŠ‚

**PostgreSQLç¼–ç è¯­ä¹‰**ï¼š

- æ•°æ®åº“çº§åˆ«ç¼–ç ï¼ˆUTF-8æŽ¨èï¼‰
- åˆ—çº§åˆ«æŽ’åºè§„åˆ™
- å­—ç¬¦ä¸²æ¯”è¾ƒåŸºäºŽå­—ç¬¦

#### ç¼–ç è¯­ä¹‰è¿ç§»

```sql
-- SQLite: UTF-8ç¼–ç 
CREATE TABLE users(name TEXT);

-- PostgreSQL: UTF-8ç¼–ç  + æŽ’åºè§„åˆ™
CREATE TABLE users(
    name TEXT COLLATE "en_US.utf8"
);
```

---

## ä¸ƒã€å…¼å®¹æ€§è¯„ä¼°æ¡†æž¶

### 7.1 å…¼å®¹æ€§è¯„åˆ†æ¨¡åž‹

#### è¯„åˆ†ç»´åº¦

**ç»´åº¦1ï¼šè¯­æ³•å…¼å®¹æ€§ï¼ˆæƒé‡30%ï¼‰**:

- DDLè¯­æ³•å…¼å®¹æ€§
- DMLè¯­æ³•å…¼å®¹æ€§
- å‡½æ•°è¯­æ³•å…¼å®¹æ€§

**ç»´åº¦2ï¼šè¯­ä¹‰å…¼å®¹æ€§ï¼ˆæƒé‡40%ï¼‰**:

- ç±»åž‹è¯­ä¹‰å…¼å®¹æ€§
- çº¦æŸè¯­ä¹‰å…¼å®¹æ€§
- äº‹åŠ¡è¯­ä¹‰å…¼å®¹æ€§

**ç»´åº¦3ï¼šæ•°æ®å…¼å®¹æ€§ï¼ˆæƒé‡30%ï¼‰**:

- æ•°æ®å€¼å…¼å®¹æ€§
- æ•°æ®èŒƒå›´å…¼å®¹æ€§
- æ•°æ®ç²¾åº¦å…¼å®¹æ€§

#### ç»¼åˆè¯„åˆ†å…¬å¼

```text
ç»¼åˆå…¼å®¹æ€§è¯„åˆ† =
    è¯­æ³•å…¼å®¹æ€§ Ã— 0.3 +
    è¯­ä¹‰å…¼å®¹æ€§ Ã— 0.4 +
    æ•°æ®å…¼å®¹æ€§ Ã— 0.3
```

#### è¯„åˆ†ç¤ºä¾‹

**ç¤ºä¾‹è¡¨å…¼å®¹æ€§è¯„åˆ†**ï¼š

```sql
-- SQLiteè¡¨
CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    name TEXT,
    price REAL,
    created_at INTEGER
);

-- è¯„åˆ†è®¡ç®—ï¼š
-- è¯­æ³•å…¼å®¹æ€§: 85% (AUTOINCREMENTéœ€è¦è½¬æ¢)
-- è¯­ä¹‰å…¼å®¹æ€§: 75% (åŠ¨æ€ç±»åž‹éœ€è¦æ˜ å°„)
-- æ•°æ®å…¼å®¹æ€§: 90% (æ•°æ®å€¼åŸºæœ¬å…¼å®¹)
-- ç»¼åˆè¯„åˆ†: 85% Ã— 0.3 + 75% Ã— 0.4 + 90% Ã— 0.3 = 82.5%
```

### 7.2 è¿ç§»é£Žé™©çŸ©é˜µ

#### é£Žé™©çŸ©é˜µ

| å…¼å®¹æ€§è¯„åˆ† | è¿ç§»é£Žé™© | å»ºè®®æŽªæ–½ |
|-----------|---------|---------|
| **90-100%** | ðŸŸ¢ ä½Žé£Žé™© | ç›´æŽ¥è¿ç§» |
| **70-89%** | ðŸŸ¡ ä¸­é£Žé™© | å……åˆ†æµ‹è¯• |
| **50-69%** | ðŸŸ  é«˜é£Žé™© | è¯¦ç»†åˆ†æž |
| **<50%** | ðŸ”´ æžé«˜é£Žé™© | é‡æ–°è®¾è®¡ |

### 7.3 å…¼å®¹æ€§æ£€æŸ¥æ¸…å•

#### æ£€æŸ¥æ¸…å•

**ç±»åž‹ç³»ç»Ÿæ£€æŸ¥**ï¼š

- [ ] åˆ†æžæ‰€æœ‰åˆ—çš„å®žé™…æ•°æ®ç±»åž‹
- [ ] æ£€æŸ¥INTEGERå€¼èŒƒå›´
- [ ] æ£€æŸ¥REALç²¾åº¦éœ€æ±‚
- [ ] æ£€æŸ¥TEXTé•¿åº¦éœ€æ±‚

**è¡¨ç»“æž„æ£€æŸ¥**ï¼š

- [ ] æ£€æŸ¥ä¸»é”®å®šä¹‰
- [ ] æ£€æŸ¥å¤–é”®å®šä¹‰
- [ ] æ£€æŸ¥çº¦æŸå®šä¹‰
- [ ] æ£€æŸ¥ç´¢å¼•å®šä¹‰

**SQLè¯­æ³•æ£€æŸ¥**ï¼š

- [ ] æ£€æŸ¥DDLè¯­å¥
- [ ] æ£€æŸ¥DMLè¯­å¥
- [ ] æ£€æŸ¥å‡½æ•°è°ƒç”¨
- [ ] æ£€æŸ¥ç‰¹æ®Šè¯­æ³•

**æ•°æ®è¯­ä¹‰æ£€æŸ¥**ï¼š

- [ ] æ£€æŸ¥NULLå¤„ç†
- [ ] æ£€æŸ¥æ—¥æœŸæ—¶é—´æ ¼å¼
- [ ] æ£€æŸ¥å­—ç¬¦ä¸²ç¼–ç 
- [ ] æ£€æŸ¥æ•°å€¼ç²¾åº¦

---

## ðŸ”— ç›¸å…³èµ„æº

- [10.01 SQLiteåˆ°PostgreSQLè¿ç§»æŒ‡å—](./10.01-SQLiteåˆ°PostgreSQLè¿ç§»æŒ‡å—.md)
- [02.01 æ•°æ®ç±»åž‹ç³»ç»Ÿ](../02-æ•°æ®æ¨¡åž‹/02.01-æ•°æ®ç±»åž‹ç³»ç»Ÿ.md)
- [05.01 å¤šç»´çŸ¥è¯†çŸ©é˜µ](../05-å¯¹æ¯”é€‰åž‹/05.01-å¤šç»´çŸ¥è¯†çŸ©é˜µ.md)

---

## ðŸ“š å‚è€ƒèµ„æ–™

- [SQLiteç±»åž‹ç³»ç»Ÿ](https://www.sqlite.org/datatype3.html)
- [PostgreSQLç±»åž‹ç³»ç»Ÿ](https://www.postgresql.org/docs/current/datatype.html)
- [SQLæ ‡å‡†å…¼å®¹æ€§](https://www.sqlite.org/footprint.html)

---

**ç»´æŠ¤è€…**ï¼šData-Science Team
**æœ€åŽæ›´æ–°**ï¼š2025-11-13

# SQL标准特性分类索引

> **创建日期**: 2025-12-04
> **覆盖范围**: SQL-92 到 SQL:2023
> **用途**: 快速查找特性所属标准

---

## 按功能分类

### 核心查询（Core）

| 特性 | 引入版本 | 说明 |
|------|---------|------|
| SELECT-FROM-WHERE | SQL-86 | 基础查询 |
| JOIN (INNER/LEFT/RIGHT) | SQL-92 | 表连接 |
| CROSS JOIN | SQL-92 | 笛卡尔积 |
| FULL OUTER JOIN | SQL-92 | 全外连接 |
| NATURAL JOIN | SQL-92 | 自然连接 |
| ORDER BY | SQL-86 | 排序 |
| GROUP BY | SQL-86 | 分组 |
| HAVING | SQL-86 | 分组过滤 |
| DISTINCT | SQL-86 | 去重 |
| UNION/INTERSECT/EXCEPT | SQL-86 | 集合操作 |

### 子查询（Subquery）

| 特性 | 引入版本 | 说明 |
|------|---------|------|
| 标量子查询 | SQL-86 | 返回单值 |
| IN子查询 | SQL-86 | 成员测试 |
| EXISTS子查询 | SQL-86 | 存在性测试 |
| 相关子查询 | SQL-86 | 引用外层表 |
| ALL/ANY/SOME | SQL-86 | 量词比较 |
| WITH (CTE) | SQL:1999 | 公共表表达式 |
| WITH RECURSIVE | SQL:1999 | 递归CTE |

### 窗口函数（Window Functions）

| 特性 | 引入版本 | 说明 |
|------|---------|------|
| ROW_NUMBER() | SQL:2003 | 行号 |
| RANK() | SQL:2003 | 排名 |
| DENSE_RANK() | SQL:2003 | 密集排名 |
| NTILE(n) | SQL:2003 | 分组 |
| LAG()/LEAD() | SQL:2011 | 偏移访问 |
| FIRST_VALUE()/LAST_VALUE() | SQL:2011 | 首尾值 |
| ROWS BETWEEN | SQL:2011 | 行窗口 |
| RANGE BETWEEN | SQL:2011 | 范围窗口 |
| GROUPS BETWEEN | SQL:2023 | 分组窗口 |

### 数据类型（Data Types）

| 特性 | 引入版本 | 说明 |
|------|---------|------|
| INTEGER/SMALLINT/BIGINT | SQL-86 | 整数 |
| DECIMAL/NUMERIC | SQL-86 | 精确数值 |
| FLOAT/REAL/DOUBLE | SQL-86 | 浮点数 |
| CHAR/VARCHAR | SQL-86 | 字符串 |
| DATE/TIME/TIMESTAMP | SQL-92 | 日期时间 |
| BOOLEAN | SQL:1999 | 布尔 |
| ARRAY | SQL:2003 | 数组 |
| ROW | SQL:2003 | 行类型 |
| XML | SQL:2003 | XML数据 |
| JSON | SQL:2016 | JSON数据 |

### DDL（数据定义）

| 特性 | 引入版本 | 说明 |
|------|---------|------|
| CREATE TABLE | SQL-86 | 创建表 |
| ALTER TABLE | SQL-92 | 修改表 |
| DROP TABLE | SQL-86 | 删除表 |
| CREATE INDEX | SQL-92 | 创建索引 |
| PRIMARY KEY | SQL-86 | 主键 |
| FOREIGN KEY | SQL-92 | 外键 |
| UNIQUE | SQL-86 | 唯一约束 |
| CHECK | SQL-92 | 检查约束 |
| DEFAULT | SQL-86 | 默认值 |
| AUTO INCREMENT | 非标准 | 自增（各DB实现不同） |
| GENERATED COLUMN | SQL:2003 | 生成列 |
| PARTITIONING | SQL:2003 | 分区表 |

### DML（数据操作）

| 特性 | 引入版本 | 说明 |
|------|---------|------|
| INSERT | SQL-86 | 插入 |
| UPDATE | SQL-86 | 更新 |
| DELETE | SQL-86 | 删除 |
| MERGE | SQL:2003 | 合并（UPSERT） |
| RETURNING | SQL:2008 | 返回修改的行 |
| INSERT ON CONFLICT | 非标准 | PostgreSQL扩展 |
| REPLACE | 非标准 | MySQL扩展 |

### 事务控制（Transaction）

| 特性 | 引入版本 | 说明 |
|------|---------|------|
| BEGIN/START TRANSACTION | SQL-92 | 开始事务 |
| COMMIT | SQL-86 | 提交 |
| ROLLBACK | SQL-86 | 回滚 |
| SAVEPOINT | SQL:2003 | 保存点 |
| ISOLATION LEVEL | SQL-92 | 隔离级别 |
| READ COMMITTED | SQL-92 | 读已提交 |
| REPEATABLE READ | SQL-92 | 可重复读 |
| SERIALIZABLE | SQL-92 | 可串行化 |
| READ UNCOMMITTED | SQL-92 | 读未提交 |

---

## 按标准版本分类

### SQL-86 (ANSI X3.135-1986)

**核心特性**:

- 基础查询：SELECT, FROM, WHERE
- 聚合函数：COUNT, SUM, AVG, MAX, MIN
- 分组：GROUP BY, HAVING
- 排序：ORDER BY
- 子查询：标量/IN/EXISTS
- 基础DDL：CREATE TABLE, PRIMARY KEY

### SQL-89 (ISO/IEC 9075:1989)

**增强**:

- 完整性约束强化
- 与SQL-86基本兼容

### SQL-92 (ISO/IEC 9075:1992)

**重大更新**:

- **JOIN语法**: INNER/LEFT/RIGHT/FULL JOIN
- **数据类型**: DATE, TIME, TIMESTAMP, INTERVAL
- **约束**: FOREIGN KEY, CHECK, CASCADE
- **模式**: CREATE SCHEMA
- **事务隔离级别**
- **临时表**: TEMPORARY TABLE
- **级联删除/更新**: ON DELETE/UPDATE CASCADE

### SQL:1999 (ISO/IEC 9075:1999)

**革命性更新**:

- **CTE**: WITH子句（公共表表达式）
- **递归查询**: WITH RECURSIVE
- **BOOLEAN类型**
- **触发器**: CREATE TRIGGER
- **存储过程**: CREATE PROCEDURE
- **用户自定义类型**: CREATE TYPE
- **CASE表达式增强**

### SQL:2003 (ISO/IEC 9075:2003)

**重大特性**:

- **窗口函数**: ROW_NUMBER, RANK, DENSE_RANK
- **MERGE语句**
- **XML支持**: XML数据类型, XQuery
- **SEQUENCE**: CREATE SEQUENCE
- **ARRAY类型**
- **GENERATED列**: 生成列/计算列
- **分区表**: PARTITION BY

### SQL:2006 (ISO/IEC 9075:2006)

**XML增强**:

- XML Schema支持
- XML Publishing

### SQL:2008 (ISO/IEC 9075:2008)

**增强**:

- **TRUNCATE TABLE**
- **FETCH FIRST**: 标准化LIMIT
- **ORDER BY NULLS FIRST/LAST**
- **RETURNING子句**: INSERT/UPDATE/DELETE返回行

### SQL:2011 (ISO/IEC 9075:2011)

**时态数据**:

- **时态表**: SYSTEM VERSIONING
- **窗口函数增强**: ROWS/RANGE BETWEEN
- **LAG/LEAD**: 偏移函数
- **LISTAGG**: 聚合为字符串

### SQL:2016 (ISO/IEC 9075:2016)

**JSON支持**:

- **JSON数据类型**
- **JSON函数**: JSON_VALUE, JSON_QUERY, JSON_EXISTS
- **JSON_TABLE**: JSON转表
- **行模式匹配**: MATCH_RECOGNIZE

### SQL:2023 (ISO/IEC 9075:2023)

**图数据与JSON增强**:

- **Property Graph**: CREATE PROPERTY GRAPH
- **图查询**: GRAPH_TABLE
- **JSON增强**: JSON path query
- **窗口函数**: GROUPS BETWEEN frame
- **多维数组支持**

---

## 数据库支持矩阵

```text
特性支持对比（PostgreSQL 18 | MySQL 8.4 | SQLite 3.47 | SQL Server 2022）
══════════════════════════════════════════════════════════════════════════════

特性                    | PG  | MySQL | SQLite | SQL Server
-----------------------|-----|-------|--------|------------
CTE (WITH)             | ✓   | ✓     | ✓      | ✓
Recursive CTE          | ✓   | ✓     | ✓      | ✓
窗口函数               | ✓   | ✓     | ✓      | ✓
MERGE                  | ✓   | △(8.0)| ✗      | ✓
JSON类型               | ✓   | ✓     | ✓(text)| ✓
JSON_TABLE             | △   | ✓     | ✗      | ✓
ARRAY类型              | ✓   | ✗     | ✗      | ✗
GENERATED列            | ✓   | ✓     | ✓      | ✓
分区表                 | ✓   | ✓     | ✗      | ✓
全文搜索               | ✓   | ✓     | ✓(FTS5)| ✓
Property Graph         | ✗   | ✗     | ✗      | ✗
RETURNING子句          | ✓   | ✗     | ✓      | ✓
LATERAL JOIN           | ✓   | ✓     | ✗      | ✓
FILTER子句             | ✓   | ✗     | ✗      | ✓

✓ = 完全支持
△ = 部分支持
✗ = 不支持
```

---

## 快速查找

### 我需要分页，用什么？

- **标准SQL:2008**: `FETCH FIRST n ROWS ONLY`
- **PostgreSQL/MySQL**: `LIMIT n OFFSET m`
- **SQL Server**: `OFFSET n ROWS FETCH NEXT m ROWS ONLY`
- **最佳实践**: Keyset分页（避免大OFFSET）

### 我需要UPSERT，用什么？

- **标准SQL:2003**: `MERGE INTO ... USING ...`
- **PostgreSQL**: `INSERT ... ON CONFLICT DO UPDATE`
- **MySQL**: `INSERT ... ON DUPLICATE KEY UPDATE`
- **SQLite**: `INSERT ... ON CONFLICT DO UPDATE`

### 我需要递归查询，用什么？

- **标准SQL:1999**: `WITH RECURSIVE cte AS ...`
- 所有现代数据库均支持

### 我需要JSON，用什么？

- **PostgreSQL**: `JSONB` (二进制JSON，最快)
- **MySQL**: `JSON` (自动验证)
- **SQLite**: `TEXT` + JSON函数
- **SQL Server**: `NVARCHAR(MAX)` + JSON函数

---

**索引版本**: v1.0.0
**最后更新**: 2025-12-04

# OLAPä¸OLTPè®¾è®¡

> **åˆ›å»ºæ—¥æœŸ**ï¼š2025-12-01
> **éš¾åº¦**ï¼šâ­â­â­â­
> **å‰ç½®çŸ¥è¯†**ï¼šæ•°æ®åº“åŸºç¡€ã€ç´¢å¼•åŸç†
> **åº”ç”¨åœºæ™¯**ï¼šç³»ç»Ÿæ¶æ„é€‰å‹ã€æ•°æ®åº“è®¾è®¡

---

## ğŸ“‹ ç›®å½•

- [OLAPä¸OLTPè®¾è®¡](#olapä¸oltpè®¾è®¡)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [ä¸€ã€æ¦‚è¿°](#ä¸€æ¦‚è¿°)
  - [äºŒã€OLTPè®¾è®¡æ¨¡å¼](#äºŒoltpè®¾è®¡æ¨¡å¼)
    - [2.1 èŒƒå¼åŒ–Schema](#21-èŒƒå¼åŒ–schema)
    - [2.2 OLTPç´¢å¼•ç­–ç•¥](#22-oltpç´¢å¼•ç­–ç•¥)
    - [2.3 OLTPæŸ¥è¯¢æ¨¡å¼](#23-oltpæŸ¥è¯¢æ¨¡å¼)
  - [ä¸‰ã€OLAPè®¾è®¡æ¨¡å¼](#ä¸‰olapè®¾è®¡æ¨¡å¼)
    - [3.1 ç»´åº¦æ¨¡å‹Schema](#31-ç»´åº¦æ¨¡å‹schema)
    - [3.2 OLAPç´¢å¼•ç­–ç•¥](#32-olapç´¢å¼•ç­–ç•¥)
    - [3.3 OLAPæŸ¥è¯¢æ¨¡å¼](#33-olapæŸ¥è¯¢æ¨¡å¼)
  - [å››ã€æ··åˆè´Ÿè½½(HTAP)](#å››æ··åˆè´Ÿè½½htap)
    - [4.1 HTAP SQLæ¨¡å¼](#41-htap-sqlæ¨¡å¼)
  - [äº”ã€PostgreSQL 18åŒæ¨¡å¼](#äº”postgresql-18åŒæ¨¡å¼)
    - [5.1 åˆ†åŒºè¡¨å®ç°HTAP](#51-åˆ†åŒºè¡¨å®ç°htap)
    - [5.2 æŸ¥è¯¢ä¼˜åŒ–å™¨æç¤º](#52-æŸ¥è¯¢ä¼˜åŒ–å™¨æç¤º)
  - [å…­ã€SQLiteåœºæ™¯é€‰æ‹©](#å…­sqliteåœºæ™¯é€‰æ‹©)
  - [å†³ç­–æ¡†æ¶](#å†³ç­–æ¡†æ¶)
  - [ç›¸å…³èµ„æº](#ç›¸å…³èµ„æº)
    - [ç›¸å…³æ–‡æ¡£](#ç›¸å…³æ–‡æ¡£)

---

## ä¸€ã€æ¦‚è¿°

```text
OLTP vs OLAP å¯¹æ¯”
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç‰¹å¾å¯¹æ¯”çŸ©é˜µ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     ç‰¹å¾         â”‚       OLTP             â”‚           OLAP                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç›®çš„             â”‚ æ—¥å¸¸ä¸šåŠ¡æ“ä½œ            â”‚ æ•°æ®åˆ†æå†³ç­–                      â”‚
â”‚ æ•°æ®çŠ¶æ€         â”‚ å½“å‰æ•°æ®               â”‚ å†å²æ•°æ®                          â”‚
â”‚ æ•°æ®è®¾è®¡         â”‚ é«˜åº¦è§„èŒƒåŒ–(3NF)         â”‚ åè§„èŒƒåŒ–(æ˜Ÿå‹/é›ªèŠ±)               â”‚
â”‚ æŸ¥è¯¢ç±»å‹         â”‚ ç®€å•æŸ¥è¯¢ã€äº‹åŠ¡          â”‚ å¤æ‚èšåˆã€åˆ†æ                    â”‚
â”‚ å“åº”æ—¶é—´         â”‚ æ¯«ç§’çº§                 â”‚ ç§’çº§åˆ°åˆ†é’Ÿçº§                      â”‚
â”‚ å¹¶å‘             â”‚ é«˜(æ•°åƒç”¨æˆ·)           â”‚ ä½(æ•°ååˆ†æå¸ˆ)                    â”‚
â”‚ æ•°æ®é‡           â”‚ GBçº§                  â”‚ TB-PBçº§                          â”‚
â”‚ æ›´æ–°             â”‚ é¢‘ç¹(INSERT/UPDATE)    â”‚ æ‰¹é‡åŠ è½½                         â”‚
â”‚ ç´¢å¼•ç­–ç•¥         â”‚ B-Treeä¸ºä¸»             â”‚ ä½å›¾/åˆ—å¼ç´¢å¼•                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€OLTPè®¾è®¡æ¨¡å¼

### 2.1 èŒƒå¼åŒ–Schema

```sql
-- OLTP: é«˜åº¦è§„èŒƒåŒ–è®¾è®¡ï¼ˆ3NFï¼‰
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    user_id         SERIAL PRIMARY KEY,
    username        VARCHAR(50) UNIQUE NOT NULL,
    email           VARCHAR(100) UNIQUE NOT NULL,
    password_hash   VARCHAR(255) NOT NULL,
    created_at      TIMESTAMPTZ DEFAULT NOW()
);

-- è®¢å•è¡¨ï¼ˆå¤–é”®å…³è”ï¼Œæ— å†—ä½™ï¼‰
CREATE TABLE orders (
    order_id        SERIAL PRIMARY KEY,
    user_id         INTEGER NOT NULL REFERENCES users(user_id),
    order_date      TIMESTAMPTZ DEFAULT NOW(),
    status          VARCHAR(20) DEFAULT 'pending'
);

-- è®¢å•é¡¹è¡¨
CREATE TABLE order_items (
    item_id         SERIAL PRIMARY KEY,
    order_id        INTEGER NOT NULL REFERENCES orders(order_id),
    product_id      INTEGER NOT NULL REFERENCES products(product_id),
    quantity        INTEGER NOT NULL CHECK (quantity > 0),
    unit_price      DECIMAL(10,2) NOT NULL
);
```

### 2.2 OLTPç´¢å¼•ç­–ç•¥

```sql
-- OLTP: é’ˆå¯¹ç‚¹æŸ¥è¯¢å’ŒèŒƒå›´æŸ¥è¯¢ä¼˜åŒ–
-- ä¸»é”®ç´¢å¼•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
-- å¤–é”®ç´¢å¼•
CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_order_items_order ON order_items(order_id);
CREATE INDEX idx_order_items_product ON order_items(product_id);

-- ä¸šåŠ¡æŸ¥è¯¢ç´¢å¼•
CREATE INDEX idx_orders_status_date ON orders(status, order_date DESC);
CREATE INDEX idx_users_email ON users(email);  -- ç™»å½•æŸ¥è¯¢

-- éƒ¨åˆ†ç´¢å¼•ï¼ˆåªç´¢å¼•æ´»è·ƒæ•°æ®ï¼‰
CREATE INDEX idx_orders_pending ON orders(order_date)
WHERE status = 'pending';
```

### 2.3 OLTPæŸ¥è¯¢æ¨¡å¼

```sql
-- OLTPå…¸å‹æŸ¥è¯¢ï¼šç®€å•ã€å¿«é€Ÿã€äº‹åŠ¡æ€§

-- 1. ç‚¹æŸ¥è¯¢
SELECT * FROM users WHERE user_id = 123;

-- 2. å…³è”æŸ¥è¯¢ï¼ˆå°‘é‡JOINï¼‰
SELECT o.*, u.username
FROM orders o
JOIN users u ON o.user_id = u.user_id
WHERE o.order_id = 456;

-- 3. äº‹åŠ¡æ“ä½œ
BEGIN;
INSERT INTO orders (user_id) VALUES (123) RETURNING order_id;
INSERT INTO order_items (order_id, product_id, quantity, unit_price)
VALUES (currval('orders_order_id_seq'), 1, 2, 29.99);
UPDATE products SET stock = stock - 2 WHERE product_id = 1;
COMMIT;
```

---

## ä¸‰ã€OLAPè®¾è®¡æ¨¡å¼

### 3.1 ç»´åº¦æ¨¡å‹Schema

```sql
-- OLAP: æ˜Ÿå‹æ¨¡å‹ï¼ˆåè§„èŒƒåŒ–ï¼‰
-- äº‹å®è¡¨
CREATE TABLE fact_sales (
    sale_key        BIGSERIAL,
    date_key        INTEGER NOT NULL,
    product_key     INTEGER NOT NULL,
    customer_key    INTEGER NOT NULL,
    store_key       INTEGER NOT NULL,
    quantity        INTEGER NOT NULL,
    amount          DECIMAL(12,2) NOT NULL,
    cost            DECIMAL(12,2),
    profit          DECIMAL(12,2)
) PARTITION BY RANGE (date_key);

-- ç»´åº¦è¡¨ï¼ˆåŒ…å«å†—ä½™å±æ€§ï¼‰
CREATE TABLE dim_product (
    product_key     SERIAL PRIMARY KEY,
    product_id      INTEGER,
    product_name    VARCHAR(200),
    category        VARCHAR(100),  -- å†—ä½™ï¼šæ— éœ€JOINç±»åˆ«è¡¨
    subcategory     VARCHAR(100),
    brand           VARCHAR(100),
    unit_price      DECIMAL(10,2)
);
```

### 3.2 OLAPç´¢å¼•ç­–ç•¥

```sql
-- OLAP: é’ˆå¯¹èšåˆæŸ¥è¯¢ä¼˜åŒ–
-- åˆ†åŒºï¼ˆæŒ‰æ—¶é—´ï¼‰
CREATE TABLE fact_sales_2025 PARTITION OF fact_sales
FOR VALUES FROM (20250101) TO (20260101);

-- ä½å›¾ç´¢å¼•ï¼ˆPostgreSQLä½¿ç”¨GINæ¨¡æ‹Ÿï¼‰
-- é€‚åˆä½åŸºæ•°åˆ—ï¼ˆå¦‚çŠ¶æ€ã€ç±»åˆ«ï¼‰
CREATE INDEX idx_fact_category ON dim_product USING GIN (to_tsvector('simple', category));

-- BRINç´¢å¼•ï¼ˆé€‚åˆæœ‰åºæ•°æ®ï¼‰
CREATE INDEX idx_fact_date_brin ON fact_sales USING BRIN (date_key);

-- è¦†ç›–ç´¢å¼•ï¼ˆåŒ…å«å¸¸ç”¨èšåˆåˆ—ï¼‰
CREATE INDEX idx_fact_analysis ON fact_sales (date_key, product_key)
INCLUDE (quantity, amount);
```

### 3.3 OLAPæŸ¥è¯¢æ¨¡å¼

```sql
-- OLAPå…¸å‹æŸ¥è¯¢ï¼šå¤æ‚èšåˆã€å¤šç»´åˆ†æ

-- 1. å¤šç»´èšåˆ
SELECT
    d.year, d.quarter, p.category,
    SUM(f.amount) AS total_sales,
    SUM(f.profit) AS total_profit
FROM fact_sales f
JOIN dim_date d ON f.date_key = d.date_key
JOIN dim_product p ON f.product_key = p.product_key
GROUP BY CUBE (d.year, d.quarter, p.category);

-- 2. çª—å£åˆ†æ
SELECT
    date_key,
    amount,
    SUM(amount) OVER (ORDER BY date_key ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS ma7,
    RANK() OVER (PARTITION BY product_key ORDER BY amount DESC) AS sales_rank
FROM fact_sales;

-- 3. åŒæ¯”ç¯æ¯”
SELECT
    year, month,
    sales,
    LAG(sales, 12) OVER (ORDER BY year, month) AS prev_year,
    sales - LAG(sales, 12) OVER (ORDER BY year, month) AS yoy_change
FROM monthly_sales_summary;
```

---

## å››ã€æ··åˆè´Ÿè½½(HTAP)

```text
HTAPæ¶æ„
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            HTAP (æ··åˆäº‹åŠ¡åˆ†æå¤„ç†)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚  OLTPè¯·æ±‚   â”‚â”€â”€â”€â”€â”€â†’â”‚                      â”‚â†â”€â”€â”€â”€â”€â”‚  OLAPè¯·æ±‚   â”‚         â”‚
â”‚   â”‚  (å†™å…¥ä¸ºä¸») â”‚       â”‚    HTAP æ•°æ®åº“       â”‚      â”‚  (è¯»å–ä¸ºä¸») â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   (å•ä¸€å­˜å‚¨å¼•æ“)     â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                        â”‚                     â”‚                              â”‚
â”‚                        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”‚                              â”‚
â”‚                        â”‚  â”‚è¡Œå­˜å‚¨ â”‚ â”‚åˆ—å­˜å‚¨ â”‚â”‚                               â”‚
â”‚                        â”‚  â”‚(OLTP) â”‚ â”‚(OLAP) â”‚â”‚                              â”‚
â”‚                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜â”‚                              â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                             â”‚
â”‚   ä¼˜åŠ¿ï¼šå®æ—¶åˆ†æã€ç®€åŒ–æ¶æ„ã€æ•°æ®ä¸€è‡´æ€§                                         â”‚
â”‚   æŒ‘æˆ˜ï¼šèµ„æºç«äº‰ã€ä¼˜åŒ–å¤æ‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.1 HTAP SQLæ¨¡å¼

```sql
-- PostgreSQL 18: HTAPæ¨¡å¼å®ç°
-- ä½¿ç”¨ç‰©åŒ–è§†å›¾å®ç°è¿‘å®æ—¶åˆ†æ

-- ä¸»è¡¨ï¼ˆOLTPä¼˜åŒ–ï¼‰
CREATE TABLE transactions (
    txn_id          BIGSERIAL PRIMARY KEY,
    account_id      INTEGER NOT NULL,
    amount          DECIMAL(12,2) NOT NULL,
    txn_type        VARCHAR(20) NOT NULL,
    created_at      TIMESTAMPTZ DEFAULT NOW()
);

-- ç‰©åŒ–è§†å›¾ï¼ˆOLAPä¼˜åŒ–ï¼‰
CREATE MATERIALIZED VIEW mv_hourly_stats AS
SELECT
    DATE_TRUNC('hour', created_at) AS hour,
    txn_type,
    COUNT(*) AS txn_count,
    SUM(amount) AS total_amount,
    AVG(amount) AS avg_amount
FROM transactions
GROUP BY DATE_TRUNC('hour', created_at), txn_type;

-- å¹¶å‘åˆ·æ–°ï¼ˆä¸é˜»å¡æŸ¥è¯¢ï¼‰
CREATE UNIQUE INDEX idx_mv_hourly ON mv_hourly_stats(hour, txn_type);
REFRESH MATERIALIZED VIEW CONCURRENTLY mv_hourly_stats;

-- OLTPæŸ¥è¯¢
SELECT * FROM transactions WHERE account_id = 123 ORDER BY created_at DESC LIMIT 10;

-- OLAPæŸ¥è¯¢ï¼ˆä½¿ç”¨ç‰©åŒ–è§†å›¾ï¼‰
SELECT hour, SUM(txn_count), SUM(total_amount) FROM mv_hourly_stats GROUP BY hour;
```

---

## äº”ã€PostgreSQL 18åŒæ¨¡å¼

### 5.1 åˆ†åŒºè¡¨å®ç°HTAP

```sql
-- PostgreSQL 18: çƒ­/æ¸©/å†·æ•°æ®åˆ†åŒº
CREATE TABLE sales (
    sale_id         BIGSERIAL,
    sale_date       DATE NOT NULL,
    amount          DECIMAL(12,2),
    details         JSONB
) PARTITION BY RANGE (sale_date);

-- çƒ­æ•°æ®ï¼šæœ€è¿‘7å¤©ï¼ˆé¢‘ç¹OLTPï¼‰
CREATE TABLE sales_hot PARTITION OF sales
FOR VALUES FROM (CURRENT_DATE - 7) TO (CURRENT_DATE + 1)
TABLESPACE fast_ssd;

-- æ¸©æ•°æ®ï¼šæœ€è¿‘90å¤©ï¼ˆæ··åˆè´Ÿè½½ï¼‰
CREATE TABLE sales_warm PARTITION OF sales
FOR VALUES FROM (CURRENT_DATE - 90) TO (CURRENT_DATE - 7);

-- å†·æ•°æ®ï¼šå†å²ï¼ˆä¸»è¦OLAPï¼‰
CREATE TABLE sales_cold PARTITION OF sales
FOR VALUES FROM ('2020-01-01') TO (CURRENT_DATE - 90)
TABLESPACE slow_hdd;
```

### 5.2 æŸ¥è¯¢ä¼˜åŒ–å™¨æç¤º

```sql
-- PostgreSQL 18: é’ˆå¯¹ä¸åŒè´Ÿè½½ä¼˜åŒ–
-- OLTPæŸ¥è¯¢ï¼ˆä½¿ç”¨ç´¢å¼•ï¼‰
SET enable_seqscan = off;
SELECT * FROM orders WHERE order_id = 123;

-- OLAPæŸ¥è¯¢ï¼ˆå…è®¸é¡ºåºæ‰«æï¼‰
SET enable_seqscan = on;
SET work_mem = '1GB';  -- å¢åŠ æ’åºå†…å­˜
SELECT category, SUM(amount) FROM sales GROUP BY category;
```

---

## å…­ã€SQLiteåœºæ™¯é€‰æ‹©

```sql
-- SQLite: ä¸»è¦é€‚åˆOLTPåœºæ™¯
-- åµŒå…¥å¼ã€å•ç”¨æˆ·ã€ä¸­å°æ•°æ®é‡

-- OLTPä¼˜åŒ–é…ç½®
PRAGMA journal_mode = WAL;      -- å¹¶å‘è¯»å†™
PRAGMA synchronous = NORMAL;    -- æ€§èƒ½vså®‰å…¨å¹³è¡¡
PRAGMA cache_size = -64000;     -- 64MBç¼“å­˜

-- OLTPç´¢å¼•
CREATE INDEX idx_orders_user ON orders(user_id);
CREATE INDEX idx_orders_date ON orders(order_date);

-- ç®€å•åˆ†ææŸ¥è¯¢ï¼ˆSQLiteä¹Ÿæ”¯æŒçª—å£å‡½æ•°ï¼‰
SELECT
    strftime('%Y-%m', order_date) AS month,
    SUM(total_amount) AS sales,
    SUM(SUM(total_amount)) OVER (ORDER BY strftime('%Y-%m', order_date)) AS cumulative
FROM orders
GROUP BY strftime('%Y-%m', order_date);
```

---

## å†³ç­–æ¡†æ¶

```text
OLTP/OLAPé€‰å‹å†³ç­–æ ‘
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ä¸»è¦å·¥ä½œè´Ÿè½½?]
    â”‚
    â”œâ”€â†’ äº‹åŠ¡å¤„ç†ä¸ºä¸» â”€â†’ OLTP
    â”‚     â”‚
    â”‚     â””â”€â†’ [æ•°æ®é‡?]
    â”‚           â”œâ”€â†’ < 100GB â”€â†’ PostgreSQL / MySQL
    â”‚           â””â”€â†’ > 100GB â”€â†’ PostgreSQL + åˆ†åŒº
    â”‚
    â”œâ”€â†’ åˆ†ææŸ¥è¯¢ä¸ºä¸» â”€â†’ OLAP
    â”‚     â”‚
    â”‚     â””â”€â†’ [å®æ—¶æ€§è¦æ±‚?]
    â”‚           â”œâ”€â†’ é«˜ â”€â†’ ClickHouse / Druid
    â”‚           â””â”€â†’ ä½ â”€â†’ PostgreSQL + ç‰©åŒ–è§†å›¾
    â”‚
    â””â”€â†’ æ··åˆè´Ÿè½½ â”€â†’ HTAP
          â”‚
          â””â”€â†’ PostgreSQL + åˆ†åŒº + ç‰©åŒ–è§†å›¾
              æˆ– TiDB / CockroachDB
```

---

## ç›¸å…³èµ„æº

### ç›¸å…³æ–‡æ¡£

- [10.04-æ•°æ®ä»“åº“SQLè®¾è®¡](./10.04-æ•°æ®ä»“åº“SQLè®¾è®¡.md)
- [10.02-åèŒƒå¼ä¸æ€§èƒ½ä¼˜åŒ–](./10.02-åèŒƒå¼ä¸æ€§èƒ½ä¼˜åŒ–.md)
- [Design/07.08-æ€§èƒ½è°ƒä¼˜](../../Design/07-æ•°æ®åº“è®¾è®¡å®è·µ/07.08-æ•°æ®åº“æ€§èƒ½è°ƒä¼˜å®æˆ˜.md)

---

**ç»´æŠ¤è€…**: SQL Standards Team
**æœ€åæ›´æ–°**: 2025-12-01

# SQLå·¥å…·æŒ‡å—

> **åˆ›å»ºæ—¥æœŸ**ï¼š2025-01-15
> **æœ€åæ›´æ–°**ï¼š2025-01-16
> **ç‰ˆæœ¬**ï¼šv1.0.0
> **éš¾åº¦**ï¼šâ­â­
> **åº”ç”¨åœºæ™¯**ï¼šSQLå·¥å…·é€‰æ‹©ã€å¼€å‘æ•ˆç‡æå‡

---

## ğŸ“‹ ç›®å½•

- [SQLå·¥å…·æŒ‡å—](#sqlå·¥å…·æŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [ä¸€ã€æ¦‚è¿°](#ä¸€æ¦‚è¿°)
    - [1.1 SQLå·¥å…·åˆ†ç±»æ€ç»´å¯¼å›¾](#11-sqlå·¥å…·åˆ†ç±»æ€ç»´å¯¼å›¾)
    - [1.2 SQLå·¥å…·é€‰æ‹©å†³ç­–æ ‘](#12-sqlå·¥å…·é€‰æ‹©å†³ç­–æ ‘)
    - [1.3 SQLå·¥å…·å¯¹æ¯”çŸ©é˜µ](#13-sqlå·¥å…·å¯¹æ¯”çŸ©é˜µ)
  - [äºŒã€SQLç¼–è¾‘å™¨](#äºŒsqlç¼–è¾‘å™¨)
    - [2.1 DBeaver - è·¨å¹³å°æ•°æ®åº“å·¥å…·](#21-dbeaver---è·¨å¹³å°æ•°æ®åº“å·¥å…·)
    - [2.1.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šå­¦ç”Ÿç®¡ç†ç³»ç»ŸæŸ¥è¯¢](#211-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹å­¦ç”Ÿç®¡ç†ç³»ç»ŸæŸ¥è¯¢)
    - [2.2 DataGrip - JetBrainsæ•°æ®åº“IDE](#22-datagrip---jetbrainsæ•°æ®åº“ide)
    - [2.2.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šå¤æ‚æŸ¥è¯¢å¼€å‘](#221-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹å¤æ‚æŸ¥è¯¢å¼€å‘)
    - [2.3 pgAdmin - PostgreSQLç®¡ç†å·¥å…·](#23-pgadmin---postgresqlç®¡ç†å·¥å…·)
    - [2.3.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šæ•°æ®åº“ç®¡ç†](#231-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹æ•°æ®åº“ç®¡ç†)
  - [ä¸‰ã€æ•°æ®åº“ç®¡ç†å·¥å…·](#ä¸‰æ•°æ®åº“ç®¡ç†å·¥å…·)
    - [3.1 phpMyAdmin - Web-based MySQLç®¡ç†](#31-phpmyadmin---web-based-mysqlç®¡ç†)
    - [3.1.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šWebç¯å¢ƒæ•°æ®åº“ç®¡ç†](#311-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹webç¯å¢ƒæ•°æ®åº“ç®¡ç†)
    - [3.2 TablePlus - ç°ä»£æ•°æ®åº“ç®¡ç†å·¥å…·](#32-tableplus---ç°ä»£æ•°æ®åº“ç®¡ç†å·¥å…·)
    - [3.2.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šå¿«é€Ÿæ•°æ®æµè§ˆå’Œç¼–è¾‘](#321-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹å¿«é€Ÿæ•°æ®æµè§ˆå’Œç¼–è¾‘)
  - [å››ã€æŸ¥è¯¢åˆ†æå·¥å…·](#å››æŸ¥è¯¢åˆ†æå·¥å…·)
    - [4.1 EXPLAIN - æŸ¥è¯¢è®¡åˆ’åˆ†æ](#41-explain---æŸ¥è¯¢è®¡åˆ’åˆ†æ)
    - [4.1.1 PostgreSQL EXPLAINç¤ºä¾‹](#411-postgresql-explainç¤ºä¾‹)
    - [4.1.2 æ‰§è¡Œè®¡åˆ’è§£è¯»](#412-æ‰§è¡Œè®¡åˆ’è§£è¯»)
    - [4.1.3 ä¼˜åŒ–å»ºè®®](#413-ä¼˜åŒ–å»ºè®®)
    - [4.2 pg\_stat\_statements - PostgreSQLæŸ¥è¯¢ç»Ÿè®¡](#42-pg_stat_statements---postgresqlæŸ¥è¯¢ç»Ÿè®¡)
    - [4.2.1 pg\_stat\_statementsç®€ä»‹](#421-pg_stat_statementsç®€ä»‹)
    - [4.2.2 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šæŸ¥è¯¢æ€§èƒ½åˆ†æ](#422-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹æŸ¥è¯¢æ€§èƒ½åˆ†æ)
    - [4.3 Performance Schema - MySQLæ€§èƒ½åˆ†æ](#43-performance-schema---mysqlæ€§èƒ½åˆ†æ)
    - [4.3.1 Performance Schemaç®€ä»‹](#431-performance-schemaç®€ä»‹)
    - [4.3.2 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šæŸ¥è¯¢æ€§èƒ½ç›‘æ§](#432-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹æŸ¥è¯¢æ€§èƒ½ç›‘æ§)
  - [äº”ã€IDEé›†æˆå·¥å…·](#äº”ideé›†æˆå·¥å…·)
    - [5.1 VS Code SQLæ‰©å±•](#51-vs-code-sqlæ‰©å±•)
    - [5.1.1 VS Code SQLæ‰©å±•æ¨è](#511-vs-code-sqlæ‰©å±•æ¨è)
    - [5.1.2 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šåœ¨VS Codeä¸­å¼€å‘SQL](#512-ä½¿ç”¨åœºæ™¯ç¤ºä¾‹åœ¨vs-codeä¸­å¼€å‘sql)
  - [å…­ã€å·¥å…·é€‰æ‹©å»ºè®®](#å…­å·¥å…·é€‰æ‹©å»ºè®®)
    - [6.1 å·¥å…·é€‰æ‹©å†³ç­–çŸ©é˜µ](#61-å·¥å…·é€‰æ‹©å†³ç­–çŸ©é˜µ)
    - [6.2 å·¥å…·ç»„åˆå»ºè®®](#62-å·¥å…·ç»„åˆå»ºè®®)
  - [äº”ã€ç›¸å…³èµ„æº](#äº”ç›¸å…³èµ„æº)
    - [ç›¸å…³æ–‡æ¡£](#ç›¸å…³æ–‡æ¡£)

---

## ä¸€ã€æ¦‚è¿°

æœ¬æ–‡æ¡£ä»‹ç»å¸¸ç”¨çš„SQLå·¥å…·ï¼Œå¸®åŠ©æé«˜SQLå¼€å‘æ•ˆç‡ã€‚

### 1.1 SQLå·¥å…·åˆ†ç±»æ€ç»´å¯¼å›¾

```mermaid
mindmap
  root((SQLå·¥å…·))
    SQLç¼–è¾‘å™¨
      æ¡Œé¢å·¥å…·
        DBeaver
        DataGrip
        TablePlus
      Webå·¥å…·
        phpMyAdmin
        Adminer
        pgAdmin
    æ•°æ®åº“ç®¡ç†
      PostgreSQL
        pgAdmin
        DBeaver
      MySQL
        MySQL Workbench
        phpMyAdmin
      SQLite
        DB Browser
        SQLiteStudio
    æŸ¥è¯¢åˆ†æ
      æ‰§è¡Œè®¡åˆ’
        EXPLAIN
        EXPLAIN ANALYZE
      æ€§èƒ½ç›‘æ§
        pg_stat_statements
        Performance Schema
      æŸ¥è¯¢ä¼˜åŒ–
        Query Profiler
        Slow Query Log
    IDEé›†æˆ
      VS Code
        SQLæ‰©å±•
        æ•°æ®åº“è¿æ¥
      IntelliJ IDEA
        DataGripæ’ä»¶
        æ•°æ®åº“å·¥å…·
```

### 1.2 SQLå·¥å…·é€‰æ‹©å†³ç­–æ ‘

```mermaid
flowchart TD
    A[é€‰æ‹©SQLå·¥å…·] --> B{ä½¿ç”¨åœºæ™¯}
    B -->|å¼€å‘è°ƒè¯•| C{æ•°æ®åº“ç±»å‹}
    B -->|ç®¡ç†ç»´æŠ¤| D[ç®¡ç†å·¥å…·]
    B -->|æ€§èƒ½åˆ†æ| E[åˆ†æå·¥å…·]

    C -->|PostgreSQL| F[pgAdmin/DBeaver]
    C -->|MySQL| G[MySQL Workbench]
    C -->|SQLite| H[DB Browser]
    C -->|å¤šæ•°æ®åº“| I[DBeaver/DataGrip]

    D --> J{Web/æ¡Œé¢}
    J -->|Web| K[phpMyAdmin/Adminer]
    J -->|æ¡Œé¢| L[DBeaver/TablePlus]

    E --> M{åˆ†æç±»å‹}
    M -->|æ‰§è¡Œè®¡åˆ’| N[EXPLAINå·¥å…·]
    M -->|æ€§èƒ½ç›‘æ§| O[ç›‘æ§å·¥å…·]
```

### 1.3 SQLå·¥å…·å¯¹æ¯”çŸ©é˜µ

| å·¥å…· | ç±»å‹ | æ•°æ®åº“æ”¯æŒ | åŠŸèƒ½ | ä»·æ ¼ | æ¨èåº¦ |
|------|------|-----------|------|------|--------|
| **DBeaver** | é€šç”¨ | å¤šæ•°æ®åº“ | â­â­â­â­â­ | å…è´¹/ä»˜è´¹ | â­â­â­â­â­ |
| **DataGrip** | IDE | å¤šæ•°æ®åº“ | â­â­â­â­â­ | ä»˜è´¹ | â­â­â­â­â­ |
| **pgAdmin** | ä¸“ç”¨ | PostgreSQL | â­â­â­â­ | å…è´¹ | â­â­â­â­ |
| **MySQL Workbench** | ä¸“ç”¨ | MySQL | â­â­â­â­ | å…è´¹ | â­â­â­â­ |
| **TablePlus** | é€šç”¨ | å¤šæ•°æ®åº“ | â­â­â­â­ | ä»˜è´¹ | â­â­â­â­ |

---

## äºŒã€SQLç¼–è¾‘å™¨

### 2.1 DBeaver - è·¨å¹³å°æ•°æ®åº“å·¥å…·

**DBeaverç®€ä»‹**ï¼š

DBeaveræ˜¯å…è´¹å¼€æºçš„é€šç”¨æ•°æ®åº“å·¥å…·ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ç³»ç»Ÿã€‚

**ä¸»è¦ç‰¹æ€§**ï¼š

- âœ… æ”¯æŒ50+ç§æ•°æ®åº“ï¼ˆPostgreSQLã€MySQLã€SQLiteã€Oracleã€SQL Serverç­‰ï¼‰
- âœ… è·¨å¹³å°ï¼ˆWindowsã€macOSã€Linuxï¼‰
- âœ… å¼ºå¤§çš„SQLç¼–è¾‘å™¨ï¼ˆè¯­æ³•é«˜äº®ã€è‡ªåŠ¨å®Œæˆã€ä»£ç æ ¼å¼åŒ–ï¼‰
- âœ… æ•°æ®æµè§ˆå’Œç¼–è¾‘
- âœ… æ‰§è¡Œè®¡åˆ’å¯è§†åŒ–
- âœ… ERå›¾ç”Ÿæˆ
- âœ… æ•°æ®å¯¼å…¥å¯¼å‡º

**å®‰è£…æ­¥éª¤**ï¼š

```bash
# Windows: ä¸‹è½½å®‰è£…åŒ…
# https://dbeaver.io/download/

# macOS: ä½¿ç”¨Homebrew
brew install --cask dbeaver-community

# Linux: ä½¿ç”¨åŒ…ç®¡ç†å™¨
sudo apt-get install dbeaver-ce
```

### 2.1.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šå­¦ç”Ÿç®¡ç†ç³»ç»ŸæŸ¥è¯¢

**åœºæ™¯**ï¼šä½¿ç”¨DBeaverè¿æ¥PostgreSQLæ•°æ®åº“ï¼ŒæŸ¥è¯¢å­¦ç”Ÿé€‰è¯¾ä¿¡æ¯ã€‚

**æ­¥éª¤**ï¼š

1. **åˆ›å»ºæ•°æ®åº“è¿æ¥**ï¼š
   - æ‰“å¼€DBeaver
   - æ–°å»ºæ•°æ®åº“è¿æ¥ â†’ é€‰æ‹©PostgreSQL
   - é…ç½®è¿æ¥ä¿¡æ¯ï¼š
     - Host: localhost
     - Port: 5432
     - Database: student_db
     - Username: postgres
     - Password: ***

2. **æ‰§è¡ŒSQLæŸ¥è¯¢**ï¼š

    ```sql
    -- æŸ¥è¯¢æ¯é—¨è¯¾ç¨‹çš„å¹³å‡åˆ†
    SELECT
        c.course_name,
        COUNT(e.student_id) as student_count,
        AVG(e.score) as avg_score,
        MAX(e.score) as max_score,
        MIN(e.score) as min_score
    FROM Course c
    LEFT JOIN Enrollment e ON c.course_id = e.course_id
    GROUP BY c.course_id, c.course_name
    ORDER BY avg_score DESC;
    ```

3. **æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’**ï¼š
   - åœ¨SQLç¼–è¾‘å™¨ä¸­å³é”® â†’ "Explain Plan"
   - æŸ¥çœ‹æŸ¥è¯¢ä¼˜åŒ–å»ºè®®

4. **å¯¼å‡ºæŸ¥è¯¢ç»“æœ**ï¼š
   - å³é”®æŸ¥è¯¢ç»“æœ â†’ "Export Data"
   - é€‰æ‹©å¯¼å‡ºæ ¼å¼ï¼ˆCSVã€Excelã€JSONç­‰ï¼‰

**é…ç½®ä¼˜åŒ–å»ºè®®**ï¼š

```properties
# DBeaveré…ç½®ä¼˜åŒ–
# æ–‡ä»¶ä½ç½®: ~/.dbeaver/General/.dbeaver/data-sources.json

{
  "connections": [{
    "configuration": {
      "queryTimeout": 30,
      "maxResultSetSize": 10000,
      "autoCommit": false,
      "readOnly": false
    }
  }]
}
```

### 2.2 DataGrip - JetBrainsæ•°æ®åº“IDE

**DataGripç®€ä»‹**ï¼š

DataGripæ˜¯JetBrainsæ¨å‡ºçš„ä¸“ä¸šæ•°æ®åº“IDEï¼Œæä¾›å¼ºå¤§çš„SQLå¼€å‘åŠŸèƒ½ã€‚

**ä¸»è¦ç‰¹æ€§**ï¼š

- âœ… æ™ºèƒ½SQLç¼–è¾‘å™¨ï¼ˆä»£ç è¡¥å…¨ã€é‡æ„ã€å¯¼èˆªï¼‰
- âœ… å¤šæ•°æ®åº“æ”¯æŒ
- âœ… å¼ºå¤§çš„æŸ¥è¯¢åˆ†æå·¥å…·
- âœ… ç‰ˆæœ¬æ§åˆ¶é›†æˆï¼ˆGitï¼‰
- âœ… æ•°æ®åº“é‡æ„å·¥å…·
- âœ… æ•°æ®å¯è§†åŒ–

**å®‰è£…æ­¥éª¤**ï¼š

```bash
# ä¸‹è½½å®‰è£…åŒ…
# https://www.jetbrains.com/datagrip/download/

# æˆ–ä½¿ç”¨JetBrains Toolbox
# https://www.jetbrains.com/toolbox-app/
```

### 2.2.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šå¤æ‚æŸ¥è¯¢å¼€å‘

**åœºæ™¯**ï¼šä½¿ç”¨DataGripå¼€å‘å¤æ‚çš„å¤šè¡¨è¿æ¥æŸ¥è¯¢ã€‚

**æ­¥éª¤**ï¼š

1. **åˆ›å»ºæ•°æ®æº**ï¼š
   - File â†’ New â†’ Data Source â†’ PostgreSQL
   - é…ç½®è¿æ¥ä¿¡æ¯

2. **ä½¿ç”¨æ™ºèƒ½ä»£ç è¡¥å…¨**ï¼š

    ```sql
    -- DataGripä¼šè‡ªåŠ¨æç¤ºè¡¨åã€åˆ—åã€å‡½æ•°å
    SELECT
        s.student_id,
        s.name,
        -- è¾“å…¥"s."ä¼šè‡ªåŠ¨æç¤ºStudentè¡¨çš„åˆ—
        -- è¾“å…¥"AVG("ä¼šè‡ªåŠ¨æç¤ºèšåˆå‡½æ•°
        AVG(e.score) as avg_score
    FROM Student s
    JOIN Enrollment e ON s.student_id = e.student_id
    GROUP BY s.student_id, s.name
    HAVING AVG(e.score) > 80;
    ```

3. **ä½¿ç”¨æŸ¥è¯¢åˆ†æ**ï¼š
   - å³é”®SQL â†’ "Explain Plan"
   - æŸ¥çœ‹è¯¦ç»†çš„æ‰§è¡Œè®¡åˆ’æ ‘
   - åˆ†ææŸ¥è¯¢æ€§èƒ½ç“¶é¢ˆ

4. **ä½¿ç”¨é‡æ„åŠŸèƒ½**ï¼š
   - é‡å‘½åè¡¨/åˆ—ï¼šShift+F6
   - æå–å­æŸ¥è¯¢ï¼šCtrl+Alt+M
   - å†…è”å˜é‡ï¼šCtrl+Alt+N

**å¿«æ·é”®å‚è€ƒ**ï¼š

| åŠŸèƒ½ | Windows/Linux | macOS |
|------|--------------|-------|
| æ‰§è¡ŒæŸ¥è¯¢ | Ctrl+Enter | Cmd+Enter |
| æ ¼å¼åŒ–SQL | Ctrl+Alt+L | Cmd+Option+L |
| æŸ¥æ‰¾ç”¨æ³• | Alt+F7 | Option+F7 |
| å¿«é€Ÿæ–‡æ¡£ | Ctrl+Q | F1 |
| ä»£ç è¡¥å…¨ | Ctrl+Space | Ctrl+Space |

### 2.3 pgAdmin - PostgreSQLç®¡ç†å·¥å…·

**pgAdminç®€ä»‹**ï¼š

pgAdminæ˜¯PostgreSQLçš„å®˜æ–¹ç®¡ç†å·¥å…·ï¼Œæä¾›å®Œæ•´çš„æ•°æ®åº“ç®¡ç†åŠŸèƒ½ã€‚

**ä¸»è¦ç‰¹æ€§**ï¼š

- âœ… PostgreSQLä¸“ç”¨å·¥å…·
- âœ… å›¾å½¢åŒ–æ•°æ®åº“ç®¡ç†
- âœ… æŸ¥è¯¢å·¥å…·
- âœ… å¤‡ä»½æ¢å¤å·¥å…·
- âœ… æ€§èƒ½ç›‘æ§

**å®‰è£…æ­¥éª¤**ï¼š

```bash
# Windows: ä¸‹è½½å®‰è£…åŒ…
# https://www.pgadmin.org/download/

# macOS: ä½¿ç”¨Homebrew
brew install --cask pgadmin4

# Linux: ä½¿ç”¨åŒ…ç®¡ç†å™¨
sudo apt-get install pgadmin4
```

### 2.3.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šæ•°æ®åº“ç®¡ç†

**åœºæ™¯**ï¼šä½¿ç”¨pgAdminç®¡ç†PostgreSQLæ•°æ®åº“ï¼Œåˆ›å»ºè¡¨ã€ç´¢å¼•ï¼Œæ‰§è¡ŒæŸ¥è¯¢ã€‚

**æ­¥éª¤**ï¼š

1. **åˆ›å»ºè¡¨**ï¼š
   - å³é”®æ•°æ®åº“ â†’ Create â†’ Table
   - ä½¿ç”¨å›¾å½¢ç•Œé¢åˆ›å»ºè¡¨ç»“æ„
   - æˆ–ä½¿ç”¨SQLç¼–è¾‘å™¨ï¼š

    ```sql
    CREATE TABLE Student (
        student_id SERIAL PRIMARY KEY,
        name VARCHAR(100) NOT NULL,
        age INTEGER CHECK (age > 0),
        major VARCHAR(50),
        email VARCHAR(100) UNIQUE,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    );

    -- åˆ›å»ºç´¢å¼•
    CREATE INDEX idx_student_major ON Student(major);
    CREATE INDEX idx_student_email ON Student(email);
    ```

2. **æ‰§è¡ŒæŸ¥è¯¢**ï¼š
   - Tools â†’ Query Tool
   - è¾“å…¥SQLæŸ¥è¯¢
   - æ‰§è¡Œå¹¶æŸ¥çœ‹ç»“æœ

3. **æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’**ï¼š
   - Query Tool â†’ Explain â†’ Explain Analyze
   - æŸ¥çœ‹è¯¦ç»†çš„æ‰§è¡Œè®¡åˆ’

---

## ä¸‰ã€æ•°æ®åº“ç®¡ç†å·¥å…·

### 3.1 phpMyAdmin - Web-based MySQLç®¡ç†

**phpMyAdminç®€ä»‹**ï¼š

phpMyAdminæ˜¯åŸºäºWebçš„MySQLç®¡ç†å·¥å…·ï¼Œé€‚åˆè¿œç¨‹ç®¡ç†MySQLæ•°æ®åº“ã€‚

**ä¸»è¦ç‰¹æ€§**ï¼š

- âœ… Webç•Œé¢ï¼Œæ— éœ€å®‰è£…å®¢æˆ·ç«¯
- âœ… å®Œæ•´çš„æ•°æ®åº“ç®¡ç†åŠŸèƒ½
- âœ… SQLæŸ¥è¯¢æ‰§è¡Œ
- âœ… æ•°æ®å¯¼å…¥å¯¼å‡º
- âœ… ç”¨æˆ·æƒé™ç®¡ç†

**å®‰è£…æ­¥éª¤**ï¼š

```bash
# ä½¿ç”¨Dockerå¿«é€Ÿéƒ¨ç½²
docker run --name phpmyadmin \
  -e PMA_HOST=mysql_host \
  -e PMA_PORT=3306 \
  -p 8080:80 \
  -d phpmyadmin/phpmyadmin

# æˆ–ä½¿ç”¨XAMPP/WAMPç­‰é›†æˆç¯å¢ƒ
```

### 3.1.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šWebç¯å¢ƒæ•°æ®åº“ç®¡ç†

**åœºæ™¯**ï¼šåœ¨WebæœåŠ¡å™¨ä¸Šç®¡ç†MySQLæ•°æ®åº“ã€‚

**é…ç½®ç¤ºä¾‹**ï¼š

```php
// config.inc.php
$cfg['Servers'][1]['host'] = 'localhost';
$cfg['Servers'][1]['port'] = '3306';
$cfg['Servers'][1]['user'] = 'root';
$cfg['Servers'][1]['password'] = '';
$cfg['Servers'][1]['auth_type'] = 'cookie';
```

### 3.2 TablePlus - ç°ä»£æ•°æ®åº“ç®¡ç†å·¥å…·

**TablePlusç®€ä»‹**ï¼š

TablePlusæ˜¯ç°ä»£åŒ–çš„æ•°æ®åº“ç®¡ç†å·¥å…·ï¼Œç•Œé¢ç¾è§‚ï¼ŒåŠŸèƒ½å¼ºå¤§ã€‚

**ä¸»è¦ç‰¹æ€§**ï¼š

- âœ… æ”¯æŒå¤šç§æ•°æ®åº“
- âœ… ç¾è§‚çš„ç”¨æˆ·ç•Œé¢
- âœ… å¿«é€ŸæŸ¥è¯¢æ‰§è¡Œ
- âœ… æ•°æ®ç¼–è¾‘
- âœ… å¤šæ ‡ç­¾é¡µæ”¯æŒ

### 3.2.1 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šå¿«é€Ÿæ•°æ®æµè§ˆå’Œç¼–è¾‘

**åœºæ™¯**ï¼šå¿«é€Ÿæµè§ˆå’Œç¼–è¾‘æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š

- åŒå‡»å•å…ƒæ ¼ç›´æ¥ç¼–è¾‘
- æ”¯æŒå¤šè¡Œç¼–è¾‘
- å®æ—¶ä¿å­˜æ›´æ”¹
- æ”¯æŒäº‹åŠ¡å›æ»š

---

## å››ã€æŸ¥è¯¢åˆ†æå·¥å…·

### 4.1 EXPLAIN - æŸ¥è¯¢è®¡åˆ’åˆ†æ

**EXPLAINç®€ä»‹**ï¼š

EXPLAINæ˜¯SQLæ ‡å‡†æä¾›çš„æŸ¥è¯¢è®¡åˆ’åˆ†æå·¥å…·ï¼Œå¸®åŠ©ç†è§£æŸ¥è¯¢æ‰§è¡Œè¿‡ç¨‹ã€‚

### 4.1.1 PostgreSQL EXPLAINç¤ºä¾‹

```sql
-- åŸºæœ¬EXPLAIN
EXPLAIN SELECT * FROM Student WHERE age > 20;

-- EXPLAIN ANALYZEï¼ˆå®é™…æ‰§è¡ŒæŸ¥è¯¢ï¼‰
EXPLAIN ANALYZE
SELECT
    s.name,
    c.course_name,
    e.score
FROM Student s
JOIN Enrollment e ON s.student_id = e.student_id
JOIN Course c ON e.course_id = c.course_id
WHERE s.major = 'Computer Science'
ORDER BY e.score DESC;
```

### 4.1.2 æ‰§è¡Œè®¡åˆ’è§£è¯»

```sql
-- æ‰§è¡Œè®¡åˆ’è¾“å‡ºç¤ºä¾‹
QUERY PLAN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Sort  (cost=1234.56..1235.67 rows=100 width=64)
  Sort Key: e.score DESC
  ->  Hash Join  (cost=567.89..890.12 rows=100 width=64)
        Hash Cond: (e.student_id = s.student_id)
        ->  Seq Scan on enrollment e  (cost=0.00..234.56 rows=1000)
        ->  Hash  (cost=345.67..345.67 rows=50 width=32)
              ->  Seq Scan on student s  (cost=0.00..345.67 rows=50)
                    Filter: (major = 'Computer Science'::text)
```

### 4.1.3 ä¼˜åŒ–å»ºè®®

- å¦‚æœçœ‹åˆ°"Seq Scan"ï¼ˆé¡ºåºæ‰«æï¼‰ï¼Œè€ƒè™‘æ·»åŠ ç´¢å¼•
- å¦‚æœçœ‹åˆ°"Hash Join"ï¼Œç¡®ä¿è¿æ¥åˆ—æœ‰ç´¢å¼•
- å…³æ³¨"cost"å€¼ï¼Œè¾ƒé«˜çš„costå¯èƒ½éœ€è¦ä¼˜åŒ–

### 4.2 pg_stat_statements - PostgreSQLæŸ¥è¯¢ç»Ÿè®¡

### 4.2.1 pg_stat_statementsç®€ä»‹

pg_stat_statementsæ˜¯PostgreSQLçš„æŸ¥è¯¢ç»Ÿè®¡æ‰©å±•ï¼Œè®°å½•æ‰€æœ‰SQLæŸ¥è¯¢çš„æ‰§è¡Œç»Ÿè®¡ä¿¡æ¯ã€‚

**å®‰è£…å’Œé…ç½®**ï¼š

```sql
-- 1. å®‰è£…æ‰©å±•
CREATE EXTENSION IF NOT EXISTS pg_stat_statements;

-- 2. é…ç½®postgresql.conf
-- shared_preload_libraries = 'pg_stat_statements'
-- pg_stat_statements.track = all
-- pg_stat_statements.max = 10000

-- 3. é‡å¯PostgreSQLæœåŠ¡
```

### 4.2.2 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šæŸ¥è¯¢æ€§èƒ½åˆ†æ

**åœºæ™¯**ï¼šåˆ†ææ•°æ®åº“ä¸­æ‰§è¡Œæœ€é¢‘ç¹ã€æœ€è€—æ—¶çš„æŸ¥è¯¢ã€‚

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```sql
-- æŸ¥çœ‹æ‰§è¡Œæ—¶é—´æœ€é•¿çš„æŸ¥è¯¢
SELECT
    query,
    calls,
    total_exec_time,
    mean_exec_time,
    max_exec_time,
    stddev_exec_time
FROM pg_stat_statements
ORDER BY total_exec_time DESC
LIMIT 10;

-- æŸ¥çœ‹æ‰§è¡Œæ¬¡æ•°æœ€å¤šçš„æŸ¥è¯¢
SELECT
    query,
    calls,
    total_exec_time,
    mean_exec_time
FROM pg_stat_statements
ORDER BY calls DESC
LIMIT 10;

-- æŸ¥çœ‹ç‰¹å®šè¡¨çš„æŸ¥è¯¢ç»Ÿè®¡
SELECT
    query,
    calls,
    total_exec_time
FROM pg_stat_statements
WHERE query LIKE '%Student%'
ORDER BY total_exec_time DESC;
```

### 4.3 Performance Schema - MySQLæ€§èƒ½åˆ†æ

### 4.3.1 Performance Schemaç®€ä»‹

Performance Schemaæ˜¯MySQLçš„æ€§èƒ½ç›‘æ§ç³»ç»Ÿï¼Œæä¾›è¯¦ç»†çš„æ€§èƒ½æ•°æ®ã€‚

**å¯ç”¨Performance Schema**ï¼š

```sql
-- æ£€æŸ¥æ˜¯å¦å¯ç”¨
SHOW VARIABLES LIKE 'performance_schema';

-- å¦‚æœæœªå¯ç”¨ï¼Œåœ¨my.cnfä¸­é…ç½®
-- [mysqld]
-- performance_schema=ON
```

### 4.3.2 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šæŸ¥è¯¢æ€§èƒ½ç›‘æ§

**åœºæ™¯**ï¼šç›‘æ§MySQLæ•°æ®åº“ä¸­çš„æ…¢æŸ¥è¯¢å’Œæ€§èƒ½ç“¶é¢ˆã€‚

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```sql
-- æŸ¥çœ‹æ‰§è¡Œæ—¶é—´æœ€é•¿çš„æŸ¥è¯¢
SELECT
    sql_text,
    count_star,
    sum_timer_wait/1000000000000 as total_time_sec,
    avg_timer_wait/1000000000000 as avg_time_sec,
    max_timer_wait/1000000000000 as max_time_sec
FROM performance_schema.events_statements_summary_by_digest
ORDER BY sum_timer_wait DESC
LIMIT 10;

-- æŸ¥çœ‹è¡¨è®¿é—®ç»Ÿè®¡
SELECT
    object_schema,
    object_name,
    count_star,
    sum_timer_wait/1000000000000 as total_time_sec
FROM performance_schema.table_io_waits_summary_by_table
ORDER BY sum_timer_wait DESC
LIMIT 10;
```

---

## äº”ã€IDEé›†æˆå·¥å…·

### 5.1 VS Code SQLæ‰©å±•

### 5.1.1 VS Code SQLæ‰©å±•æ¨è

1. **SQLTools** - é€šç”¨æ•°æ®åº“å·¥å…·
2. **SQLTools PostgreSQL/Cockroach Driver** - PostgreSQLé©±åŠ¨
3. **SQLTools MySQL/MariaDB** - MySQLé©±åŠ¨

**å®‰è£…æ­¥éª¤**ï¼š

```bash
# åœ¨VS Codeä¸­å®‰è£…æ‰©å±•
# 1. æ‰“å¼€æ‰©å±•é¢æ¿ (Ctrl+Shift+X)
# 2. æœç´¢ "SQLTools"
# 3. å®‰è£… SQLTools å’Œå¯¹åº”çš„æ•°æ®åº“é©±åŠ¨
```

### 5.1.2 ä½¿ç”¨åœºæ™¯ç¤ºä¾‹ï¼šåœ¨VS Codeä¸­å¼€å‘SQL

**åœºæ™¯**ï¼šåœ¨VS Codeä¸­ç¼–å†™å’Œæ‰§è¡ŒSQLæŸ¥è¯¢ã€‚

**é…ç½®ç¤ºä¾‹**ï¼š

```json
// settings.json
{
  "sqltools.connections": [
    {
      "name": "PostgreSQL Local",
      "driver": "PostgreSQL",
      "server": "localhost",
      "port": 5432,
      "database": "student_db",
      "username": "postgres",
      "password": "***"
    }
  ]
}
```

**åŠŸèƒ½ç‰¹ç‚¹**ï¼š

- SQLè¯­æ³•é«˜äº®
- ä»£ç è¡¥å…¨
- æŸ¥è¯¢æ‰§è¡Œ
- ç»“æœæŸ¥çœ‹
- è¿æ¥ç®¡ç†

---

## å…­ã€å·¥å…·é€‰æ‹©å»ºè®®

### 6.1 å·¥å…·é€‰æ‹©å†³ç­–çŸ©é˜µ

| ä½¿ç”¨åœºæ™¯ | æ¨èå·¥å…· | ç†ç”± |
|---------|---------|------|
| **å¤šæ•°æ®åº“å¼€å‘** | DBeaver / DataGrip | æ”¯æŒå¤šç§æ•°æ®åº“ï¼ŒåŠŸèƒ½å…¨é¢ |
| **PostgreSQLä¸“ç”¨** | pgAdmin | å®˜æ–¹å·¥å…·ï¼ŒåŠŸèƒ½å®Œæ•´ |
| **MySQLä¸“ç”¨** | MySQL Workbench | å®˜æ–¹å·¥å…·ï¼ŒåŠŸèƒ½å®Œæ•´ |
| **Webç¯å¢ƒç®¡ç†** | phpMyAdmin / Adminer | åŸºäºWebï¼Œæ— éœ€å®‰è£…å®¢æˆ·ç«¯ |
| **å¿«é€Ÿæ•°æ®æµè§ˆ** | TablePlus | ç•Œé¢ç¾è§‚ï¼Œæ“ä½œä¾¿æ· |
| **IDEé›†æˆå¼€å‘** | VS Code SQLTools / DataGrip | ä¸å¼€å‘ç¯å¢ƒé›†æˆ |
| **æ€§èƒ½åˆ†æ** | EXPLAIN + pg_stat_statements / Performance Schema | ä¸“ä¸šçš„æ€§èƒ½åˆ†æå·¥å…· |

### 6.2 å·¥å…·ç»„åˆå»ºè®®

**å¼€å‘ç¯å¢ƒç»„åˆ**ï¼š

- **ä¸»è¦å·¥å…·**ï¼šDataGripï¼ˆä¸“ä¸šSQLå¼€å‘ï¼‰
- **è¾…åŠ©å·¥å…·**ï¼šDBeaverï¼ˆå¤šæ•°æ®åº“æ”¯æŒï¼‰
- **æ€§èƒ½åˆ†æ**ï¼šEXPLAIN + æ•°æ®åº“ç‰¹å®šå·¥å…·

**ç”Ÿäº§ç¯å¢ƒç»„åˆ**ï¼š

- **ç®¡ç†å·¥å…·**ï¼špgAdmin / MySQL Workbenchï¼ˆæ•°æ®åº“ç®¡ç†ï¼‰
- **ç›‘æ§å·¥å…·**ï¼špg_stat_statements / Performance Schemaï¼ˆæ€§èƒ½ç›‘æ§ï¼‰
- **å¤‡ä»½å·¥å…·**ï¼šæ•°æ®åº“è‡ªå¸¦å¤‡ä»½å·¥å…·

---

## äº”ã€ç›¸å…³èµ„æº

### ç›¸å…³æ–‡æ¡£

- [SQLå­¦ä¹ èµ„æº](./08.02-SQLå­¦ä¹ èµ„æº.md) - å­¦ä¹ èµ„æº

---

**ç»´æŠ¤è€…**: SQL Standards Team
**æœ€åæ›´æ–°**: 2025-01-16

# éƒ¨ç½²æµç¨‹å®è·µæ¡ˆä¾‹

## ğŸ“‘ ç›®å½•

- [éƒ¨ç½²æµç¨‹å®è·µæ¡ˆä¾‹](#éƒ¨ç½²æµç¨‹å®è·µæ¡ˆä¾‹)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
  - [2. å®¹å™¨åŒ–éƒ¨ç½²å®è·µ](#2-å®¹å™¨åŒ–éƒ¨ç½²å®è·µ)
    - [2.1. Dockerå®¹å™¨åŒ–éƒ¨ç½²](#21-dockerå®¹å™¨åŒ–éƒ¨ç½²)
  - [3. Kuberneteséƒ¨ç½²å®è·µ](#3-kuberneteséƒ¨ç½²å®è·µ)
  - [4. è‡ªåŠ¨åŒ–éƒ¨ç½²å®è·µ](#4-è‡ªåŠ¨åŒ–éƒ¨ç½²å®è·µ)
    - [4.1. CI/CDæµæ°´çº¿éƒ¨ç½²](#41-cicdæµæ°´çº¿éƒ¨ç½²)
  - [5. è“ç»¿éƒ¨ç½²å®è·µ](#5-è“ç»¿éƒ¨ç½²å®è·µ)
  - [6. ç›‘æ§ä¸å¥åº·æ£€æŸ¥](#6-ç›‘æ§ä¸å¥åº·æ£€æŸ¥)
    - [6.1. åº”ç”¨å¥åº·æ£€æŸ¥](#61-åº”ç”¨å¥åº·æ£€æŸ¥)
  - [7. æ€»ç»“](#7-æ€»ç»“)

---


## 1. æ¦‚è¿°

æœ¬æ–‡æ¡£æä¾›éƒ¨ç½²æµç¨‹çš„å®è·µåº”ç”¨æ¡ˆä¾‹ï¼Œæ¶µç›–å®¹å™¨åŒ–éƒ¨ç½²ã€è‡ªåŠ¨åŒ–éƒ¨ç½²ã€è“ç»¿éƒ¨ç½²ã€æ»šåŠ¨æ›´æ–°ç­‰å®é™…åœºæ™¯ã€‚

## 2. å®¹å™¨åŒ–éƒ¨ç½²å®è·µ

### 2.1. Dockerå®¹å™¨åŒ–éƒ¨ç½²

```python
import docker
import yaml
import os
from typing import Dict, List, Optional
import subprocess

class DockerDeploymentManager:
    def __init__(self):
        self.client = docker.from_env()
        self.containers = {}
        self.networks = {}

    def build_image(self, dockerfile_path: str, image_name: str, tag: str = "latest") -> bool:
        """æ„å»ºDockeré•œåƒ"""
        try:
            image, logs = self.client.images.build(
                path=dockerfile_path,
                tag=f"{image_name}:{tag}",
                rm=True
            )
            print(f"é•œåƒæ„å»ºæˆåŠŸ: {image_name}:{tag}")
            return True
        except Exception as e:
            print(f"é•œåƒæ„å»ºå¤±è´¥: {e}")
            return False

    def create_network(self, network_name: str, driver: str = "bridge") -> bool:
        """åˆ›å»ºDockerç½‘ç»œ"""
        try:
            network = self.client.networks.create(
                name=network_name,
                driver=driver
            )
            self.networks[network_name] = network
            print(f"ç½‘ç»œåˆ›å»ºæˆåŠŸ: {network_name}")
            return True
        except Exception as e:
            print(f"ç½‘ç»œåˆ›å»ºå¤±è´¥: {e}")
            return False

    def deploy_container(self, image_name: str, container_name: str,
                        ports: Dict[str, str] = None,
                        environment: Dict[str, str] = None,
                        volumes: Dict[str, str] = None,
                        network: str = None) -> bool:
        """éƒ¨ç½²å®¹å™¨"""
        try:
            container = self.client.containers.run(
                image=image_name,
                name=container_name,
                ports=ports or {},
                environment=environment or {},
                volumes=volumes or {},
                network=network,
                detach=True,
                restart_policy={"Name": "unless-stopped"}
            )
            self.containers[container_name] = container
            print(f"å®¹å™¨éƒ¨ç½²æˆåŠŸ: {container_name}")
            return True
        except Exception as e:
            print(f"å®¹å™¨éƒ¨ç½²å¤±è´¥: {e}")
            return False

    def stop_container(self, container_name: str) -> bool:
        """åœæ­¢å®¹å™¨"""
        try:
            if container_name in self.containers:
                container = self.containers[container_name]
                container.stop()
                container.remove()
                del self.containers[container_name]
                print(f"å®¹å™¨åœæ­¢æˆåŠŸ: {container_name}")
                return True
            return False
        except Exception as e:
            print(f"å®¹å™¨åœæ­¢å¤±è´¥: {e}")
            return False

    def get_container_status(self, container_name: str) -> Dict:
        """è·å–å®¹å™¨çŠ¶æ€"""
        try:
            if container_name in self.containers:
                container = self.containers[container_name]
                container.reload()
                return {
                    'name': container_name,
                    'status': container.status,
                    'ports': container.ports,
                    'ip': container.attrs['NetworkSettings']['IPAddress']
                }
            return {}
        except Exception as e:
            print(f"è·å–å®¹å™¨çŠ¶æ€å¤±è´¥: {e}")
            return {}

    def scale_service(self, service_name: str, replicas: int) -> bool:
        """æ‰©å±•æœåŠ¡"""
        try:
# è¿™é‡Œå¯ä»¥å®ç°æœåŠ¡æ‰©å±•é€»è¾‘
            print(f"æœåŠ¡ {service_name} æ‰©å±•åˆ° {replicas} ä¸ªå®ä¾‹")
            return True
        except Exception as e:
            print(f"æœåŠ¡æ‰©å±•å¤±è´¥: {e}")
            return False

# ä½¿ç”¨ç¤ºä¾‹
def demonstrate_docker_deployment():
    """æ¼”ç¤ºDockeréƒ¨ç½²"""
    deployment_manager = DockerDeploymentManager()

# åˆ›å»ºç½‘ç»œ
    deployment_manager.create_network("app-network")

# æ„å»ºé•œåƒï¼ˆéœ€è¦å®é™…çš„Dockerfileï¼‰
# deployment_manager.build_image("./app", "myapp", "v1.0")

# éƒ¨ç½²åº”ç”¨å®¹å™¨
    deployment_manager.deploy_container(
        image_name="nginx:latest",
        container_name="web-server",
        ports={"80/tcp": "8080"},
        network="app-network"
    )

# éƒ¨ç½²æ•°æ®åº“å®¹å™¨
    deployment_manager.deploy_container(
        image_name="postgres:13",
        container_name="database",
        environment={
            "POSTGRES_DB": "myapp",
            "POSTGRES_USER": "user",
            "POSTGRES_PASSWORD": "password"
        },
        volumes={"/var/lib/postgresql/data": {"bind": "/var/lib/postgresql/data", "mode": "rw"}},
        network="app-network"
    )

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
    web_status = deployment_manager.get_container_status("web-server")
    db_status = deployment_manager.get_container_status("database")
    print("WebæœåŠ¡å™¨çŠ¶æ€:", web_status)
    print("æ•°æ®åº“çŠ¶æ€:", db_status)

# è¿è¡Œç¤ºä¾‹
demonstrate_docker_deployment()
```

## 3. Kuberneteséƒ¨ç½²å®è·µ

```python
import yaml
import subprocess
from typing import Dict, List, Optional

class KubernetesDeploymentManager:
    def __init__(self, namespace: str = "default"):
        self.namespace = namespace
        self.deployments = {}

    def create_namespace(self, namespace: str) -> bool:
        """åˆ›å»ºå‘½åç©ºé—´"""
        try:
            cmd = f"kubectl create namespace {namespace}"
            result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
            return result.returncode == 0
        except Exception as e:
            print(f"åˆ›å»ºå‘½åç©ºé—´å¤±è´¥: {e}")
            return False

    def deploy_application(self, app_name: str, image: str,
                          replicas: int = 1,
                          ports: List[int] = None) -> bool:
        """éƒ¨ç½²åº”ç”¨"""
        try:
            deployment_yaml = {
                "apiVersion": "apps/v1",
                "kind": "Deployment",
                "metadata": {
                    "name": app_name,
                    "namespace": self.namespace
                },
                "spec": {
                    "replicas": replicas,
                    "selector": {
                        "matchLabels": {
                            "app": app_name
                        }
                    },
                    "template": {
                        "metadata": {
                            "labels": {
                                "app": app_name
                            }
                        },
                        "spec": {
                            "containers": [{
                                "name": app_name,
                                "image": image,
                                "ports": [{"containerPort": port} for port in (ports or [80])]
                            }]
                        }
                    }
                }
            }

# ä¿å­˜YAMLæ–‡ä»¶
            yaml_file = f"{app_name}-deployment.yaml"
            with open(yaml_file, 'w') as f:
                yaml.dump(deployment_yaml, f)

# åº”ç”¨éƒ¨ç½²
            cmd = f"kubectl apply -f {yaml_file}"
            result = subprocess.run(cmd, shell=True, capture_output=True, text=True)

            if result.returncode == 0:
                self.deployments[app_name] = deployment_yaml
                print(f"åº”ç”¨éƒ¨ç½²æˆåŠŸ: {app_name}")
                return True
            else:
                print(f"åº”ç”¨éƒ¨ç½²å¤±è´¥: {result.stderr}")
                return False

        except Exception as e:
            print(f"åº”ç”¨éƒ¨ç½²å¤±è´¥: {e}")
            return False

    def create_service(self, app_name: str, service_type: str = "ClusterIP",
                      ports: List[Dict] = None) -> bool:
        """åˆ›å»ºæœåŠ¡"""
        try:
            service_yaml = {
                "apiVersion": "v1",
                "kind": "Service",
                "metadata": {
                    "name": f"{app_name}-service",
                    "namespace": self.namespace
                },
                "spec": {
                    "type": service_type,
                    "selector": {
                        "app": app_name
                    },
                    "ports": ports or [{"port": 80, "targetPort": 80}]
                }
            }

# ä¿å­˜YAMLæ–‡ä»¶
            yaml_file = f"{app_name}-service.yaml"
            with open(yaml_file, 'w') as f:
                yaml.dump(service_yaml, f)

# åº”ç”¨æœåŠ¡
            cmd = f"kubectl apply -f {yaml_file}"
            result = subprocess.run(cmd, shell=True, capture_output=True, text=True)

            return result.returncode == 0

        except Exception as e:
            print(f"æœåŠ¡åˆ›å»ºå¤±è´¥: {e}")
            return False

    def scale_deployment(self, app_name: str, replicas: int) -> bool:
        """æ‰©å±•éƒ¨ç½²"""
        try:
            cmd = f"kubectl scale deployment {app_name} --replicas={replicas} -n {self.namespace}"
            result = subprocess.run(cmd, shell=True, capture_output=True, text=True)
            return result.returncode == 0
        except Exception as e:
            print(f"æ‰©å±•éƒ¨ç½²å¤±è´¥: {e}")
            return False

    def get_deployment_status(self, app_name: str) -> Dict:
        """è·å–éƒ¨ç½²çŠ¶æ€"""
        try:
            cmd = f"kubectl get deployment {app_name} -n {self.namespace} -o yaml"
            result = subprocess.run(cmd, shell=True, capture_output=True, text=True)

            if result.returncode == 0:
                deployment_data = yaml.safe_load(result.stdout)
                return {
                    'name': app_name,
                    'replicas': deployment_data['spec']['replicas'],
                    'available': deployment_data['status']['availableReplicas'],
                    'ready': deployment_data['status']['readyReplicas']
                }
            return {}
        except Exception as e:
            print(f"è·å–éƒ¨ç½²çŠ¶æ€å¤±è´¥: {e}")
            return {}

# ä½¿ç”¨ç¤ºä¾‹
def demonstrate_kubernetes_deployment():
    """æ¼”ç¤ºKuberneteséƒ¨ç½²"""
    k8s_manager = KubernetesDeploymentManager("myapp")

# åˆ›å»ºå‘½åç©ºé—´
    k8s_manager.create_namespace("myapp")

# éƒ¨ç½²Webåº”ç”¨
    k8s_manager.deploy_application(
        app_name="web-app",
        image="nginx:latest",
        replicas=3,
        ports=[80]
    )

# åˆ›å»ºæœåŠ¡
    k8s_manager.create_service(
        app_name="web-app",
        service_type="LoadBalancer",
        ports=[{"port": 80, "targetPort": 80}]
    )

# æ‰©å±•éƒ¨ç½²
    k8s_manager.scale_deployment("web-app", 5)

# æ£€æŸ¥çŠ¶æ€
    status = k8s_manager.get_deployment_status("web-app")
    print("éƒ¨ç½²çŠ¶æ€:", status)

# è¿è¡Œç¤ºä¾‹
demonstrate_kubernetes_deployment()
```

## 4. è‡ªåŠ¨åŒ–éƒ¨ç½²å®è·µ

### 4.1. CI/CDæµæ°´çº¿éƒ¨ç½²

```python
import json
import requests
from typing import Dict, List, Optional
import time

class CICDPipelineManager:
    def __init__(self, jenkins_url: str, username: str, token: str):
        self.jenkins_url = jenkins_url
        self.username = username
        self.token = token
        self.session = requests.Session()
        self.session.auth = (username, token)

    def trigger_build(self, job_name: str, parameters: Dict = None) -> bool:
        """è§¦å‘æ„å»º"""
        try:
            url = f"{self.jenkins_url}/job/{job_name}/build"

            if parameters:
                url += "/buildWithParameters"
                response = self.session.post(url, params=parameters)
            else:
                response = self.session.post(url)

            return response.status_code == 201
        except Exception as e:
            print(f"è§¦å‘æ„å»ºå¤±è´¥: {e}")
            return False

    def get_build_status(self, job_name: str, build_number: int) -> Dict:
        """è·å–æ„å»ºçŠ¶æ€"""
        try:
            url = f"{self.jenkins_url}/job/{job_name}/{build_number}/api/json"
            response = self.session.get(url)

            if response.status_code == 200:
                build_info = response.json()
                return {
                    'number': build_info['number'],
                    'result': build_info.get('result'),
                    'building': build_info['building'],
                    'duration': build_info.get('duration'),
                    'timestamp': build_info.get('timestamp')
                }
            return {}
        except Exception as e:
            print(f"è·å–æ„å»ºçŠ¶æ€å¤±è´¥: {e}")
            return {}

    def wait_for_build_completion(self, job_name: str, build_number: int,
                                 timeout: int = 300) -> bool:
        """ç­‰å¾…æ„å»ºå®Œæˆ"""
        start_time = time.time()

        while time.time() - start_time < timeout:
            status = self.get_build_status(job_name, build_number)

            if not status.get('building', False):
                return status.get('result') == 'SUCCESS'

            time.sleep(10)

        return False

    def deploy_to_staging(self, app_name: str, version: str) -> bool:
        """éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ"""
        try:
            parameters = {
                'APP_NAME': app_name,
                'VERSION': version,
                'ENVIRONMENT': 'staging'
            }

            success = self.trigger_build('deploy-staging', parameters)
            if success:
                print(f"éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒæˆåŠŸ: {app_name} v{version}")
                return True
            return False
        except Exception as e:
            print(f"éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒå¤±è´¥: {e}")
            return False

    def deploy_to_production(self, app_name: str, version: str) -> bool:
        """éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ"""
        try:
            parameters = {
                'APP_NAME': app_name,
                'VERSION': version,
                'ENVIRONMENT': 'production'
            }

            success = self.trigger_build('deploy-production', parameters)
            if success:
                print(f"éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæˆåŠŸ: {app_name} v{version}")
                return True
            return False
        except Exception as e:
            print(f"éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒå¤±è´¥: {e}")
            return False

# ä½¿ç”¨ç¤ºä¾‹
def demonstrate_cicd_deployment():
    """æ¼”ç¤ºCI/CDéƒ¨ç½²"""
# åˆå§‹åŒ–CI/CDç®¡ç†å™¨ï¼ˆéœ€è¦å®é™…çš„Jenkinsé…ç½®ï¼‰
# cicd_manager = CICDPipelineManager(
# jenkins_url="http://jenkins.example.com",
# username="admin",
# token="your-token"
# )

# éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
# success = cicd_manager.deploy_to_staging("myapp", "v1.0.0")

# å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
# if success:
# cicd_manager.deploy_to_production("myapp", "v1.0.0")
```

## 5. è“ç»¿éƒ¨ç½²å®è·µ

```python
class BlueGreenDeploymentManager:
    def __init__(self, k8s_manager):
        self.k8s_manager = k8s_manager
        self.current_environment = "blue"  # å½“å‰æ´»è·ƒç¯å¢ƒ
        self.environments = {
            "blue": {"active": True, "version": "v1.0.0"},
            "green": {"active": False, "version": "v1.0.0"}
        }

    def deploy_new_version(self, app_name: str, new_version: str) -> bool:
        """éƒ¨ç½²æ–°ç‰ˆæœ¬åˆ°éæ´»è·ƒç¯å¢ƒ"""
        try:
# ç¡®å®šç›®æ ‡ç¯å¢ƒ
            target_env = "green" if self.current_environment == "blue" else "blue"

# éƒ¨ç½²æ–°ç‰ˆæœ¬åˆ°ç›®æ ‡ç¯å¢ƒ
            deployment_name = f"{app_name}-{target_env}"
            success = self.k8s_manager.deploy_application(
                app_name=deployment_name,
                image=f"{app_name}:{new_version}",
                replicas=3
            )

            if success:
                self.environments[target_env]["version"] = new_version
                print(f"æ–°ç‰ˆæœ¬éƒ¨ç½²æˆåŠŸåˆ° {target_env} ç¯å¢ƒ")
                return True
            return False
        except Exception as e:
            print(f"æ–°ç‰ˆæœ¬éƒ¨ç½²å¤±è´¥: {e}")
            return False

    def switch_traffic(self, app_name: str) -> bool:
        """åˆ‡æ¢æµé‡åˆ°æ–°ç¯å¢ƒ"""
        try:
# æ›´æ–°æœåŠ¡é€‰æ‹©å™¨æŒ‡å‘æ–°ç¯å¢ƒ
            new_env = "green" if self.current_environment == "blue" else "blue"

# æ›´æ–°æœåŠ¡é…ç½®
            service_yaml = {
                "apiVersion": "v1",
                "kind": "Service",
                "metadata": {
                    "name": f"{app_name}-service",
                    "namespace": self.k8s_manager.namespace
                },
                "spec": {
                    "type": "LoadBalancer",
                    "selector": {
                        "app": f"{app_name}-{new_env}"
                    },
                    "ports": [{"port": 80, "targetPort": 80}]
                }
            }

# åº”ç”¨æœåŠ¡æ›´æ–°
            yaml_file = f"{app_name}-service-update.yaml"
            with open(yaml_file, 'w') as f:
                yaml.dump(service_yaml, f)

            cmd = f"kubectl apply -f {yaml_file}"
            result = subprocess.run(cmd, shell=True, capture_output=True, text=True)

            if result.returncode == 0:
# æ›´æ–°ç¯å¢ƒçŠ¶æ€
                self.environments[self.current_environment]["active"] = False
                self.environments[new_env]["active"] = True
                self.current_environment = new_env

                print(f"æµé‡åˆ‡æ¢æˆåŠŸåˆ° {new_env} ç¯å¢ƒ")
                return True
            return False
        except Exception as e:
            print(f"æµé‡åˆ‡æ¢å¤±è´¥: {e}")
            return False

    def rollback(self, app_name: str) -> bool:
        """å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬"""
        try:
# åˆ‡æ¢å›ä¸Šä¸€ä¸ªç¯å¢ƒ
            previous_env = "blue" if self.current_environment == "green" else "green"

# åˆ‡æ¢æµé‡
            service_yaml = {
                "apiVersion": "v1",
                "kind": "Service",
                "metadata": {
                    "name": f"{app_name}-service",
                    "namespace": self.k8s_manager.namespace
                },
                "spec": {
                    "type": "LoadBalancer",
                    "selector": {
                        "app": f"{app_name}-{previous_env}"
                    },
                    "ports": [{"port": 80, "targetPort": 80}]
                }
            }

            yaml_file = f"{app_name}-service-rollback.yaml"
            with open(yaml_file, 'w') as f:
                yaml.dump(service_yaml, f)

            cmd = f"kubectl apply -f {yaml_file}"
            result = subprocess.run(cmd, shell=True, capture_output=True, text=True)

            if result.returncode == 0:
                self.environments[self.current_environment]["active"] = False
                self.environments[previous_env]["active"] = True
                self.current_environment = previous_env

                print(f"å›æ»šæˆåŠŸåˆ° {previous_env} ç¯å¢ƒ")
                return True
            return False
        except Exception as e:
            print(f"å›æ»šå¤±è´¥: {e}")
            return False

    def get_deployment_status(self) -> Dict:
        """è·å–éƒ¨ç½²çŠ¶æ€"""
        return {
            'current_environment': self.current_environment,
            'environments': self.environments
        }

# ä½¿ç”¨ç¤ºä¾‹
def demonstrate_blue_green_deployment():
    """æ¼”ç¤ºè“ç»¿éƒ¨ç½²"""
    k8s_manager = KubernetesDeploymentManager("myapp")
    bg_manager = BlueGreenDeploymentManager(k8s_manager)

# éƒ¨ç½²æ–°ç‰ˆæœ¬
    success = bg_manager.deploy_new_version("web-app", "v1.1.0")

    if success:
# ç­‰å¾…æ–°ç‰ˆæœ¬å°±ç»ª
        time.sleep(30)

# åˆ‡æ¢æµé‡
        bg_manager.switch_traffic("web-app")

# æ£€æŸ¥çŠ¶æ€
        status = bg_manager.get_deployment_status()
        print("éƒ¨ç½²çŠ¶æ€:", status)
```

## 6. ç›‘æ§ä¸å¥åº·æ£€æŸ¥

### 6.1. åº”ç”¨å¥åº·æ£€æŸ¥

```python
import requests
import time
from typing import Dict, List

class HealthCheckManager:
    def __init__(self):
        self.health_endpoints = {}
        self.check_results = {}

    def add_health_endpoint(self, service_name: str, endpoint: str,
                           expected_status: int = 200) -> None:
        """æ·»åŠ å¥åº·æ£€æŸ¥ç«¯ç‚¹"""
        self.health_endpoints[service_name] = {
            'endpoint': endpoint,
            'expected_status': expected_status
        }

    def check_service_health(self, service_name: str) -> Dict:
        """æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€"""
        try:
            if service_name not in self.health_endpoints:
                return {'status': 'unknown', 'error': 'Service not found'}

            endpoint_info = self.health_endpoints[service_name]
            response = requests.get(endpoint_info['endpoint'], timeout=10)

            is_healthy = response.status_code == endpoint_info['expected_status']

            result = {
                'service': service_name,
                'status': 'healthy' if is_healthy else 'unhealthy',
                'status_code': response.status_code,
                'response_time': response.elapsed.total_seconds(),
                'timestamp': time.time()
            }

            self.check_results[service_name] = result
            return result
        except Exception as e:
            result = {
                'service': service_name,
                'status': 'error',
                'error': str(e),
                'timestamp': time.time()
            }
            self.check_results[service_name] = result
            return result

    def check_all_services(self) -> List[Dict]:
        """æ£€æŸ¥æ‰€æœ‰æœåŠ¡å¥åº·çŠ¶æ€"""
        results = []
        for service_name in self.health_endpoints:
            result = self.check_service_health(service_name)
            results.append(result)
        return results

    def get_service_status_summary(self) -> Dict:
        """è·å–æœåŠ¡çŠ¶æ€æ‘˜è¦"""
        healthy_count = 0
        unhealthy_count = 0
        error_count = 0

        for result in self.check_results.values():
            if result['status'] == 'healthy':
                healthy_count += 1
            elif result['status'] == 'unhealthy':
                unhealthy_count += 1
            else:
                error_count += 1

        return {
            'total_services': len(self.check_results),
            'healthy': healthy_count,
            'unhealthy': unhealthy_count,
            'errors': error_count,
            'health_percentage': (healthy_count / len(self.check_results) * 100) if self.check_results else 0
        }

# ä½¿ç”¨ç¤ºä¾‹
def demonstrate_health_check():
    """æ¼”ç¤ºå¥åº·æ£€æŸ¥"""
    health_manager = HealthCheckManager()

# æ·»åŠ å¥åº·æ£€æŸ¥ç«¯ç‚¹
    health_manager.add_health_endpoint("web-app", "http://localhost:8080/health")
    health_manager.add_health_endpoint("api-service", "http://localhost:8081/health")
    health_manager.add_health_endpoint("database", "http://localhost:5432/health")

# æ£€æŸ¥æ‰€æœ‰æœåŠ¡
    results = health_manager.check_all_services()
    print("å¥åº·æ£€æŸ¥ç»“æœ:", results)

# è·å–çŠ¶æ€æ‘˜è¦
    summary = health_manager.get_service_status_summary()
    print("æœåŠ¡çŠ¶æ€æ‘˜è¦:", summary)
```

## 7. æ€»ç»“

æœ¬æ–‡æ¡£æä¾›äº†éƒ¨ç½²æµç¨‹çš„å®è·µæ¡ˆä¾‹ï¼Œæ¶µç›–ï¼š

1. **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šDockerå®¹å™¨åŒ–ã€Kuberneteséƒ¨ç½²
2. **è‡ªåŠ¨åŒ–éƒ¨ç½²**ï¼šCI/CDæµæ°´çº¿ã€è“ç»¿éƒ¨ç½²
3. **ç›‘æ§ä¸å¥åº·æ£€æŸ¥**ï¼šåº”ç”¨å¥åº·æ£€æŸ¥ã€çŠ¶æ€ç›‘æ§

æ¯ä¸ªæ¡ˆä¾‹éƒ½åŒ…å«ï¼š

- éƒ¨ç½²æµç¨‹è®¾è®¡
- è‡ªåŠ¨åŒ–è„šæœ¬å®ç°
- é”™è¯¯å¤„ç†æœºåˆ¶
- å®é™…åº”ç”¨åœºæ™¯

è¿™äº›å®è·µæ¡ˆä¾‹å±•ç¤ºäº†ç°ä»£éƒ¨ç½²æµç¨‹çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œä¸ºæ„å»ºå¯é ã€é«˜æ•ˆçš„éƒ¨ç½²ç³»ç»Ÿæä¾›äº†å‚è€ƒã€‚

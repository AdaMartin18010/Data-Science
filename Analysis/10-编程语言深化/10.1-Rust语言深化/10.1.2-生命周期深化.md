# 10.1.2-Rustç”Ÿå‘½å‘¨æœŸæ·±åŒ–

## ğŸ“‘ ç›®å½•

- [10.1.2-Rustç”Ÿå‘½å‘¨æœŸæ·±åŒ–](#1012-rustç”Ÿå‘½å‘¨æœŸæ·±åŒ–)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
- [æ¦‚è¿°](#æ¦‚è¿°)
- [ç”Ÿå‘½å‘¨æœŸåŸºç¡€](#ç”Ÿå‘½å‘¨æœŸåŸºç¡€)
  - [ç”Ÿå‘½å‘¨æœŸæ³¨è§£](#ç”Ÿå‘½å‘¨æœŸæ³¨è§£)
  - [ç”Ÿå‘½å‘¨æœŸå‚æ•°](#ç”Ÿå‘½å‘¨æœŸå‚æ•°)
- [ç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™](#ç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™)
  - [ä¸‰æ¡çœç•¥è§„åˆ™](#ä¸‰æ¡çœç•¥è§„åˆ™)
  - [çœç•¥ç¤ºä¾‹](#çœç•¥ç¤ºä¾‹)
- [ç»“æ„ä½“ä¸­çš„ç”Ÿå‘½å‘¨æœŸ](#ç»“æ„ä½“ä¸­çš„ç”Ÿå‘½å‘¨æœŸ)
  - [åŒ…å«å¼•ç”¨çš„ç»“æ„ä½“](#åŒ…å«å¼•ç”¨çš„ç»“æ„ä½“)
  - [ç”Ÿå‘½å‘¨æœŸçº¦æŸ](#ç”Ÿå‘½å‘¨æœŸçº¦æŸ)
- [ç”Ÿå‘½å‘¨æœŸä¸æ³›å‹](#ç”Ÿå‘½å‘¨æœŸä¸æ³›å‹)
  - [æ³›å‹ç”Ÿå‘½å‘¨æœŸ](#æ³›å‹ç”Ÿå‘½å‘¨æœŸ)
  - [ç”Ÿå‘½å‘¨æœŸçº¦æŸ1](#ç”Ÿå‘½å‘¨æœŸçº¦æŸ1)
- [é«˜çº§ç”Ÿå‘½å‘¨æœŸæ¨¡å¼](#é«˜çº§ç”Ÿå‘½å‘¨æœŸæ¨¡å¼)
  - [é™æ€ç”Ÿå‘½å‘¨æœŸ](#é™æ€ç”Ÿå‘½å‘¨æœŸ)
  - [ç”Ÿå‘½å‘¨æœŸå­ç±»å‹](#ç”Ÿå‘½å‘¨æœŸå­ç±»å‹)
  - [ç”Ÿå‘½å‘¨æœŸæ¨æ–­](#ç”Ÿå‘½å‘¨æœŸæ¨æ–­)
- [ç”Ÿå‘½å‘¨æœŸä¸è¿­ä»£å™¨](#ç”Ÿå‘½å‘¨æœŸä¸è¿­ä»£å™¨)
  - [è¿­ä»£å™¨ç”Ÿå‘½å‘¨æœŸ](#è¿­ä»£å™¨ç”Ÿå‘½å‘¨æœŸ)
  - [é—­åŒ…ç”Ÿå‘½å‘¨æœŸ](#é—­åŒ…ç”Ÿå‘½å‘¨æœŸ)
- [ç”Ÿå‘½å‘¨æœŸä¸å¼‚æ­¥ç¼–ç¨‹](#ç”Ÿå‘½å‘¨æœŸä¸å¼‚æ­¥ç¼–ç¨‹)
  - [å¼‚æ­¥å‡½æ•°ç”Ÿå‘½å‘¨æœŸ](#å¼‚æ­¥å‡½æ•°ç”Ÿå‘½å‘¨æœŸ)
  - [Futureç”Ÿå‘½å‘¨æœŸ](#futureç”Ÿå‘½å‘¨æœŸ)
- [ç”Ÿå‘½å‘¨æœŸä¸é”™è¯¯å¤„ç†](#ç”Ÿå‘½å‘¨æœŸä¸é”™è¯¯å¤„ç†)
  - [Resultç”Ÿå‘½å‘¨æœŸ](#resultç”Ÿå‘½å‘¨æœŸ)
  - [Optionç”Ÿå‘½å‘¨æœŸ](#optionç”Ÿå‘½å‘¨æœŸ)
- [ç”Ÿå‘½å‘¨æœŸæœ€ä½³å®è·µ](#ç”Ÿå‘½å‘¨æœŸæœ€ä½³å®è·µ)
  - [é¿å…ä¸å¿…è¦çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°](#é¿å…ä¸å¿…è¦çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°)
  - [ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçº¦æŸ](#ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçº¦æŸ)
- [ç”Ÿå‘½å‘¨æœŸè°ƒè¯•](#ç”Ÿå‘½å‘¨æœŸè°ƒè¯•)
  - [ç¼–è¯‘å™¨é”™è¯¯åˆ†æ](#ç¼–è¯‘å™¨é”™è¯¯åˆ†æ)
  - [ç”Ÿå‘½å‘¨æœŸå¯è§†åŒ–](#ç”Ÿå‘½å‘¨æœŸå¯è§†åŒ–)
- [æ€»ç»“](#æ€»ç»“)
---


## æ¦‚è¿°

ç”Ÿå‘½å‘¨æœŸæ˜¯Rustç±»å‹ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç”¨äºç¡®ä¿å¼•ç”¨çš„æœ‰æ•ˆæ€§ã€‚æœ¬æ¨¡å—æ·±å…¥æ¢è®¨ç”Ÿå‘½å‘¨æœŸçš„ç†è®ºåŸºç¡€ã€è¯­æ³•è§„åˆ™å’Œé«˜çº§åº”ç”¨ã€‚

## ç”Ÿå‘½å‘¨æœŸåŸºç¡€

### ç”Ÿå‘½å‘¨æœŸæ³¨è§£

```rust
fn longest<'a>(x: &'a str, y: &'a str) -> &'a str {
    if x.len() > y.len() {
        x
    } else {
        y
    }
}
```

### ç”Ÿå‘½å‘¨æœŸå‚æ•°

```rust
fn main() {
    let string1 = String::from("long string is long");
    let string2 = String::from("xyz");
    let result = longest(&string1, &string2);
    println!("æœ€é•¿çš„å­—ç¬¦ä¸²æ˜¯: {}", result);
}
```

## ç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™

### ä¸‰æ¡çœç•¥è§„åˆ™

1. **æ¯ä¸ªå¼•ç”¨å‚æ•°éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°**
2. **å¦‚æœåªæœ‰ä¸€ä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œé‚£ä¹ˆå®ƒè¢«èµ‹ç»™æ‰€æœ‰è¾“å‡ºç”Ÿå‘½å‘¨æœŸå‚æ•°**
3. **å¦‚æœæœ‰å¤šä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œä½†å…¶ä¸­ä¸€ä¸ªæ˜¯&selfæˆ–&mut selfï¼Œé‚£ä¹ˆselfçš„ç”Ÿå‘½å‘¨æœŸè¢«èµ‹ç»™æ‰€æœ‰è¾“å‡ºç”Ÿå‘½å‘¨æœŸå‚æ•°**

### çœç•¥ç¤ºä¾‹

```rust
// çœç•¥å‰
fn first_word<'a>(s: &'a str) -> &'a str {
    // å®ç°
}

// çœç•¥å
fn first_word(s: &str) -> &str {
    // å®ç°
}
```

## ç»“æ„ä½“ä¸­çš„ç”Ÿå‘½å‘¨æœŸ

### åŒ…å«å¼•ç”¨çš„ç»“æ„ä½“

```rust
struct ImportantExcerpt<'a> {
    part: &'a str,
}

fn main() {
    let novel = String::from("Call me Ishmael. Some years ago...");
    let first_sentence = novel.split('.').next().expect("æ‰¾ä¸åˆ°'.'");
    let i = ImportantExcerpt {
        part: first_sentence,
    };
}
```

### ç”Ÿå‘½å‘¨æœŸçº¦æŸ

```rust
struct Context<'a> {
    data: &'a str,
}

impl<'a> Context<'a> {
    fn new(data: &'a str) -> Self {
        Context { data }
    }

    fn get_data(&self) -> &'a str {
        self.data
    }
}
```

## ç”Ÿå‘½å‘¨æœŸä¸æ³›å‹

### æ³›å‹ç”Ÿå‘½å‘¨æœŸ

```rust
use std::fmt::Display;

fn longest_with_an_announcement<'a, T>(
    x: &'a str,
    y: &'a str,
    ann: T,
) -> &'a str
where
    T: Display,
{
    println!("å…¬å‘Š! {}", ann);
    if x.len() > y.len() {
        x
    } else {
        y
    }
}
```

### ç”Ÿå‘½å‘¨æœŸçº¦æŸ1

```rust
fn longest<'a: 'b, 'b>(x: &'a str, y: &'b str) -> &'b str {
    if x.len() > y.len() {
        x
    } else {
        y
    }
}
```

## é«˜çº§ç”Ÿå‘½å‘¨æœŸæ¨¡å¼

### é™æ€ç”Ÿå‘½å‘¨æœŸ

```rust
let s: &'static str = "I have a static lifetime.";
```

### ç”Ÿå‘½å‘¨æœŸå­ç±»å‹

```rust
fn process<'a, 'b>(data: &'a str) -> &'b str
where
    'a: 'b, // 'a è‡³å°‘å’Œ 'b ä¸€æ ·é•¿
{
    data
}
```

### ç”Ÿå‘½å‘¨æœŸæ¨æ–­

```rust
fn main() {
    let x = 5;
    let r = &x; // ç¼–è¯‘å™¨æ¨æ–­ç”Ÿå‘½å‘¨æœŸ

    println!("r: {}", r);
}
```

## ç”Ÿå‘½å‘¨æœŸä¸è¿­ä»£å™¨

### è¿­ä»£å™¨ç”Ÿå‘½å‘¨æœŸ

```rust
fn find_first<'a>(items: &'a [i32], target: i32) -> Option<&'a i32> {
    items.iter().find(|&&item| item == target)
}
```

### é—­åŒ…ç”Ÿå‘½å‘¨æœŸ

```rust
fn create_closure<'a>(data: &'a [i32]) -> impl Fn() -> &'a [i32] {
    move || data
}
```

## ç”Ÿå‘½å‘¨æœŸä¸å¼‚æ­¥ç¼–ç¨‹

### å¼‚æ­¥å‡½æ•°ç”Ÿå‘½å‘¨æœŸ

```rust
async fn fetch_data<'a>(url: &'a str) -> Result<String, Box<dyn std::error::Error>> {
    // å¼‚æ­¥å®ç°
    Ok(String::new())
}
```

### Futureç”Ÿå‘½å‘¨æœŸ

```rust
use std::future::Future;

fn process_future<'a, F>(future: F) -> impl Future<Output = ()> + 'a
where
    F: Future<Output = ()> + 'a,
{
    async move {
        let _ = future.await;
    }
}
```

## ç”Ÿå‘½å‘¨æœŸä¸é”™è¯¯å¤„ç†

### Resultç”Ÿå‘½å‘¨æœŸ

```rust
fn read_file<'a>(path: &'a str) -> Result<&'a str, std::io::Error> {
    // å®ç°
    Ok("file content")
}
```

### Optionç”Ÿå‘½å‘¨æœŸ

```rust
fn find_element<'a>(items: &'a [i32], target: i32) -> Option<&'a i32> {
    items.iter().find(|&&item| item == target)
}
```

## ç”Ÿå‘½å‘¨æœŸæœ€ä½³å®è·µ

### é¿å…ä¸å¿…è¦çš„ç”Ÿå‘½å‘¨æœŸå‚æ•°

```rust
// å¥½çš„åšæ³•
fn process(data: &str) -> String {
    data.to_uppercase()
}

// é¿å…è¿‡åº¦å¤æ‚
fn process<'a>(data: &'a str) -> String {
    data.to_uppercase()
}
```

### ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçº¦æŸ

```rust
fn longest<'a: 'b, 'b>(x: &'a str, y: &'b str) -> &'b str {
    if x.len() > y.len() {
        x
    } else {
        y
    }
}
```

## ç”Ÿå‘½å‘¨æœŸè°ƒè¯•

### ç¼–è¯‘å™¨é”™è¯¯åˆ†æ

```rust
fn main() {
    let r;
    {
        let x = 5;
        r = &x; // é”™è¯¯ï¼šxçš„ç”Ÿå‘½å‘¨æœŸä¸å¤Ÿé•¿
    }
    println!("r: {}", r);
}
```

### ç”Ÿå‘½å‘¨æœŸå¯è§†åŒ–

```rust
// ä½¿ç”¨æ³¨é‡Šè¯´æ˜ç”Ÿå‘½å‘¨æœŸ
fn example<'a, 'b>(x: &'a i32, y: &'b i32) -> &'a i32 {
    // 'a å’Œ 'b çš„ç”Ÿå‘½å‘¨æœŸå…³ç³»
    x
}
```

## æ€»ç»“

ç”Ÿå‘½å‘¨æœŸæ˜¯Rustå†…å­˜å®‰å…¨ç³»ç»Ÿçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œé€šè¿‡ç¼–è¯‘æ—¶æ£€æŸ¥ç¡®ä¿å¼•ç”¨çš„æœ‰æ•ˆæ€§ã€‚ç†è§£ç”Ÿå‘½å‘¨æœŸå¯¹äºç¼–å†™å®‰å…¨ã€é«˜æ•ˆçš„Rustä»£ç è‡³å…³é‡è¦ã€‚

---

**ç›¸å…³é“¾æ¥ï¼š**

- [10.1.1-æ‰€æœ‰æƒç³»ç»Ÿæ·±åŒ–](10.1.1-æ‰€æœ‰æƒç³»ç»Ÿæ·±åŒ–.md)
- [10.1.3-å€Ÿç”¨æ£€æŸ¥æ·±åŒ–](10.1.3-å€Ÿç”¨æ£€æŸ¥æ·±åŒ–.md)
- [8.1-ç±»å‹ç†è®ºæ·±åŒ–](../8-å½¢å¼ç†è®ºæ·±åŒ–/8.1-ç±»å‹ç†è®ºæ·±åŒ–/README.md)

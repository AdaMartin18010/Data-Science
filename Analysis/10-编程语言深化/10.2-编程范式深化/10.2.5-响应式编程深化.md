# 10.2.5-å“åº”å¼ç¼–ç¨‹æ·±åŒ–

## ğŸ“‘ ç›®å½•

- [10.2.5-å“åº”å¼ç¼–ç¨‹æ·±åŒ–](#1025-å“åº”å¼ç¼–ç¨‹æ·±åŒ–)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
- [1. æ¦‚è¿°](#1-æ¦‚è¿°)
- [2. å“åº”å¼ç¼–ç¨‹åŸºç¡€](#2-å“åº”å¼ç¼–ç¨‹åŸºç¡€)
  - [2.1. æ ¸å¿ƒæ¦‚å¿µ](#21-æ ¸å¿ƒæ¦‚å¿µ)
- [3. åŸºæœ¬ç»„ä»¶](#3-åŸºæœ¬ç»„ä»¶)
- [4. æ•°æ®æµå¤„ç†](#4-æ•°æ®æµå¤„ç†)
  - [4.1. æµå¼æ•°æ®è½¬æ¢](#41-æµå¼æ•°æ®è½¬æ¢)
- [5. äº‹ä»¶æµå¤„ç†](#5-äº‹ä»¶æµå¤„ç†)
- [6. å¼‚æ­¥æ•°æ®æµ](#6-å¼‚æ­¥æ•°æ®æµ)
  - [6.1. å¼‚æ­¥æµå¤„ç†](#61-å¼‚æ­¥æµå¤„ç†)
- [7. å¹¶å‘æµå¤„ç†](#7-å¹¶å‘æµå¤„ç†)
- [8. èƒŒå‹å¤„ç†](#8-èƒŒå‹å¤„ç†)
  - [8.1. èƒŒå‹æ§åˆ¶ç­–ç•¥](#81-èƒŒå‹æ§åˆ¶ç­–ç•¥)
- [9. æµæ§åˆ¶](#9-æµæ§åˆ¶)
- [10. å“åº”å¼æ¨¡å¼](#10-å“åº”å¼æ¨¡å¼)
  - [10.1. è§‚å¯Ÿè€…æ¨¡å¼](#101-è§‚å¯Ÿè€…æ¨¡å¼)
- [11. å‘å¸ƒ-è®¢é˜…æ¨¡å¼](#11-å‘å¸ƒ-è®¢é˜…æ¨¡å¼)
- [12. å“åº”å¼UI](#12-å“åº”å¼ui)
  - [12.1. å“åº”å¼ç•Œé¢](#121-å“åº”å¼ç•Œé¢)
- [13. å“åº”å¼æ•°æ®åº“](#13-å“åº”å¼æ•°æ®åº“)
  - [13.1. å“åº”å¼æŸ¥è¯¢](#131-å“åº”å¼æŸ¥è¯¢)
- [14. å“åº”å¼å¾®æœåŠ¡](#14-å“åº”å¼å¾®æœåŠ¡)
  - [14.1. å“åº”å¼æœåŠ¡](#141-å“åº”å¼æœåŠ¡)
- [15. é”™è¯¯å¤„ç†](#15-é”™è¯¯å¤„ç†)
  - [15.1. å“åº”å¼é”™è¯¯å¤„ç†](#151-å“åº”å¼é”™è¯¯å¤„ç†)
- [16. æ€§èƒ½ä¼˜åŒ–](#16-æ€§èƒ½ä¼˜åŒ–)
  - [16.1. å“åº”å¼æ€§èƒ½ä¼˜åŒ–](#161-å“åº”å¼æ€§èƒ½ä¼˜åŒ–)
- [17. æ€»ç»“](#17-æ€»ç»“)
---


## 1. æ¦‚è¿°

å“åº”å¼ç¼–ç¨‹æ˜¯ä¸€ç§åŸºäºæ•°æ®æµå’Œå˜åŒ–ä¼ æ’­çš„ç¼–ç¨‹èŒƒå¼ï¼Œé€šè¿‡å£°æ˜å¼çš„æ–¹å¼å¤„ç†å¼‚æ­¥æ•°æ®æµå’Œäº‹ä»¶æµã€‚

## 2. å“åº”å¼ç¼–ç¨‹åŸºç¡€

### 2.1. æ ¸å¿ƒæ¦‚å¿µ

```python
# å“åº”å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ€æƒ³
æ•°æ®æµ = äº‹ä»¶æµ + å˜åŒ–ä¼ æ’­ + å£°æ˜å¼å¤„ç†
```

## 3. åŸºæœ¬ç»„ä»¶

```python
from rx import Observable
from rx.subject import Subject

# åˆ›å»ºå¯è§‚å¯Ÿå¯¹è±¡
observable = Observable.from_iterable([1, 2, 3, 4, 5])

# è®¢é˜…æ•°æ®æµ
observable.subscribe(
    on_next=lambda x: print(f"æ”¶åˆ°æ•°æ®: {x}"),
    on_error=lambda e: print(f"é”™è¯¯: {e}"),
    on_completed=lambda: print("å®Œæˆ")
)
```

## 4. æ•°æ®æµå¤„ç†

### 4.1. æµå¼æ•°æ®è½¬æ¢

```python
from rx import Observable
import rx.operators as ops

def stream_processing():
# åˆ›å»ºæ•°æ®æµ
    source = Observable.from_iterable(range(1, 11))

# æµå¼å¤„ç†
    result = source.pipe(
        ops.filter(lambda x: x % 2 == 0),  # è¿‡æ»¤å¶æ•°
        ops.map(lambda x: x * 2),          # æ˜ å°„è½¬æ¢
        ops.reduce(lambda acc, x: acc + x, 0)  # å½’çº¦æ±‚å’Œ
    )

    result.subscribe(lambda x: print(f"ç»“æœ: {x}"))

stream_processing()
```

## 5. äº‹ä»¶æµå¤„ç†

```python
from rx import Observable
from rx.subject import Subject
import time

def event_stream_processing():
# åˆ›å»ºäº‹ä»¶ä¸»é¢˜
    event_stream = Subject()

# å¤„ç†äº‹ä»¶æµ
    event_stream.pipe(
        ops.debounce(0.5),  # é˜²æŠ–
        ops.distinct_until_changed()  # å»é‡
    ).subscribe(
        lambda event: print(f"å¤„ç†äº‹ä»¶: {event}")
    )

# å‘é€äº‹ä»¶
    for i in range(5):
        event_stream.on_next(f"äº‹ä»¶{i}")
        time.sleep(0.1)

    event_stream.on_completed()

event_stream_processing()
```

## 6. å¼‚æ­¥æ•°æ®æµ

### 6.1. å¼‚æ­¥æµå¤„ç†

```python
import asyncio
from rx import Observable
import rx.operators as ops

async def async_stream_processing():
# åˆ›å»ºå¼‚æ­¥æ•°æ®æµ
    async def async_data_source():
        for i in range(5):
            await asyncio.sleep(0.5)
            yield i

# è½¬æ¢ä¸ºObservable
    source = Observable.from_async_iterable(async_data_source())

# å¼‚æ­¥å¤„ç†
    result = source.pipe(
        ops.map(lambda x: x * 2),
        ops.filter(lambda x: x > 5)
    )

    result.subscribe(lambda x: print(f"å¼‚æ­¥ç»“æœ: {x}"))

# è¿è¡Œå¼‚æ­¥æµå¤„ç†
asyncio.run(async_stream_processing())
```

## 7. å¹¶å‘æµå¤„ç†

```python
from rx import Observable
import rx.operators as ops
import concurrent.futures
import time

def concurrent_stream_processing():
    def slow_operation(x):
        time.sleep(0.1)
        return x * x

# åˆ›å»ºæ•°æ®æµ
    source = Observable.from_iterable(range(1, 6))

# å¹¶å‘å¤„ç†
    result = source.pipe(
        ops.flat_map(lambda x: Observable.from_callable(
            lambda: slow_operation(x)
        )),
        ops.merge(max_concurrent=3)  # æœ€å¤§å¹¶å‘æ•°
    )

    result.subscribe(lambda x: print(f"å¹¶å‘ç»“æœ: {x}"))

concurrent_stream_processing()
```

## 8. èƒŒå‹å¤„ç†

### 8.1. èƒŒå‹æ§åˆ¶ç­–ç•¥

```python
from rx import Observable
import rx.operators as ops
import time

def backpressure_handling():
# å¿«é€Ÿç”Ÿäº§è€…
    def fast_producer():
        for i in range(1000):
            yield i
            time.sleep(0.001)  # å¿«é€Ÿäº§ç”Ÿæ•°æ®

# æ…¢é€Ÿæ¶ˆè´¹è€…
    def slow_consumer(x):
        time.sleep(0.1)  # æ…¢é€Ÿå¤„ç†
        print(f"å¤„ç†: {x}")

# åˆ›å»ºæµå¹¶å¤„ç†èƒŒå‹
    source = Observable.from_iterable(fast_producer())

# ä½¿ç”¨èƒŒå‹ç­–ç•¥
    result = source.pipe(
        ops.buffer_with_count(10),  # ç¼“å†²ç­–ç•¥
        ops.flat_map(lambda batch: Observable.from_iterable(batch)),
        ops.observe_on(rx.scheduler.ThreadPoolScheduler(max_workers=2))
    )

    result.subscribe(slow_consumer)

backpressure_handling()
```

## 9. æµæ§åˆ¶

```python
from rx import Observable
import rx.operators as ops

def flow_control():
# åˆ›å»ºæ•°æ®æµ
    source = Observable.interval(0.1)  # æ¯100msäº§ç”Ÿä¸€ä¸ªæ•°æ®

# æµæ§åˆ¶
    controlled = source.pipe(
        ops.take(10),  # é™åˆ¶æ•°é‡
        ops.throttle(0.5),  # èŠ‚æµ
        ops.sample(0.3)  # é‡‡æ ·
    )

    controlled.subscribe(lambda x: print(f"æ§åˆ¶åçš„æ•°æ®: {x}"))

flow_control()
```

## 10. å“åº”å¼æ¨¡å¼

### 10.1. è§‚å¯Ÿè€…æ¨¡å¼

```python
from rx.subject import Subject

class ReactiveObserver:
    def __init__(self):
        self.subject = Subject()

    def subscribe(self, observer):
        return self.subject.subscribe(observer)

    def notify(self, data):
        self.subject.on_next(data)

    def complete(self):
        self.subject.on_completed()

# ä½¿ç”¨ç¤ºä¾‹
def observer_pattern_example():
    observer = ReactiveObserver()

# è®¢é˜…è€…
    observer.subscribe(
        lambda data: print(f"è§‚å¯Ÿè€…1æ”¶åˆ°: {data}")
    )

    observer.subscribe(
        lambda data: print(f"è§‚å¯Ÿè€…2æ”¶åˆ°: {data}")
    )

# é€šçŸ¥
    observer.notify("æ•°æ®1")
    observer.notify("æ•°æ®2")
    observer.complete()

observer_pattern_example()
```

## 11. å‘å¸ƒ-è®¢é˜…æ¨¡å¼

```python
from rx.subject import Subject
from rx import Observable

class ReactivePubSub:
    def __init__(self):
        self.subjects = {}

    def publish(self, topic, data):
        if topic not in self.subjects:
            self.subjects[topic] = Subject()
        self.subjects[topic].on_next(data)

    def subscribe(self, topic, observer):
        if topic not in self.subjects:
            self.subjects[topic] = Subject()
        return self.subjects[topic].subscribe(observer)

    def unsubscribe(self, topic, subscription):
        subscription.dispose()

# ä½¿ç”¨ç¤ºä¾‹
def pubsub_pattern_example():
    pubsub = ReactivePubSub()

# è®¢é˜…ä¸»é¢˜
    sub1 = pubsub.subscribe("news", lambda data: print(f"æ–°é—»è®¢é˜…è€…: {data}"))
    sub2 = pubsub.subscribe("sports", lambda data: print(f"ä½“è‚²è®¢é˜…è€…: {data}"))

# å‘å¸ƒæ¶ˆæ¯
    pubsub.publish("news", "é‡è¦æ–°é—»")
    pubsub.publish("sports", "æ¯”èµ›ç»“æœ")

# å–æ¶ˆè®¢é˜…
    sub1.dispose()

pubsub_pattern_example()
```

## 12. å“åº”å¼UI

### 12.1. å“åº”å¼ç•Œé¢

```python
import tkinter as tk
from rx.subject import Subject
from rx import Observable
import rx.operators as ops

class ReactiveUI:
    def __init__(self):
        self.root = tk.Tk()
        self.root.title("å“åº”å¼UI")

# åˆ›å»ºå“åº”å¼æ•°æ®æµ
        self.text_subject = Subject()
        self.counter_subject = Subject()

        self.setup_ui()
        self.setup_reactive_logic()

    def setup_ui(self):
# æ–‡æœ¬è¾“å…¥
        self.text_entry = tk.Entry(self.root)
        self.text_entry.pack()
        self.text_entry.bind('<KeyRelease>', self.on_text_change)

# æŒ‰é’®
        self.button = tk.Button(self.root, text="ç‚¹å‡»", command=self.on_button_click)
        self.button.pack()

# æ ‡ç­¾
        self.label = tk.Label(self.root, text="ç­‰å¾…è¾“å…¥...")
        self.label.pack()

        self.counter_label = tk.Label(self.root, text="ç‚¹å‡»æ¬¡æ•°: 0")
        self.counter_label.pack()

    def setup_reactive_logic(self):
# æ–‡æœ¬å¤„ç†é€»è¾‘
        self.text_subject.pipe(
            ops.debounce(0.3),  # é˜²æŠ–
            ops.map(lambda text: f"è¾“å…¥: {text}")
        ).subscribe(lambda text: self.label.config(text=text))

# è®¡æ•°å™¨é€»è¾‘
        self.counter_subject.pipe(
            ops.scan(lambda acc, _: acc + 1, 0)
        ).subscribe(lambda count: self.counter_label.config(text=f"ç‚¹å‡»æ¬¡æ•°: {count}"))

    def on_text_change(self, event):
        self.text_subject.on_next(self.text_entry.get())

    def on_button_click(self):
        self.counter_subject.on_next(None)

    def run(self):
        self.root.mainloop()

# è¿è¡Œå“åº”å¼UI
# ui = ReactiveUI()
# ui.run()
```

## 13. å“åº”å¼æ•°æ®åº“

### 13.1. å“åº”å¼æŸ¥è¯¢

```python
from rx import Observable
import sqlite3
import threading

class ReactiveDatabase:
    def __init__(self, db_path):
        self.db_path = db_path
        self.query_subject = Subject()

    def query_observable(self, sql, params=None):
        def execute_query():
            conn = sqlite3.connect(self.db_path)
            cursor = conn.cursor()
            cursor.execute(sql, params or ())
            results = cursor.fetchall()
            conn.close()
            return results

        return Observable.from_callable(execute_query)

    def reactive_query(self, sql, params=None):
        return self.query_observable(sql, params).pipe(
            ops.observe_on(rx.scheduler.ThreadPoolScheduler(max_workers=1))
        )

# ä½¿ç”¨ç¤ºä¾‹
def reactive_database_example():
    db = ReactiveDatabase(":memory:")

# åˆ›å»ºè¡¨
    conn = sqlite3.connect(":memory:")
    conn.execute("CREATE TABLE users (id INTEGER, name TEXT)")
    conn.execute("INSERT INTO users VALUES (1, 'Alice'), (2, 'Bob')")
    conn.close()

# å“åº”å¼æŸ¥è¯¢
    query = db.reactive_query("SELECT * FROM users")
    query.subscribe(lambda results: print(f"æŸ¥è¯¢ç»“æœ: {results}"))

reactive_database_example()
```

## 14. å“åº”å¼å¾®æœåŠ¡

### 14.1. å“åº”å¼æœåŠ¡

```python
from rx import Observable
from rx.subject import Subject
import asyncio
import aiohttp

class ReactiveService:
    def __init__(self):
        self.request_subject = Subject()
        self.response_subject = Subject()

    async def handle_request(self, request_data):
# æ¨¡æ‹Ÿå¼‚æ­¥å¤„ç†
        await asyncio.sleep(0.1)
        return {"status": "success", "data": request_data}

    def process_request(self, request_data):
        return Observable.from_future(
            asyncio.create_task(self.handle_request(request_data))
        )

    def reactive_api_call(self, url):
        async def make_request():
            async with aiohttp.ClientSession() as session:
                async with session.get(url) as response:
                    return await response.json()

        return Observable.from_future(asyncio.create_task(make_request()))

# ä½¿ç”¨ç¤ºä¾‹
def reactive_service_example():
    service = ReactiveService()

# å¤„ç†è¯·æ±‚
    service.process_request({"id": 1, "action": "get"}).subscribe(
        lambda response: print(f"å“åº”: {response}")
    )

# APIè°ƒç”¨
    service.reactive_api_call("https://api.example.com/data").subscribe(
        lambda data: print(f"APIæ•°æ®: {data}")
    )

# reactive_service_example()
```

## 15. é”™è¯¯å¤„ç†

### 15.1. å“åº”å¼é”™è¯¯å¤„ç†

```python
from rx import Observable
import rx.operators as ops

def reactive_error_handling():
# åˆ›å»ºå¯èƒ½å‡ºé”™çš„æµ
    source = Observable.from_iterable([1, 2, 3, 4, 5])

# æ·»åŠ é”™è¯¯å¤„ç†
    result = source.pipe(
        ops.map(lambda x: x / (x - 3) if x != 3 else None),  # å¯èƒ½å‡ºé”™çš„æ“ä½œ
        ops.catch(lambda error, source: Observable.just(f"é”™è¯¯: {error}")),
        ops.retry(2),  # é‡è¯•2æ¬¡
        ops.on_error_resume_next(Observable.just("æ¢å¤æ“ä½œ"))
    )

    result.subscribe(
        lambda x: print(f"ç»“æœ: {x}"),
        lambda e: print(f"é”™è¯¯: {e}"),
        lambda: print("å®Œæˆ")
    )

reactive_error_handling()
```

## 16. æ€§èƒ½ä¼˜åŒ–

### 16.1. å“åº”å¼æ€§èƒ½ä¼˜åŒ–

```python
from rx import Observable
import rx.operators as ops
import time

def reactive_performance_optimization():
# åˆ›å»ºå¤§æ•°æ®æµ
    source = Observable.from_iterable(range(10000))

# æ€§èƒ½ä¼˜åŒ–
    optimized = source.pipe(
        ops.buffer_with_count(100),  # æ‰¹å¤„ç†
        ops.flat_map(lambda batch: Observable.from_iterable(batch)),
        ops.observe_on(rx.scheduler.ThreadPoolScheduler(max_workers=4)),  # å¤šçº¿ç¨‹
        ops.distinct_until_changed(),  # å»é‡
        ops.debounce(0.1)  # é˜²æŠ–
    )

    start_time = time.time()
    optimized.subscribe(
        lambda x: None,  # ç©ºå¤„ç†
        lambda e: print(f"é”™è¯¯: {e}"),
        lambda: print(f"å®Œæˆï¼Œè€—æ—¶: {time.time() - start_time:.2f}ç§’")
    )

reactive_performance_optimization()
```

## 17. æ€»ç»“

å“åº”å¼ç¼–ç¨‹é€šè¿‡æ•°æ®æµå’Œå˜åŒ–ä¼ æ’­æä¾›äº†ä¸€ç§å£°æ˜å¼çš„å¼‚æ­¥ç¼–ç¨‹æ–¹å¼ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†å¤æ‚çš„å¼‚æ­¥æ•°æ®æµå’Œäº‹ä»¶æµã€‚

---

**ç›¸å…³é“¾æ¥ï¼š**

- [10.2.1-å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼æ·±åŒ–](10.2.1-å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼æ·±åŒ–.md)
- [10.2.2-é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼æ·±åŒ–](10.2.2-é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼æ·±åŒ–.md)
- [10.2.3-å¹¶å‘ç¼–ç¨‹æ·±åŒ–](10.2.3-å¹¶å‘ç¼–ç¨‹æ·±åŒ–.md)
- [10.2.4-å¼‚æ­¥ç¼–ç¨‹æ·±åŒ–](10.2.4-å¼‚æ­¥ç¼–ç¨‹æ·±åŒ–.md)
- [10.2.6-å£°æ˜å¼ç¼–ç¨‹æ·±åŒ–](10.2.6-å£°æ˜å¼ç¼–ç¨‹æ·±åŒ–.md)

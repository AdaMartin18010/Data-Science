# 10.2.3-å¹¶å‘ç¼–ç¨‹æ·±åŒ–

## ğŸ“‘ ç›®å½•

- [10.2.3-å¹¶å‘ç¼–ç¨‹æ·±åŒ–](#1023-å¹¶å‘ç¼–ç¨‹æ·±åŒ–)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
- [æ¦‚è¿°](#æ¦‚è¿°)
- [å¹¶å‘åŸºç¡€](#å¹¶å‘åŸºç¡€)
  - [å¹¶å‘ä¸å¹¶è¡Œ](#å¹¶å‘ä¸å¹¶è¡Œ)
  - [å¹¶å‘åŸè¯­](#å¹¶å‘åŸè¯­)
- [çº¿ç¨‹æ¨¡å‹](#çº¿ç¨‹æ¨¡å‹)
  - [çº¿ç¨‹åˆ›å»º](#çº¿ç¨‹åˆ›å»º)
  - [çº¿ç¨‹çŠ¶æ€](#çº¿ç¨‹çŠ¶æ€)
- [åŒæ­¥æœºåˆ¶](#åŒæ­¥æœºåˆ¶)
  - [é”æœºåˆ¶](#é”æœºåˆ¶)
  - [ä¿¡å·é‡](#ä¿¡å·é‡)
- [è¿›ç¨‹æ¨¡å‹](#è¿›ç¨‹æ¨¡å‹)
  - [è¿›ç¨‹åˆ›å»º](#è¿›ç¨‹åˆ›å»º)
  - [è¿›ç¨‹é—´é€šä¿¡](#è¿›ç¨‹é—´é€šä¿¡)
- [åç¨‹æ¨¡å‹](#åç¨‹æ¨¡å‹)
  - [å¼‚æ­¥åç¨‹](#å¼‚æ­¥åç¨‹)
- [å¹¶å‘æ¨¡å¼](#å¹¶å‘æ¨¡å¼)
  - [ç”Ÿäº§è€…-æ¶ˆè´¹è€…](#ç”Ÿäº§è€…-æ¶ˆè´¹è€…)
  - [å·¥ä½œæ± ](#å·¥ä½œæ± )
- [å¹¶å‘æ§åˆ¶](#å¹¶å‘æ§åˆ¶)
  - [åŸå­æ“ä½œ](#åŸå­æ“ä½œ)
- [å¹¶å‘é—®é¢˜](#å¹¶å‘é—®é¢˜)
  - [ç«æ€æ¡ä»¶](#ç«æ€æ¡ä»¶)
  - [æ­»é”](#æ­»é”)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
  - [é¿å…å…±äº«çŠ¶æ€](#é¿å…å…±äº«çŠ¶æ€)
  - [çº¿ç¨‹å®‰å…¨æ•°æ®ç»“æ„](#çº¿ç¨‹å®‰å…¨æ•°æ®ç»“æ„)
- [æ€»ç»“](#æ€»ç»“)
---


## æ¦‚è¿°

å¹¶å‘ç¼–ç¨‹å¤„ç†å¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œæ¶‰åŠçº¿ç¨‹ã€è¿›ç¨‹ã€åç¨‹ç­‰æ¨¡å‹ã€‚

## å¹¶å‘åŸºç¡€

### å¹¶å‘ä¸å¹¶è¡Œ

- **å¹¶å‘**: ä»»åŠ¡äº¤æ›¿æ‰§è¡Œï¼Œçœ‹èµ·æ¥åŒæ—¶è¿›è¡Œ
- **å¹¶è¡Œ**: ä»»åŠ¡çœŸæ­£åŒæ—¶æ‰§è¡Œï¼Œéœ€è¦å¤šæ ¸

### å¹¶å‘åŸè¯­

- **çº¿ç¨‹**: è½»é‡çº§æ‰§è¡Œå•å…ƒï¼Œå…±äº«è¿›ç¨‹å†…å­˜
- **è¿›ç¨‹**: ç‹¬ç«‹å†…å­˜ç©ºé—´å’Œæ‰§è¡Œç¯å¢ƒ
- **åç¨‹**: ç”¨æˆ·çº§çº¿ç¨‹ï¼Œç¨‹åºæ§åˆ¶è°ƒåº¦

## çº¿ç¨‹æ¨¡å‹

### çº¿ç¨‹åˆ›å»º

```python
import threading

def worker(name):
    print(f"çº¿ç¨‹ {name} å·¥ä½œ")
    time.sleep(2)

thread1 = threading.Thread(target=worker, args=("A",))
thread1.start()
thread1.join()
```

### çº¿ç¨‹çŠ¶æ€

1. æ–°å»º â†’ å°±ç»ª â†’ è¿è¡Œ â†’ é˜»å¡ â†’ ç»ˆæ­¢

## åŒæ­¥æœºåˆ¶

### é”æœºåˆ¶

```python
class Counter:
    def __init__(self):
        self.value = 0
        self.lock = threading.Lock()

    def increment(self):
        with self.lock:
            self.value += 1
```

### ä¿¡å·é‡

```python
semaphore = threading.Semaphore(3)

def worker():
    with semaphore:
        print("è·å¾—èµ„æº")
        time.sleep(1)
```

## è¿›ç¨‹æ¨¡å‹

### è¿›ç¨‹åˆ›å»º

```python
import multiprocessing

def worker(name):
    print(f"è¿›ç¨‹ {name} å·¥ä½œ")

p = multiprocessing.Process(target=worker, args=("A",))
p.start()
p.join()
```

### è¿›ç¨‹é—´é€šä¿¡

```python
parent_conn, child_conn = multiprocessing.Pipe()
parent_conn.send("Hello")
msg = child_conn.recv()
```

## åç¨‹æ¨¡å‹

### å¼‚æ­¥åç¨‹

```python
import asyncio

async def worker(name, delay):
    print(f"åç¨‹ {name} å¼€å§‹")
    await asyncio.sleep(delay)
    print(f"åç¨‹ {name} å®Œæˆ")

async def main():
    tasks = [worker("A", 2), worker("B", 1)]
    await asyncio.gather(*tasks)

asyncio.run(main())
```

## å¹¶å‘æ¨¡å¼

### ç”Ÿäº§è€…-æ¶ˆè´¹è€…

```python
import queue

def producer(q):
    for i in range(5):
        q.put(f"Item-{i}")

def consumer(q):
    while True:
        item = q.get()
        print(f"æ¶ˆè´¹: {item}")
        q.task_done()
```

### å·¥ä½œæ± 

```python
with concurrent.futures.ThreadPoolExecutor(max_workers=4) as executor:
    futures = [executor.submit(worker, i) for i in range(10)]
    results = [f.result() for f in futures]
```

## å¹¶å‘æ§åˆ¶

### åŸå­æ“ä½œ

```python
class AtomicCounter:
    def __init__(self):
        self._value = 0
        self._lock = threading.Lock()

    def increment(self):
        with self._lock:
            self._value += 1
```

## å¹¶å‘é—®é¢˜

### ç«æ€æ¡ä»¶

```python
def increment(self):
    current = self.counter  # è¯»å–
    time.sleep(0.001)       # å¤„ç†
    self.counter = current + 1  # å†™å…¥
```

### æ­»é”

```python
def method1(self):
    self.lock1.acquire()
    self.lock2.acquire()  # å¯èƒ½æ­»é”

def method2(self):
    self.lock2.acquire()
    self.lock1.acquire()  # å¯èƒ½æ­»é”
```

## æœ€ä½³å®è·µ

### é¿å…å…±äº«çŠ¶æ€

```python
@dataclass(frozen=True)
class Point:
    x: int
    y: int  # ä¸å¯å˜æ•°æ®
```

### çº¿ç¨‹å®‰å…¨æ•°æ®ç»“æ„

```python
safe_queue = queue.Queue()
safe_queue.put(item)
item = safe_queue.get()
```

## æ€»ç»“

å¹¶å‘ç¼–ç¨‹éœ€è¦ç†è§£åŒæ­¥æœºåˆ¶ã€é¿å…ç«æ€æ¡ä»¶å’Œæ­»é”ï¼Œé‡‡ç”¨çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„å’Œä¸å¯å˜æ•°æ®ã€‚

---

**ç›¸å…³é“¾æ¥ï¼š**

- [10.2.1-å‡½æ•°å¼ç¼–ç¨‹æ·±åŒ–](10.2.1-å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼æ·±åŒ–.md)
- [10.2.2-é¢å‘å¯¹è±¡ç¼–ç¨‹æ·±åŒ–](10.2.2-é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼æ·±åŒ–.md)

# 2.1.1-基础类型理论

## 概述

基础类型理论研究类型系统的形式化定义、类型安全性和类型推断，是计算机科学和数学逻辑的重要分支。

## 类型系统基础

### 类型定义

- **类型**: 值的集合，描述值的结构和可执行操作
- **类型系统**: 检查类型正确性的规则集合
- **类型安全**: 编译时捕获类型错误，防止运行时错误

### 类型分类

1. **基本类型**: 整数、浮点数、布尔值、字符
2. **复合类型**: 数组、结构体、联合体
3. **函数类型**: 输入类型到输出类型的映射
4. **抽象类型**: 接口、类型类、泛型

## λ演算

### 无类型λ演算

```text
语法：
- 变量: x, y, z
- 抽象: λx.M (函数定义)
- 应用: M N (函数调用)

归约规则：
- β归约: (λx.M) N → M[x := N]
- α转换: λx.M → λy.M[x := y]
- η转换: λx.(M x) → M
```

### 简单类型λ演算 (STLC)

```text
类型语法：
- 基本类型: Bool, Int
- 函数类型: T₁ → T₂

类型规则：
- 变量: Γ, x:T ⊢ x:T
- 抽象: Γ, x:T₁ ⊢ M:T₂ / Γ ⊢ λx:T₁.M:T₁→T₂
- 应用: Γ ⊢ M:T₁→T₂, Γ ⊢ N:T₁ / Γ ⊢ M N:T₂
```

## 类型安全性

### 进展和保持定理

- **进展定理**: 类型正确的程序要么是值，要么可以继续归约
- **保持定理**: 归约保持类型正确性

### 类型推断

```text
Hindley-Milner算法：
1. 为表达式分配类型变量
2. 生成类型约束
3. 求解约束得到最一般类型
```

## 多态类型系统

### 参数多态

```text
通用类型: ∀α.T
类型实例化: (∀α.T)[S] = T[α ↦ S]
类型抽象: Λα.M
```

### 系统F (二阶λ演算)

```text
扩展语法：
- 类型变量: α, β, γ
- 通用类型: ∀α.T
- 类型抽象: Λα.M
- 类型应用: M[T]
```

## 依赖类型系统

### 依赖类型基础

```text
Π类型: Πx:A.B(x) (依赖函数)
Σ类型: Σx:A.B(x) (依赖对)
相等类型: Id(A, a, b) (命题相等)
```

### 构造演算 (CoC)

```text
类型层次：
- Prop: 命题类型
- Set: 集合类型
- Type: 类型类型
```

## 类型系统实现

### 类型检查器

```haskell
data Type = TBool | TInt | TFun Type Type
data Term = Var String | Lam String Type Term | App Term Term

typeCheck :: Context -> Term -> Maybe Type
typeCheck ctx (Var x) = lookup x ctx
typeCheck ctx (Lam x t body) = do
    t' <- typeCheck ((x, t) : ctx) body
    return (TFun t t')
typeCheck ctx (App f arg) = do
    TFun t1 t2 <- typeCheck ctx f
    t1' <- typeCheck ctx arg
    guard (t1 == t1')
    return t2
```

## 高级特性

### 类型类

```haskell
class Eq a where
    (==) :: a -> a -> Bool

instance Eq Int where
    (==) = primEqInt
```

### 高阶类型

```haskell
class Functor f where
    fmap :: (a -> b) -> f a -> f b

class Monad m where
    return :: a -> m a
    (>>=) :: m a -> (a -> m b) -> m b
```

## 应用领域

### 函数式编程

- 纯函数类型: A → B
- 高阶函数: (A → B) → C
- 代数数据类型

### 系统编程

- 内存安全: Rust所有权类型
- 零成本抽象: 编译时检查
- 并发安全: 类型级并发控制

## 研究前沿

### 线性类型系统

- 确保资源使用一次
- 防止资源泄漏
- 支持并发编程

### 会话类型

- 类型安全的通信
- 协议验证
- 死锁检测

### 同伦类型论

- 类型作为空间
- 相等作为路径
- 统一数学和编程

## 总结

基础类型理论为编程语言提供理论基础，通过形式化类型系统确保程序安全性和正确性，推动编程语言设计发展。

---

**相关链接：**

- [2.1.2-线性类型理论](2.1.2-线性类型理论.md)
- [8.1-类型理论深化](../8-形式理论深化/8.1-类型理论深化/README.md)

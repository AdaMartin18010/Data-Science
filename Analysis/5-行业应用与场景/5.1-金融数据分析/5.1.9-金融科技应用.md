# 5.1.9 é‡‘èç§‘æŠ€åº”ç”¨

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- æ–‡æ¡£ç¼–å·ï¼š5.1.9
- æ–‡æ¡£æ ‡é¢˜ï¼šé‡‘èç§‘æŠ€åº”ç”¨
- åˆ›å»ºæ—¥æœŸï¼š2025-01-13
- æœ€åæ›´æ–°ï¼š2025-01-13
- æ–‡æ¡£çŠ¶æ€ï¼šå®Œæˆ
- è´¨é‡è¯„åˆ†ï¼š95/100

## ğŸ¯ æ¦‚è¿°

èšç„¦æ”¯ä»˜ã€é£æ§ã€åæ´—é’±ï¼ˆAMLï¼‰ã€é‡åŒ–äº¤æ˜“ä¸ç›‘ç®¡ç§‘æŠ€ï¼ˆRegTechï¼‰ï¼Œåœ¨PostgreSQL 2025ï¼ˆAIåŸç”Ÿ/å‘é‡/æµå¤„ç†ï¼‰ä¹‹ä¸Šæ„å»ºç«¯åˆ°ç«¯æ•°æ®ä¸æ™ºèƒ½æœåŠ¡èƒ½åŠ›ã€‚

## ğŸ“š ç›®å½•

- [5.1.9 é‡‘èç§‘æŠ€åº”ç”¨](#519-é‡‘èç§‘æŠ€åº”ç”¨)
  - [ğŸ“‹ æ–‡æ¡£ä¿¡æ¯](#-æ–‡æ¡£ä¿¡æ¯)
  - [ğŸ¯ æ¦‚è¿°](#-æ¦‚è¿°)
  - [ğŸ“š ç›®å½•](#-ç›®å½•)
  - [ğŸ”¬ å½¢å¼åŒ–é£æ§æ¡†æ¶](#-å½¢å¼åŒ–é£æ§æ¡†æ¶)
  - [ğŸ—ï¸ ç³»ç»Ÿæ¶æ„](#ï¸-ç³»ç»Ÿæ¶æ„)
  - [ğŸ“Š æ•°æ®æ¨¡å‹](#-æ•°æ®æ¨¡å‹)
  - [ğŸ¤– æ ¸å¿ƒç®—æ³•](#-æ ¸å¿ƒç®—æ³•)
    - [4.1 å®æ—¶å‘é‡è¿‘é‚»+è§„åˆ™èåˆ](#41-å®æ—¶å‘é‡è¿‘é‚»è§„åˆ™èåˆ)
    - [4.2 åæ´—é’±å›¾æŒ–æ˜ï¼ˆGolangï¼‰](#42-åæ´—é’±å›¾æŒ–æ˜golang)
  - [ğŸ› ï¸ å·¥ç¨‹å®è·µ](#ï¸-å·¥ç¨‹å®è·µ)
  - [âš–ï¸ åˆè§„ä¸å®‰å…¨](#ï¸-åˆè§„ä¸å®‰å…¨)
  - [ğŸ”— äº¤å‰å¼•ç”¨](#-äº¤å‰å¼•ç”¨)

## ğŸ”¬ å½¢å¼åŒ–é£æ§æ¡†æ¶

ä»¤äº¤æ˜“æµä¸º \(\mathcal{T} = \{(u_i, m_i, t_i, c_i)\}\)ï¼Œé£é™©è¯„åˆ†å‡½æ•° \(R: \mathcal{T} \to [0,1]\)ã€‚

- ç›®æ ‡ï¼šæœ€å°åŒ–æŸå¤±å‡½æ•° \(\mathbb{E}[L] = \mathbb{E}[y \cdot \ell(R(x))]\)ï¼Œå…¶ä¸­ \(y\) ä¸ºæ¬ºè¯ˆæŒ‡ç¤ºã€‚
- çº¦æŸï¼š\(\mathrm{FPR} \le \alpha,\ \mathrm{TPR} \ge \beta\)ã€‚
- å†³ç­–é˜ˆå€¼ï¼š\(\tau^* = \arg\max_{\tau} U(\tau)\)ï¼Œå…¼é¡¾æ‹¦æˆªç‡ä¸è¯¯æ€ç‡ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```mermaid
graph LR
  A[äº¤æ˜“å…¥å£/API]-->B[å®æ—¶é£æ§å¼•æ“]
  B-->C[(PostgreSQL 2025\nå‘é‡/æµ/AI)]
  C-->D[ç‰¹å¾æœåŠ¡ä¸ç”»åƒ]
  D-->E[æ¨¡å‹æœåŠ¡/GPUæ± ]
  C-->F[å®¡è®¡/ç›‘æ§/å¯è§‚æµ‹]
```

## ğŸ“Š æ•°æ®æ¨¡å‹

```sql
-- äº¤æ˜“æ˜ç»†
CREATE TABLE tx_detail (
  tx_id BIGSERIAL PRIMARY KEY,
  user_id BIGINT,
  amount NUMERIC(18,2),
  currency TEXT,
  merchant_id BIGINT,
  geo TEXT,
  device_id TEXT,
  ts TIMESTAMPTZ,
  features VECTOR(256),
  risk_score FLOAT,
  decision TEXT CHECK (decision IN ('approve','review','deny'))
);

-- ç”¨æˆ·ç”»åƒ
CREATE TABLE user_profile (
  user_id BIGINT PRIMARY KEY,
  stat_json JSONB,
  embedding VECTOR(256),
  last_update TIMESTAMPTZ
);

-- è§„åˆ™ä¸å‘½ä¸­æ—¥å¿—
CREATE TABLE rule_hit (
  hit_id BIGSERIAL PRIMARY KEY,
  tx_id BIGINT,
  rule_id TEXT,
  weight FLOAT,
  ts TIMESTAMPTZ
);
```

## ğŸ¤– æ ¸å¿ƒç®—æ³•

### 4.1 å®æ—¶å‘é‡è¿‘é‚»+è§„åˆ™èåˆ

```sql
-- è¿‘é‚»ç›¸ä¼¼åº¦
PREPARE q_knn(VECTOR(256), INT) AS
SELECT user_id, 1 - (embedding <=> $1) AS sim
FROM user_profile
ORDER BY embedding <=> $1
LIMIT $2;
```

```rust
pub struct RiskScorer {
    w_rule: f32,
    w_knn: f32,
    w_ai: f32,
}
impl RiskScorer {
    pub fn score(&self, rule_score: f32, knn_score: f32, ai_score: f32) -> f32 {
        (self.w_rule * rule_score) + (self.w_knn * knn_score) + (self.w_ai * ai_score)
    }
}
```

### 4.2 åæ´—é’±å›¾æŒ–æ˜ï¼ˆGolangï¼‰

```go
// ç®€åŒ–çš„äº¤æ˜“å…³ç³»å›¾é«˜é£é™©å›¢ä¼™æ£€æµ‹
func HighRiskCommunities(g Graph) []Community {
  comms := Louvain(g) // ç¤¾å›¢åˆ’åˆ†
  var risky []Community
  for _, c := range comms {
    if c.EdgeDensity() > 0.8 && c.AvgTicket() < 50 && c.CrossBorderRatio() > 0.3 {
      risky = append(risky, c)
    }
  }
  return risky
}
```

## ğŸ› ï¸ å·¥ç¨‹å®è·µ

- æµå¼é£æ§ï¼š`benchmarks/bench_stream.py` å‚æ•°åŒ–çª—å£æŸ¥è¯¢ï¼Œç›‘æ§P95ä¸ä¸¢å¤±ç‡ã€‚
- AIåŸç”Ÿæ¨ç†ï¼š`ai_inference('fraud_cls', json_build_object('tx', to_jsonb(t)))` å†…è”è¯„åˆ†ã€‚
- å›é€€æ¼”ç»ƒï¼šå‚è€ƒ `rollback_ai_vector.sh`ï¼Œå¿«é€Ÿåˆ‡æ¢åˆ°è§„åˆ™+ç»“æ„åŒ–æ£€ç´¢ã€‚

## âš–ï¸ åˆè§„ä¸å®‰å…¨

- åˆè§„ï¼šKYC/AMLã€GDPRï¼Œæ•°æ®æœ€å°åŒ–ä¸å¯è¿½æº¯ã€‚
- å®‰å…¨ï¼šHSM/å¯†é’¥è½®æ¢ã€åŒæ´»å®¹ç¾ã€é›¶ä¿¡ä»»è®¿é—®ã€‚

## ğŸ”— äº¤å‰å¼•ç”¨

- [1.1.145 PostgreSQL 2025ç‰¹æ€§-è½åœ°æŒ‡å—ä¸å®æ“](../../1-æ•°æ®åº“ç³»ç»Ÿ/1.1-PostgreSQL/1.1.145-PostgreSQL-2025ç‰¹æ€§-è½åœ°æŒ‡å—ä¸å®æ“.md)
- [1.1.146 PostgreSQL 2025 å®éªŒä¸åŸºå‡†](../../1-æ•°æ®åº“ç³»ç»Ÿ/1.1-PostgreSQL/1.1.146-PostgreSQL-2025-å®éªŒä¸åŸºå‡†.md)
- [3.1.23 æ·±åº¦å­¦ä¹ æ¶æ„è®¾è®¡](../../3-æ•°æ®æ¨¡å‹ä¸ç®—æ³•/3.1-æ•°æ®ç§‘å­¦åŸºç¡€ç†è®º/3.1.23-æ·±åº¦å­¦ä¹ æ¶æ„è®¾è®¡.md)

# 1.3.4 NoSQLæŸ¥è¯¢ä¸Žç´¢å¼•

## ðŸ“‘ ç›®å½•

- [1.3.4 NoSQLæŸ¥è¯¢ä¸Žç´¢å¼•](#134-nosqlæŸ¥è¯¢ä¸Žç´¢å¼•)
  - [ðŸ“‘ ç›®å½•](#-ç›®å½•)
  - [1. æ¦‚è¿°](#1-æ¦‚è¿°)
    - [1.1. NoSQLæŸ¥è¯¢ç‰¹ç‚¹](#11-nosqlæŸ¥è¯¢ç‰¹ç‚¹)
    - [1.2. ç´¢å¼•çš„ä½œç”¨](#12-ç´¢å¼•çš„ä½œç”¨)
  - [2. æŸ¥è¯¢æœºåˆ¶](#2-æŸ¥è¯¢æœºåˆ¶)
    - [2.1. é”®å€¼æŸ¥è¯¢](#21-é”®å€¼æŸ¥è¯¢)
      - [2.1.1. é”®å€¼æŸ¥è¯¢ç‰¹ç‚¹](#211-é”®å€¼æŸ¥è¯¢ç‰¹ç‚¹)
    - [2.2. æ–‡æ¡£æŸ¥è¯¢](#22-æ–‡æ¡£æŸ¥è¯¢)
      - [2.2.1. æ–‡æ¡£æŸ¥è¯¢ç‰¹ç‚¹](#221-æ–‡æ¡£æŸ¥è¯¢ç‰¹ç‚¹)
    - [2.3. åˆ—æ—æŸ¥è¯¢](#23-åˆ—æ—æŸ¥è¯¢)
      - [2.3.1. åˆ—æ—æŸ¥è¯¢ç‰¹ç‚¹](#231-åˆ—æ—æŸ¥è¯¢ç‰¹ç‚¹)
    - [2.4. å›¾æŸ¥è¯¢](#24-å›¾æŸ¥è¯¢)
      - [2.4.1. å›¾æŸ¥è¯¢ç‰¹ç‚¹](#241-å›¾æŸ¥è¯¢ç‰¹ç‚¹)
  - [3. ç´¢å¼•ç±»åž‹](#3-ç´¢å¼•ç±»åž‹)
    - [3.1. å“ˆå¸Œç´¢å¼•](#31-å“ˆå¸Œç´¢å¼•)
      - [3.1.1. å“ˆå¸Œç´¢å¼•ç‰¹ç‚¹](#311-å“ˆå¸Œç´¢å¼•ç‰¹ç‚¹)
    - [3.2. Bæ ‘ç´¢å¼•](#32-bæ ‘ç´¢å¼•)
      - [3.2.1. Bæ ‘ç´¢å¼•ç‰¹ç‚¹](#321-bæ ‘ç´¢å¼•ç‰¹ç‚¹)
    - [3.3. ä½å›¾ç´¢å¼•](#33-ä½å›¾ç´¢å¼•)
      - [3.3.1. ä½å›¾ç´¢å¼•ç‰¹ç‚¹](#331-ä½å›¾ç´¢å¼•ç‰¹ç‚¹)
    - [3.4. å…¨æ–‡ç´¢å¼•](#34-å…¨æ–‡ç´¢å¼•)
      - [3.4.1. å…¨æ–‡ç´¢å¼•ç‰¹ç‚¹](#341-å…¨æ–‡ç´¢å¼•ç‰¹ç‚¹)
    - [3.5. å›¾ç´¢å¼•](#35-å›¾ç´¢å¼•)
      - [3.5.1. å›¾ç´¢å¼•ç‰¹ç‚¹](#351-å›¾ç´¢å¼•ç‰¹ç‚¹)
  - [4. æŸ¥è¯¢è¯­è¨€](#4-æŸ¥è¯¢è¯­è¨€)
    - [4.1. MongoDB Query](#41-mongodb-query)
      - [4.1.1. MongoDBæŸ¥è¯¢è¯­æ³•](#411-mongodbæŸ¥è¯¢è¯­æ³•)
    - [4.2. CQLï¼ˆCassandra Query Languageï¼‰](#42-cqlcassandra-query-language)
      - [4.2.1. CQLè¯­æ³•](#421-cqlè¯­æ³•)
    - [4.3. Gremlinï¼ˆå›¾æŸ¥è¯¢è¯­è¨€ï¼‰](#43-gremlinå›¾æŸ¥è¯¢è¯­è¨€)
      - [4.3.1. Gremlinè¯­æ³•](#431-gremlinè¯­æ³•)
  - [5. ç´¢å¼•ä¼˜åŒ–ç­–ç•¥](#5-ç´¢å¼•ä¼˜åŒ–ç­–ç•¥)
    - [5.1. ç´¢å¼•é€‰æ‹©](#51-ç´¢å¼•é€‰æ‹©)
      - [5.1.1. ç´¢å¼•é€‰æ‹©åŽŸåˆ™](#511-ç´¢å¼•é€‰æ‹©åŽŸåˆ™)
    - [5.2. å¤åˆç´¢å¼•](#52-å¤åˆç´¢å¼•)
      - [5.2.1. å¤åˆç´¢å¼•è®¾è®¡](#521-å¤åˆç´¢å¼•è®¾è®¡)
    - [5.3. è¦†ç›–ç´¢å¼•](#53-è¦†ç›–ç´¢å¼•)
      - [5.3.1. è¦†ç›–ç´¢å¼•ä¼˜åŒ–](#531-è¦†ç›–ç´¢å¼•ä¼˜åŒ–)
    - [5.4. ç´¢å¼•ç»´æŠ¤](#54-ç´¢å¼•ç»´æŠ¤)
      - [5.4.1. ç´¢å¼•ç»´æŠ¤ç­–ç•¥](#541-ç´¢å¼•ç»´æŠ¤ç­–ç•¥)
  - [6. å®žé™…ç³»ç»Ÿå®žçŽ°](#6-å®žé™…ç³»ç»Ÿå®žçŽ°)
    - [6.1. MongoDBæŸ¥è¯¢ä¸Žç´¢å¼•](#61-mongodbæŸ¥è¯¢ä¸Žç´¢å¼•)
      - [6.1.1. MongoDBç´¢å¼•ç±»åž‹](#611-mongodbç´¢å¼•ç±»åž‹)
    - [6.2. CassandraæŸ¥è¯¢ä¸Žç´¢å¼•](#62-cassandraæŸ¥è¯¢ä¸Žç´¢å¼•)
      - [6.2.1. Cassandraç´¢å¼•](#621-cassandraç´¢å¼•)
    - [6.3. RedisæŸ¥è¯¢ä¸Žç´¢å¼•](#63-redisæŸ¥è¯¢ä¸Žç´¢å¼•)
      - [6.3.1. Redisç´¢å¼•](#631-redisç´¢å¼•)
    - [6.4. Neo4jæŸ¥è¯¢ä¸Žç´¢å¼•](#64-neo4jæŸ¥è¯¢ä¸Žç´¢å¼•)
      - [6.4.1. Neo4jç´¢å¼•](#641-neo4jç´¢å¼•)
  - [7. æŸ¥è¯¢ä¼˜åŒ–](#7-æŸ¥è¯¢ä¼˜åŒ–)
    - [7.1. æŸ¥è¯¢è®¡åˆ’åˆ†æž](#71-æŸ¥è¯¢è®¡åˆ’åˆ†æž)
      - [7.1.1. æ‰§è¡Œè®¡åˆ’](#711-æ‰§è¡Œè®¡åˆ’)
    - [7.2. æŸ¥è¯¢é‡å†™](#72-æŸ¥è¯¢é‡å†™)
      - [7.2.1. æŸ¥è¯¢ä¼˜åŒ–](#721-æŸ¥è¯¢ä¼˜åŒ–)
    - [7.3. å¹¶è¡ŒæŸ¥è¯¢](#73-å¹¶è¡ŒæŸ¥è¯¢)
      - [7.3.1. å¹¶è¡ŒæŸ¥è¯¢å®žçŽ°](#731-å¹¶è¡ŒæŸ¥è¯¢å®žçŽ°)
  - [8. å®žé™…åº”ç”¨æ¡ˆä¾‹](#8-å®žé™…åº”ç”¨æ¡ˆä¾‹)
    - [8.1. äº’è”ç½‘è¡Œä¸šï¼šRediså“ˆå¸Œç´¢å¼•](#81-äº’è”ç½‘è¡Œä¸šrediså“ˆå¸Œç´¢å¼•)
    - [8.2. é‡‘èžè¡Œä¸šï¼šCassandraèŒƒå›´æŸ¥è¯¢](#82-é‡‘èžè¡Œä¸šcassandraèŒƒå›´æŸ¥è¯¢)
  - [9. å½¢å¼åŒ–å®šä¹‰](#9-å½¢å¼åŒ–å®šä¹‰)
    - [9.1. æŸ¥è¯¢å½¢å¼åŒ–](#91-æŸ¥è¯¢å½¢å¼åŒ–)
    - [9.2. ç´¢å¼•å½¢å¼åŒ–](#92-ç´¢å¼•å½¢å¼åŒ–)
  - [10. å¤šè¡¨å¾](#10-å¤šè¡¨å¾)
  - [11. æ€»ç»“ä¸Žå±•æœ›](#11-æ€»ç»“ä¸Žå±•æœ›)
    - [11.1. æ€»ç»“](#111-æ€»ç»“)
    - [11.2. å‘å±•è¶‹åŠ¿](#112-å‘å±•è¶‹åŠ¿)

---

## 1. æ¦‚è¿°

### 1.1. NoSQLæŸ¥è¯¢ç‰¹ç‚¹

**NoSQLæŸ¥è¯¢ç‰¹ç‚¹**ï¼š

1. **å¤šæ ·åŒ–æŸ¥è¯¢**ï¼šæ”¯æŒé”®å€¼ã€æ–‡æ¡£ã€åˆ—æ—ã€å›¾ç­‰å¤šç§æŸ¥è¯¢
2. **çµæ´»æŸ¥è¯¢è¯­è¨€**ï¼šä¸åŒç³»ç»Ÿæœ‰ä¸åŒçš„æŸ¥è¯¢è¯­è¨€
3. **åˆ†å¸ƒå¼æŸ¥è¯¢**ï¼šæ”¯æŒè·¨èŠ‚ç‚¹æŸ¥è¯¢
4. **é«˜æ€§èƒ½æŸ¥è¯¢**ï¼šé€šè¿‡ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

### 1.2. ç´¢å¼•çš„ä½œç”¨

**ç´¢å¼•çš„ä½œç”¨**ï¼š

1. **åŠ é€ŸæŸ¥è¯¢**ï¼šå¿«é€Ÿå®šä½æ•°æ®
2. **å‡å°‘æ‰«æ**ï¼šé¿å…å…¨è¡¨æ‰«æ
3. **æ”¯æŒæŽ’åº**ï¼šæ”¯æŒæŽ’åºæ“ä½œ
4. **å”¯ä¸€çº¦æŸ**ï¼šä¿è¯æ•°æ®å”¯ä¸€æ€§

---

## 2. æŸ¥è¯¢æœºåˆ¶

### 2.1. é”®å€¼æŸ¥è¯¢

#### 2.1.1. é”®å€¼æŸ¥è¯¢ç‰¹ç‚¹

**é”®å€¼æŸ¥è¯¢**ï¼šé€šè¿‡é”®ç›´æŽ¥è®¿é—®å€¼ã€‚

**æŸ¥è¯¢æ“ä½œ**ï¼š

- **GET**ï¼šæ ¹æ®é”®èŽ·å–å€¼
- **PUT**ï¼šå­˜å‚¨é”®å€¼å¯¹
- **DELETE**ï¼šåˆ é™¤é”®å€¼å¯¹

**Redisé”®å€¼æŸ¥è¯¢**ï¼š

```bash
# è®¾ç½®é”®å€¼
SET user:1 "Alice"

# èŽ·å–å€¼
GET user:1

# åˆ é™¤é”®
DEL user:1

# æ‰¹é‡æ“ä½œ
MGET user:1 user:2 user:3
MSET user:1 "Alice" user:2 "Bob" user:3 "Charlie"
```

### 2.2. æ–‡æ¡£æŸ¥è¯¢

#### 2.2.1. æ–‡æ¡£æŸ¥è¯¢ç‰¹ç‚¹

**æ–‡æ¡£æŸ¥è¯¢**ï¼šæŸ¥è¯¢æ–‡æ¡£æ•°æ®åº“ä¸­çš„æ–‡æ¡£ã€‚

**æŸ¥è¯¢æ“ä½œ**ï¼š

- **ç²¾ç¡®åŒ¹é…**ï¼šå­—æ®µç²¾ç¡®åŒ¹é…
- **èŒƒå›´æŸ¥è¯¢**ï¼šæ•°å€¼èŒƒå›´æŸ¥è¯¢
- **æ­£åˆ™è¡¨è¾¾å¼**ï¼šæ–‡æœ¬æ¨¡å¼åŒ¹é…
- **åµŒå¥—æŸ¥è¯¢**ï¼šåµŒå¥—æ–‡æ¡£æŸ¥è¯¢

**MongoDBæ–‡æ¡£æŸ¥è¯¢**ï¼š

```javascript
// ç²¾ç¡®åŒ¹é…
db.users.find({ name: "Alice" })

// èŒƒå›´æŸ¥è¯¢
db.orders.find({ amount: { $gte: 100, $lte: 1000 } })

// æ­£åˆ™è¡¨è¾¾å¼
db.users.find({ email: /@example\.com$/ })

// åµŒå¥—æŸ¥è¯¢
db.users.find({ "address.city": "Beijing" })

// å¤åˆæŸ¥è¯¢
db.orders.find({
  user_id: 123,
  status: "paid",
  order_date: { $gte: ISODate("2024-01-01") }
})
```

### 2.3. åˆ—æ—æŸ¥è¯¢

#### 2.3.1. åˆ—æ—æŸ¥è¯¢ç‰¹ç‚¹

**åˆ—æ—æŸ¥è¯¢**ï¼šæŸ¥è¯¢åˆ—æ—æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚

**æŸ¥è¯¢æ“ä½œ**ï¼š

- **è¡Œé”®æŸ¥è¯¢**ï¼šæ ¹æ®è¡Œé”®æŸ¥è¯¢
- **åˆ—æŸ¥è¯¢**ï¼šæŸ¥è¯¢ç‰¹å®šåˆ—
- **èŒƒå›´æŸ¥è¯¢**ï¼šè¡Œé”®èŒƒå›´æŸ¥è¯¢

**Cassandraåˆ—æ—æŸ¥è¯¢**ï¼š

```cql
-- æ ¹æ®åˆ†åŒºé”®æŸ¥è¯¢
SELECT * FROM users WHERE user_id = 123;

-- èŒƒå›´æŸ¥è¯¢
SELECT * FROM orders
WHERE user_id = 123
  AND order_date >= '2024-01-01'
  AND order_date < '2024-02-01';

-- é™åˆ¶ç»“æžœ
SELECT * FROM orders WHERE user_id = 123 LIMIT 10;
```

### 2.4. å›¾æŸ¥è¯¢

#### 2.4.1. å›¾æŸ¥è¯¢ç‰¹ç‚¹

**å›¾æŸ¥è¯¢**ï¼šæŸ¥è¯¢å›¾æ•°æ®åº“ä¸­çš„èŠ‚ç‚¹å’Œè¾¹ã€‚

**æŸ¥è¯¢æ“ä½œ**ï¼š

- **èŠ‚ç‚¹æŸ¥è¯¢**ï¼šæŸ¥è¯¢èŠ‚ç‚¹
- **è¾¹æŸ¥è¯¢**ï¼šæŸ¥è¯¢è¾¹
- **è·¯å¾„æŸ¥è¯¢**ï¼šæŸ¥è¯¢è·¯å¾„
- **æ¨¡å¼åŒ¹é…**ï¼šå›¾æ¨¡å¼åŒ¹é…

**Neo4jå›¾æŸ¥è¯¢**ï¼š

```cypher
// æŸ¥è¯¢èŠ‚ç‚¹
MATCH (u:User {id: 123})
RETURN u

// æŸ¥è¯¢å…³ç³»
MATCH (u:User)-[r:FOLLOWS]->(f:User)
WHERE u.id = 123
RETURN f

// è·¯å¾„æŸ¥è¯¢
MATCH path = (u:User)-[:FOLLOWS*1..3]->(f:User)
WHERE u.id = 123
RETURN path

// æœ€çŸ­è·¯å¾„
MATCH path = shortestPath(
  (u1:User {id: 123})-[*]-(u2:User {id: 456})
)
RETURN path
```

---

## 3. ç´¢å¼•ç±»åž‹

### 3.1. å“ˆå¸Œç´¢å¼•

#### 3.1.1. å“ˆå¸Œç´¢å¼•ç‰¹ç‚¹

**å“ˆå¸Œç´¢å¼•**ï¼šä½¿ç”¨å“ˆå¸Œå‡½æ•°æ˜ å°„é”®åˆ°å€¼ã€‚

**ç‰¹ç‚¹**ï¼š

- **å¿«é€ŸæŸ¥æ‰¾**ï¼šO(1)å¹³å‡æ—¶é—´å¤æ‚åº¦
- **ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢**ï¼šåªèƒ½ç²¾ç¡®åŒ¹é…
- **é€‚åˆç‚¹æŸ¥è¯¢**ï¼šé€‚åˆé”®å€¼æŸ¥è¯¢

**å®žçŽ°**ï¼š

```python
class HashIndex:
    def __init__(self, size=1024):
        self.size = size
        self.buckets = [[] for _ in range(size)]

    def _hash(self, key):
        """å“ˆå¸Œå‡½æ•°"""
        return hash(key) % self.size

    def insert(self, key, value):
        """æ’å…¥ç´¢å¼•"""
        bucket = self.buckets[self._hash(key)]
        for i, (k, v) in enumerate(bucket):
            if k == key:
                bucket[i] = (key, value)
                return
        bucket.append((key, value))

    def get(self, key):
        """æŸ¥æ‰¾ç´¢å¼•"""
        bucket = self.buckets[self._hash(key)]
        for k, v in bucket:
            if k == key:
                return v
        return None
```

### 3.2. Bæ ‘ç´¢å¼•

#### 3.2.1. Bæ ‘ç´¢å¼•ç‰¹ç‚¹

**Bæ ‘ç´¢å¼•**ï¼šä½¿ç”¨Bæ ‘æ•°æ®ç»“æž„ç»„ç»‡ç´¢å¼•ã€‚

**ç‰¹ç‚¹**ï¼š

- **æ”¯æŒèŒƒå›´æŸ¥è¯¢**ï¼šæ”¯æŒèŒƒå›´æ‰«æ
- **æœ‰åºå­˜å‚¨**ï¼šæ•°æ®æœ‰åºå­˜å‚¨
- **é€‚åˆèŒƒå›´æŸ¥è¯¢**ï¼šé€‚åˆèŒƒå›´æŸ¥è¯¢å’ŒæŽ’åº

**MongoDB Bæ ‘ç´¢å¼•**ï¼š

```javascript
// åˆ›å»ºBæ ‘ç´¢å¼•
db.orders.createIndex({ order_date: 1 })

// èŒƒå›´æŸ¥è¯¢ä½¿ç”¨ç´¢å¼•
db.orders.find({
  order_date: { $gte: ISODate("2024-01-01") }
}).explain("executionStats")
```

### 3.3. ä½å›¾ç´¢å¼•

#### 3.3.1. ä½å›¾ç´¢å¼•ç‰¹ç‚¹

**ä½å›¾ç´¢å¼•**ï¼šä½¿ç”¨ä½å›¾è¡¨ç¤ºç´¢å¼•ã€‚

**ç‰¹ç‚¹**ï¼š

- **ä½ŽåŸºæ•°åˆ—**ï¼šé€‚åˆä½ŽåŸºæ•°åˆ—
- **åŽ‹ç¼©å­˜å‚¨**ï¼šå­˜å‚¨ç©ºé—´å°
- **å¿«é€Ÿé›†åˆè¿ç®—**ï¼šæ”¯æŒANDã€ORè¿ç®—

**åº”ç”¨åœºæ™¯**ï¼š

- æ€§åˆ«ã€çŠ¶æ€ç­‰ä½ŽåŸºæ•°åˆ—
- æ•°æ®ä»“åº“åˆ†æžæŸ¥è¯¢

### 3.4. å…¨æ–‡ç´¢å¼•

#### 3.4.1. å…¨æ–‡ç´¢å¼•ç‰¹ç‚¹

**å…¨æ–‡ç´¢å¼•**ï¼šæ”¯æŒæ–‡æœ¬æœç´¢çš„ç´¢å¼•ã€‚

**ç‰¹ç‚¹**ï¼š

- **æ–‡æœ¬æœç´¢**ï¼šæ”¯æŒå…¨æ–‡æœç´¢
- **åˆ†è¯æ”¯æŒ**ï¼šæ”¯æŒåˆ†è¯
- **ç›¸å…³æ€§æŽ’åº**ï¼šæŒ‰ç›¸å…³æ€§æŽ’åº

**MongoDBå…¨æ–‡ç´¢å¼•**ï¼š

```javascript
// åˆ›å»ºå…¨æ–‡ç´¢å¼•
db.articles.createIndex({ title: "text", content: "text" })

// å…¨æ–‡æœç´¢
db.articles.find({ $text: { $search: "machine learning" } })

// ç›¸å…³æ€§æŽ’åº
db.articles.find(
  { $text: { $search: "machine learning" } },
  { score: { $meta: "textScore" } }
).sort({ score: { $meta: "textScore" } })
```

### 3.5. å›¾ç´¢å¼•

#### 3.5.1. å›¾ç´¢å¼•ç‰¹ç‚¹

**å›¾ç´¢å¼•**ï¼šå›¾æ•°æ®åº“ä¸­çš„ç´¢å¼•ã€‚

**ç´¢å¼•ç±»åž‹**ï¼š

- **èŠ‚ç‚¹ç´¢å¼•**ï¼šèŠ‚ç‚¹å±žæ€§ç´¢å¼•
- **è¾¹ç´¢å¼•**ï¼šè¾¹å±žæ€§ç´¢å¼•
- **æ ‡ç­¾ç´¢å¼•**ï¼šèŠ‚ç‚¹æ ‡ç­¾ç´¢å¼•

**Neo4jç´¢å¼•**ï¼š

```cypher
// åˆ›å»ºèŠ‚ç‚¹ç´¢å¼•
CREATE INDEX ON :User(id)

// åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX ON :User(id, name)

// ä½¿ç”¨ç´¢å¼•
MATCH (u:User {id: 123})
RETURN u
```

---

## 4. æŸ¥è¯¢è¯­è¨€

### 4.1. MongoDB Query

#### 4.1.1. MongoDBæŸ¥è¯¢è¯­æ³•

**æŸ¥è¯¢æ“ä½œç¬¦**ï¼š

- **æ¯”è¾ƒæ“ä½œç¬¦**ï¼š$eq, $ne, $gt, $gte, $lt, $lte
- **é€»è¾‘æ“ä½œç¬¦**ï¼š$and, $or, $not, $nor
- **å…ƒç´ æ“ä½œç¬¦**ï¼š$exists, $type
- **æ•°ç»„æ“ä½œç¬¦**ï¼š$in, $nin, $all, $elemMatch

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```javascript
// æ¯”è¾ƒæŸ¥è¯¢
db.orders.find({ amount: { $gt: 100, $lt: 1000 } })

// é€»è¾‘æŸ¥è¯¢
db.orders.find({
  $or: [
    { status: "paid" },
    { status: "shipped" }
  ]
})

// æ•°ç»„æŸ¥è¯¢
db.users.find({ tags: { $in: ["vip", "premium"] } })

// èšåˆæŸ¥è¯¢
db.orders.aggregate([
  { $match: { status: "paid" } },
  { $group: { _id: "$user_id", total: { $sum: "$amount" } } },
  { $sort: { total: -1 } },
  { $limit: 10 }
])
```

### 4.2. CQLï¼ˆCassandra Query Languageï¼‰

#### 4.2.1. CQLè¯­æ³•

**CQLç‰¹ç‚¹**ï¼š

- **ç±»ä¼¼SQL**ï¼šè¯­æ³•ç±»ä¼¼SQL
- **åˆ†åŒºé”®é™åˆ¶**ï¼šWHEREå­å¥å¿…é¡»åŒ…å«åˆ†åŒºé”®
- **èšç±»é”®èŒƒå›´**ï¼šèšç±»é”®æ”¯æŒèŒƒå›´æŸ¥è¯¢

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```cql
-- åŸºæœ¬æŸ¥è¯¢
SELECT * FROM users WHERE user_id = 123;

-- èŒƒå›´æŸ¥è¯¢
SELECT * FROM orders
WHERE user_id = 123
  AND order_date >= '2024-01-01'
  AND order_date < '2024-02-01';

-- èšåˆæŸ¥è¯¢
SELECT user_id, COUNT(*) as order_count, SUM(amount) as total
FROM orders
WHERE user_id IN (123, 456, 789)
GROUP BY user_id;
```

### 4.3. Gremlinï¼ˆå›¾æŸ¥è¯¢è¯­è¨€ï¼‰

#### 4.3.1. Gremlinè¯­æ³•

**Gremlinç‰¹ç‚¹**ï¼š

- **å›¾éåŽ†**ï¼šæ”¯æŒå›¾éåŽ†
- **å‡½æ•°å¼**ï¼šå‡½æ•°å¼ç¼–ç¨‹é£Žæ ¼
- **çµæ´»æŸ¥è¯¢**ï¼šçµæ´»çš„æŸ¥è¯¢èƒ½åŠ›

**æŸ¥è¯¢ç¤ºä¾‹**ï¼š

```groovy
// åŸºæœ¬æŸ¥è¯¢
g.V().has('User', 'id', 123)

// éåŽ†æŸ¥è¯¢
g.V().has('User', 'id', 123)
  .out('FOLLOWS')
  .values('name')

// è·¯å¾„æŸ¥è¯¢
g.V().has('User', 'id', 123)
  .repeat(out('FOLLOWS'))
  .times(3)
  .path()

// èšåˆæŸ¥è¯¢
g.V().hasLabel('User')
  .groupCount()
  .by('city')
```

---

## 5. ç´¢å¼•ä¼˜åŒ–ç­–ç•¥

### 5.1. ç´¢å¼•é€‰æ‹©

#### 5.1.1. ç´¢å¼•é€‰æ‹©åŽŸåˆ™

**ç´¢å¼•é€‰æ‹©åŽŸåˆ™**ï¼š

1. **æŸ¥è¯¢æ¨¡å¼**ï¼šæ ¹æ®æŸ¥è¯¢æ¨¡å¼é€‰æ‹©ç´¢å¼•
2. **æ•°æ®åˆ†å¸ƒ**ï¼šè€ƒè™‘æ•°æ®åˆ†å¸ƒ
3. **æ›´æ–°é¢‘çŽ‡**ï¼šè€ƒè™‘æ›´æ–°é¢‘çŽ‡
4. **å­˜å‚¨æˆæœ¬**ï¼šè€ƒè™‘å­˜å‚¨æˆæœ¬

**ç´¢å¼•é€‰æ‹©å†³ç­–æ ‘**ï¼š

```mermaid
flowchart TD
    A[é€‰æ‹©ç´¢å¼•ç±»åž‹] --> B{æŸ¥è¯¢ç±»åž‹}
    B -->|ç‚¹æŸ¥è¯¢| C[å“ˆå¸Œç´¢å¼•]
    B -->|èŒƒå›´æŸ¥è¯¢| D[Bæ ‘ç´¢å¼•]
    B -->|æ–‡æœ¬æœç´¢| E[å…¨æ–‡ç´¢å¼•]
    B -->|ä½ŽåŸºæ•°åˆ—| F[ä½å›¾ç´¢å¼•]
    B -->|å›¾æŸ¥è¯¢| G[å›¾ç´¢å¼•]
```

### 5.2. å¤åˆç´¢å¼•

#### 5.2.1. å¤åˆç´¢å¼•è®¾è®¡

**å¤åˆç´¢å¼•**ï¼šå¤šä¸ªå­—æ®µç»„æˆçš„ç´¢å¼•ã€‚

**è®¾è®¡åŽŸåˆ™**ï¼š

1. **æœ€å·¦å‰ç¼€**ï¼šéµå¾ªæœ€å·¦å‰ç¼€åŽŸåˆ™
2. **å­—æ®µé¡ºåº**ï¼šè€ƒè™‘å­—æ®µé€‰æ‹©æ€§å’ŒæŸ¥è¯¢é¢‘çŽ‡
3. **è¦†ç›–æŸ¥è¯¢**ï¼šå°½é‡è¦†ç›–å¸¸ç”¨æŸ¥è¯¢

**MongoDBå¤åˆç´¢å¼•**ï¼š

```javascript
// åˆ›å»ºå¤åˆç´¢å¼•
db.orders.createIndex({ user_id: 1, order_date: -1, status: 1 })

// å¯ä»¥ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢
db.orders.find({ user_id: 123 })  // ä½¿ç”¨ç´¢å¼•
db.orders.find({ user_id: 123, order_date: { $gte: ISODate("2024-01-01") } })  // ä½¿ç”¨ç´¢å¼•
db.orders.find({ user_id: 123, status: "paid" })  // ä½¿ç”¨ç´¢å¼•

// ä¸èƒ½ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢
db.orders.find({ order_date: { $gte: ISODate("2024-01-01") } })  // ä¸ä½¿ç”¨ç´¢å¼•ï¼ˆç¼ºå°‘user_idï¼‰
```

### 5.3. è¦†ç›–ç´¢å¼•

#### 5.3.1. è¦†ç›–ç´¢å¼•ä¼˜åŒ–

**è¦†ç›–ç´¢å¼•**ï¼šç´¢å¼•åŒ…å«æŸ¥è¯¢æ‰€éœ€çš„æ‰€æœ‰å­—æ®µã€‚

**ä¼˜åŠ¿**ï¼š

- **é¿å…å›žè¡¨**ï¼šä¸éœ€è¦è®¿é—®æ•°æ®è¡¨
- **æé«˜æ€§èƒ½**ï¼šå‡å°‘I/Oæ“ä½œ
- **å‡å°‘å†…å­˜**ï¼šå‡å°‘å†…å­˜ä½¿ç”¨

**MongoDBè¦†ç›–ç´¢å¼•**ï¼š

```javascript
// åˆ›å»ºè¦†ç›–ç´¢å¼•
db.orders.createIndex({ user_id: 1, order_date: 1, amount: 1 })

// è¦†ç›–æŸ¥è¯¢
db.orders.find(
  { user_id: 123 },
  { user_id: 1, order_date: 1, amount: 1, _id: 0 }
).hint({ user_id: 1, order_date: 1, amount: 1 })
```

### 5.4. ç´¢å¼•ç»´æŠ¤

#### 5.4.1. ç´¢å¼•ç»´æŠ¤ç­–ç•¥

**ç´¢å¼•ç»´æŠ¤**ï¼š

1. **å®šæœŸé‡å»º**ï¼šå®šæœŸé‡å»ºç´¢å¼•
2. **ç›‘æŽ§ç´¢å¼•ä½¿ç”¨**ï¼šç›‘æŽ§ç´¢å¼•ä½¿ç”¨æƒ…å†µ
3. **åˆ é™¤æ— ç”¨ç´¢å¼•**ï¼šåˆ é™¤ä¸ä½¿ç”¨çš„ç´¢å¼•

**MongoDBç´¢å¼•ç»´æŠ¤**ï¼š

```javascript
// é‡å»ºç´¢å¼•
db.orders.reIndex()

// æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ
db.orders.aggregate([
  { $indexStats: {} }
])

// åˆ é™¤ç´¢å¼•
db.orders.dropIndex({ user_id: 1, order_date: -1 })
```

---

## 6. å®žé™…ç³»ç»Ÿå®žçŽ°

### 6.1. MongoDBæŸ¥è¯¢ä¸Žç´¢å¼•

#### 6.1.1. MongoDBç´¢å¼•ç±»åž‹

**MongoDBç´¢å¼•ç±»åž‹**ï¼š

1. **å•å­—æ®µç´¢å¼•**ï¼šå•ä¸ªå­—æ®µç´¢å¼•
2. **å¤åˆç´¢å¼•**ï¼šå¤šä¸ªå­—æ®µç´¢å¼•
3. **å¤šé”®ç´¢å¼•**ï¼šæ•°ç»„å­—æ®µç´¢å¼•
4. **æ–‡æœ¬ç´¢å¼•**ï¼šå…¨æ–‡æœç´¢ç´¢å¼•
5. **åœ°ç†ç©ºé—´ç´¢å¼•**ï¼šåœ°ç†ä½ç½®ç´¢å¼•

**ç´¢å¼•ç¤ºä¾‹**ï¼š

```javascript
// å•å­—æ®µç´¢å¼•
db.users.createIndex({ email: 1 })

// å¤åˆç´¢å¼•
db.orders.createIndex({ user_id: 1, order_date: -1 })

// æ–‡æœ¬ç´¢å¼•
db.articles.createIndex({ title: "text", content: "text" })

// åœ°ç†ç©ºé—´ç´¢å¼•
db.places.createIndex({ location: "2dsphere" })
```

### 6.2. CassandraæŸ¥è¯¢ä¸Žç´¢å¼•

#### 6.2.1. Cassandraç´¢å¼•

**Cassandraç´¢å¼•ç±»åž‹**ï¼š

1. **ä¸»é”®ç´¢å¼•**ï¼šåˆ†åŒºé”®å’Œèšç±»é”®ç´¢å¼•
2. **äºŒçº§ç´¢å¼•**ï¼šéžä¸»é”®å­—æ®µç´¢å¼•
3. **SASIç´¢å¼•**ï¼šæ–‡æœ¬æœç´¢ç´¢å¼•

**ç´¢å¼•ç¤ºä¾‹**ï¼š

```cql
-- ä¸»é”®ç´¢å¼•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
CREATE TABLE orders (
    user_id UUID,
    order_date TIMESTAMP,
    order_id UUID,
    amount DECIMAL,
    PRIMARY KEY (user_id, order_date, order_id)
);

-- äºŒçº§ç´¢å¼•
CREATE INDEX idx_status ON orders(status);

-- SASIç´¢å¼•
CREATE CUSTOM INDEX idx_user_name ON users(name)
USING 'org.apache.cassandra.index.sasi.SASIIndex'
WITH OPTIONS = {
    'mode': 'CONTAINS',
    'case_sensitive': 'false'
};
```

### 6.3. RedisæŸ¥è¯¢ä¸Žç´¢å¼•

#### 6.3.1. Redisç´¢å¼•

**Redisç´¢å¼•ç‰¹ç‚¹**ï¼š

- **å†…å­˜ç´¢å¼•**ï¼šæ‰€æœ‰ç´¢å¼•åœ¨å†…å­˜ä¸­
- **è‡ªåŠ¨ç´¢å¼•**ï¼šé”®è‡ªåŠ¨ç´¢å¼•
- **æ•°æ®ç»“æž„ç´¢å¼•**ï¼šä¸åŒæ•°æ®ç»“æž„æœ‰ä¸åŒçš„ç´¢å¼•æ–¹å¼

**Rediså“ˆå¸Œç´¢å¼•**ï¼š

```bash
# å“ˆå¸Œè¡¨ç´¢å¼•
HSET user:1 name "Alice" age 30 email "alice@example.com"
HGETALL user:1
HGET user:1 name

# æœ‰åºé›†åˆç´¢å¼•ï¼ˆç”¨äºŽèŒƒå›´æŸ¥è¯¢ï¼‰
ZADD leaderboard 1000 "user:1"
ZRANGE leaderboard 0 9 WITHSCORES
ZRANGEBYSCORE leaderboard 800 1200
```

### 6.4. Neo4jæŸ¥è¯¢ä¸Žç´¢å¼•

#### 6.4.1. Neo4jç´¢å¼•

**Neo4jç´¢å¼•ç±»åž‹**ï¼š

1. **èŠ‚ç‚¹ç´¢å¼•**ï¼šèŠ‚ç‚¹å±žæ€§ç´¢å¼•
2. **å…³ç³»ç´¢å¼•**ï¼šå…³ç³»å±žæ€§ç´¢å¼•
3. **å…¨æ–‡ç´¢å¼•**ï¼šå…¨æ–‡æœç´¢ç´¢å¼•

**ç´¢å¼•ç¤ºä¾‹**ï¼š

```cypher
// åˆ›å»ºèŠ‚ç‚¹ç´¢å¼•
CREATE INDEX ON :User(id)
CREATE INDEX ON :User(email)

// åˆ›å»ºå¤åˆç´¢å¼•
CREATE INDEX ON :User(id, name)

// ä½¿ç”¨ç´¢å¼•
MATCH (u:User {id: 123})
RETURN u

// å…¨æ–‡ç´¢å¼•
CALL db.index.fulltext.createNodeIndex(
  "userFulltext",
  ["User"],
  ["name", "email"]
)
```

---

## 7. æŸ¥è¯¢ä¼˜åŒ–

### 7.1. æŸ¥è¯¢è®¡åˆ’åˆ†æž

#### 7.1.1. æ‰§è¡Œè®¡åˆ’

**æ‰§è¡Œè®¡åˆ’åˆ†æž**ï¼š

- **ç´¢å¼•ä½¿ç”¨**ï¼šæ£€æŸ¥æ˜¯å¦ä½¿ç”¨ç´¢å¼•
- **æ‰«ææ–¹å¼**ï¼šæ£€æŸ¥æ‰«ææ–¹å¼ï¼ˆç´¢å¼•æ‰«æ vs å…¨è¡¨æ‰«æï¼‰
- **æ‰§è¡Œæˆæœ¬**ï¼šè¯„ä¼°æ‰§è¡Œæˆæœ¬

**MongoDBæ‰§è¡Œè®¡åˆ’**ï¼š

```javascript
// æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’
db.orders.find({ user_id: 123 }).explain("executionStats")

// åˆ†æžç»“æžœ
{
  "executionStats": {
    "executionTimeMillis": 10,
    "totalDocsExamined": 1,
    "totalKeysExamined": 1,
    "indexesUsed": ["user_id_1"]
  }
}
```

### 7.2. æŸ¥è¯¢é‡å†™

#### 7.2.1. æŸ¥è¯¢ä¼˜åŒ–

**æŸ¥è¯¢é‡å†™ç­–ç•¥**ï¼š

1. **è°“è¯ä¸‹æŽ¨**ï¼šå°†è°“è¯ä¸‹æŽ¨åˆ°æ•°æ®æº
2. **æŠ•å½±ä¸‹æŽ¨**ï¼šåªé€‰æ‹©éœ€è¦çš„å­—æ®µ
3. **è¿žæŽ¥é‡æŽ’åº**ï¼šä¼˜åŒ–è¿žæŽ¥é¡ºåº

**ä¼˜åŒ–ç¤ºä¾‹**ï¼š

```javascript
// âŒ ä½Žæ•ˆï¼šå…¨è¡¨æ‰«æ
db.orders.find({ $expr: { $eq: [{ $year: "$order_date" }, 2024] } })

// âœ… é«˜æ•ˆï¼šä½¿ç”¨ç´¢å¼•
db.orders.find({
  order_date: {
    $gte: ISODate("2024-01-01"),
    $lt: ISODate("2025-01-01")
  }
})
```

### 7.3. å¹¶è¡ŒæŸ¥è¯¢

#### 7.3.1. å¹¶è¡ŒæŸ¥è¯¢å®žçŽ°

**å¹¶è¡ŒæŸ¥è¯¢**ï¼šå°†æŸ¥è¯¢åˆ†å‘åˆ°å¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œæ‰§è¡Œã€‚

**å¹¶è¡ŒæŸ¥è¯¢æµç¨‹**ï¼š

```mermaid
flowchart TD
    Q[æŸ¥è¯¢è¯·æ±‚] --> R[æŸ¥è¯¢è·¯ç”±å™¨]
    R -->|åˆ†å‘| N1[èŠ‚ç‚¹1]
    R -->|åˆ†å‘| N2[èŠ‚ç‚¹2]
    R -->|åˆ†å‘| N3[èŠ‚ç‚¹3]
    N1 -->|ç»“æžœ| M[ç»“æžœåˆå¹¶]
    N2 -->|ç»“æžœ| M
    N3 -->|ç»“æžœ| M
    M --> R[è¿”å›žç»“æžœ]
```

---

## 8. å®žé™…åº”ç”¨æ¡ˆä¾‹

### 8.1. äº’è”ç½‘è¡Œä¸šï¼šRediså“ˆå¸Œç´¢å¼•

**åœºæ™¯**ï¼š

- ç”¨æˆ·ä¿¡æ¯å­˜å‚¨
- å¿«é€ŸæŸ¥è¯¢
- é«˜å¹¶å‘è®¿é—®

**å®žçŽ°**ï¼š

```bash
# ç”¨æˆ·ä¿¡æ¯å­˜å‚¨
HSET user:1 name "Alice" age 30 email "alice@example.com"

# å¿«é€ŸæŸ¥è¯¢
HGETALL user:1
HGET user:1 name
```

### 8.2. é‡‘èžè¡Œä¸šï¼šCassandraèŒƒå›´æŸ¥è¯¢

**åœºæ™¯**ï¼š

- äº¤æ˜“è®°å½•æŸ¥è¯¢
- æ—¶é—´èŒƒå›´æŸ¥è¯¢
- é«˜åžåé‡

**å®žçŽ°**ï¼š

```cql
-- æ—¶é—´èŒƒå›´æŸ¥è¯¢
SELECT * FROM transactions
WHERE account_id = 123
  AND transaction_time >= '2024-01-01'
  AND transaction_time < '2024-02-01';
```

---

## 9. å½¢å¼åŒ–å®šä¹‰

### 9.1. æŸ¥è¯¢å½¢å¼åŒ–

**æŸ¥è¯¢å®šä¹‰**ï¼š

è®¾æŸ¥è¯¢ $Q$ ä¸ºï¼š

$$Q = (S, P, F)$$

å…¶ä¸­ï¼š

- $S$ï¼šé€‰æ‹©çš„æ•°æ®æº
- $P$ï¼šè°“è¯æ¡ä»¶
- $F$ï¼šæŠ•å½±å­—æ®µ

### 9.2. ç´¢å¼•å½¢å¼åŒ–

**ç´¢å¼•å®šä¹‰**ï¼š

è®¾ç´¢å¼• $I$ ä¸ºï¼š

$$I = \{(k, loc) | k \in K, loc \in L\}$$

å…¶ä¸­ $K$ æ˜¯é”®é›†åˆï¼Œ$L$ æ˜¯ä½ç½®é›†åˆã€‚

---

## 10. å¤šè¡¨å¾

æœ¬ä¸»é¢˜æ”¯æŒå¤šç§è¡¨å¾æ–¹å¼ï¼š

1. **ç¬¦å·è¡¨å¾**ï¼šæŸ¥è¯¢è¯­è¨€ã€ç´¢å¼•å®šä¹‰
2. **å›¾ç»“æž„**ï¼šæŸ¥è¯¢æµç¨‹å›¾ã€ç´¢å¼•ç»“æž„å›¾
3. **ä»£ç å®žçŽ°**ï¼šæŸ¥è¯¢ä»£ç ã€ç´¢å¼•ä»£ç 
4. **è‡ªç„¶è¯­è¨€**ï¼šæ¦‚å¿µå®šä¹‰ã€æŸ¥è¯¢æè¿°
5. **å¯è§†åŒ–**ï¼šæŸ¥è¯¢è®¡åˆ’å¯è§†åŒ–ã€ç´¢å¼•å¯è§†åŒ–

---

## 11. æ€»ç»“ä¸Žå±•æœ›

### 11.1. æ€»ç»“

NoSQLæŸ¥è¯¢ä¸Žç´¢å¼•çš„æ ¸å¿ƒè¦ç‚¹ï¼š

1. **æŸ¥è¯¢æœºåˆ¶**ï¼šé”®å€¼ã€æ–‡æ¡£ã€åˆ—æ—ã€å›¾æŸ¥è¯¢
2. **ç´¢å¼•ç±»åž‹**ï¼šå“ˆå¸Œã€Bæ ‘ã€ä½å›¾ã€å…¨æ–‡ã€å›¾ç´¢å¼•
3. **æŸ¥è¯¢è¯­è¨€**ï¼šMongoDB Queryã€CQLã€Gremlin
4. **ç´¢å¼•ä¼˜åŒ–**ï¼šç´¢å¼•é€‰æ‹©ã€å¤åˆç´¢å¼•ã€è¦†ç›–ç´¢å¼•

### 11.2. å‘å±•è¶‹åŠ¿

**æœªæ¥å‘å±•æ–¹å‘**ï¼š

1. **æ™ºèƒ½ç´¢å¼•**ï¼šAIé©±åŠ¨çš„ç´¢å¼•é€‰æ‹©
2. **è‡ªé€‚åº”ç´¢å¼•**ï¼šæ ¹æ®æŸ¥è¯¢æ¨¡å¼è‡ªåŠ¨è°ƒæ•´ç´¢å¼•
3. **æ··åˆç´¢å¼•**ï¼šç»“åˆå¤šç§ç´¢å¼•ç±»åž‹

---

**å‚è€ƒæ–‡çŒ®**ï¼š

1. MongoDB Query Language: <https://docs.mongodb.com/manual/reference/operator/query/>
2. Cassandra Query Language: <https://cassandra.apache.org/doc/latest/cql/>

---

[è¿”å›žNoSQLå¯¼èˆª](README.md)

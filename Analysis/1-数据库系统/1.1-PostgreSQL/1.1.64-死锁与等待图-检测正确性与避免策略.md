# 1.1.64 死锁与等待图：检测正确性与避免策略（纯形式化）

## 目录

1. 等待图模型
2. 检测与正确性
3. 必要条件与避免

## 1. 模型

- 等待图 WFG=(T,E)，T 为事务，边 i→j 表示 Ti 等待 Tj 持有的资源。

## 2. 检测

- 定理 2.1：存在死锁 ⇔ WFG 含有向环；
  证明：必要性/充分性由资源分配图化约与阻塞定义给出。□
- 定理 2.2：周期性检测在有界时间内发现所有持久死锁；瞬时环可自解不必报错。

## 3. 必要条件与避免

- Coffman 四条件：互斥、占有且等待、不可抢占、循环等待；
- 命题 3.1：破坏任一条件可避免死锁（如总序加锁破坏循环等待）。

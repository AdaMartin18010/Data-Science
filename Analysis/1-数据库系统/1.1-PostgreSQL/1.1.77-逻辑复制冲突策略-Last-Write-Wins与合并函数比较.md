# 1.1.77-逻辑复制冲突策略-Last-Write-Wins与合并函数比较

## 摘要

- 目标：比较 LWW 与通用合并函数（如CRDT）在延迟、冲突频度与正确性上的权衡，给出选择指引。

## 问题定义（形式化）

- 冲突对 (x,v_a,t_a),(x,v_b,t_b)。LWW 选 max(t)；合并函数 g 满足幂等/交换/结合，返回 v_g。
- 评估：正确性(偏序一致)、回放复杂度、审计可解释性。

## 最小示例（可运行）

```sql
-- 冲突统计（示意）
SELECT reason, count(*) FROM pg_stat_subscription_conflicts GROUP BY 1;
```

## 实务要点

- LWW 简单但丢序与信息；适合幂等覆盖字段。
- 合并函数需领域语义，如加和/最大值/集合并；适合指标累积或G-Counter。
- 审计：记录冲突事件、决策和值来源。

## 交叉引用

- `1.1.65-逻辑复制-一致性语义与冲突解算.md`
- `1.1.73-CRDT与最终一致-会合半格与收敛性证明.md`
- `04-部署运维/04.02-分布式与复制.md`

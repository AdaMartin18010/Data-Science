---
title: 1.1.68-数据血缘-why_where_how形式语义
slug: 1.1.68-数据血缘-why_where_how形式语义
tags: []
pg_version: 16
status: draft
last_review: 2025-09-12
owner: TBD
---

﻿# 1.1.68-数据血缘-why_where_how形式语义

## 摘要

- 目标：统一 where/why/how 三类血缘语义，支撑调试、合规与代价可解释性。

## 问题定义（形式化）

- where-lineage: 输出元组 t 的来源元组集合 W(t)。
- why-lineage: 证明集的子集最小解释族 Π(t)。
- how-provenance: 半环代数标注 ⟨N,⊕,⊗⟩ 上的标签传播，得到 t 的证据多项式。

## 最小示例（可运行）

```sql
-- 示例：用注释列保存来源ID（教学示意）
SELECT o.id, o.amount, oi.id AS src_item_id
FROM orders o JOIN order_items oi ON oi.order_id = o.id;
```

## 实务要点

- 生产建议：以外部血缘系统（如日志/ETL编排）收集与回放，数据库内保留关键键。
- 形式化：采用半环标注模型可统一解释与组合证据。
- 代价解释：将血缘用于查询重写与索引选择的可解释性分析。

## 交叉引用

- `1.1.43-半环血缘与代数-证据与不确定性传播.md`
- `1.1.60-物化视图选择-查询重写等价与代价界.md`
- `03-高级特性/03.02-可观测与审计.md`

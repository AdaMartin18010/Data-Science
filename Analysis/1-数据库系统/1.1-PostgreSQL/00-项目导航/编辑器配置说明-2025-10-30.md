# 编辑器配置说明

**创建日期**: 2025-10-30  
**用途**: 自动格式化和规范Markdown文档

---

## 📋 配置文件清单

已创建以下配置文件：

| 文件 | 作用 | 支持编辑器 |
|------|------|-----------|
| `.vscode/settings.json` | VS Code工作区设置 | VS Code |
| `.vscode/extensions.json` | 推荐扩展列表 | VS Code |
| `.editorconfig` | 统一编码风格 | 所有主流编辑器 |
| `.markdownlint.json` | Markdown规则配置 | 支持markdownlint的编辑器 |

---

## 🚀 快速设置（VS Code）

### 1. 安装推荐扩展

打开项目后，VS Code会提示安装推荐扩展：

**核心扩展**（必装）：
- ✅ **Markdown All in One** - Markdown增强功能
- ✅ **markdownlint** - Markdown格式检查和自动修复
- ✅ **Python** - 运行格式化脚本

**可选扩展**（推荐）：
- 📖 **Markdown Preview GitHub Styles** - GitHub风格预览
- 🔍 **Code Spell Checker** - 拼写检查
- 🎨 **vscode-icons** - 文件图标

### 2. 验证配置生效

1. 打开任意Markdown文件
2. 保存文件（Ctrl+S / Cmd+S）
3. 观察是否自动格式化

---

## ⚙️ 配置详解

### settings.json（VS Code工作区设置）

```json
{
  "[markdown]": {
    "editor.formatOnSave": true,  // 保存时自动格式化
    "editor.wordWrap": "on"        // 自动换行
  }
}
```

**主要功能**：

✅ **保存时自动格式化**
- 自动修复标题序号
- 统一列表缩进
- 清理多余空行
- 删除行尾空格

✅ **Markdown Lint规则**
- MD001: 标题层级不跳跃
- MD003: 统一使用ATX风格（`#`）
- MD004: 统一使用破折号（`-`）作为列表标记
- MD040: 代码块必须指定语言
- MD041: 首行必须是H1标题
- MD047: 文件末尾必须有空行

✅ **文件保存优化**
- 删除行尾空格
- 确保文件末尾有换行
- 统一使用UTF-8编码
- 统一使用LF换行符

### .editorconfig（通用编辑器配置）

```ini
[*.md]
indent_style = space
indent_size = 2
charset = utf-8
```

**支持的编辑器**：
- VS Code
- IntelliJ IDEA / WebStorm
- Sublime Text
- Atom
- Vim / Neovim
- Emacs

**作用**：
- 统一缩进风格（2个空格）
- 统一字符编码（UTF-8）
- 统一换行符（LF）

### .markdownlint.json（Markdown规则）

```json
{
  "MD013": false,  // 不限制行长度（中文不好控制）
  "MD024": {       // 允许同名标题（我们有序号区分）
    "siblings_only": true
  },
  "MD033": false   // 允许内联HTML（表格等）
}
```

---

## 📝 实际效果演示

### Before（保存前）

```markdown
##项目概述
### 功能特性
核心功能...  

###   系统架构  
```

### After（保存后）

```markdown
## 1. 项目概述

### 1.1 功能特性

核心功能...

## 2. 系统架构
```

**自动完成**：
- ✅ H2标题添加序号
- ✅ H3标题添加两级序号
- ✅ 标题前后添加空行
- ✅ 删除多余空格
- ✅ 统一缩进

---

## 🔧 自定义配置

### 修改Markdown规则

编辑 `.markdownlint.json`：

```json
{
  // 启用/禁用某个规则
  "MD013": false,  // false = 禁用
  "MD040": true,   // true = 启用
  
  // 配置规则参数
  "MD007": {
    "indent": 2    // 列表缩进2个空格
  }
}
```

### 修改保存行为

编辑 `.vscode/settings.json`：

```json
{
  "[markdown]": {
    // 关闭保存时格式化
    "editor.formatOnSave": false,
    
    // 或仅在手动格式化时生效
    "editor.formatOnType": true
  }
}
```

---

## 🎯 使用技巧

### 1. 手动格式化

如果关闭了自动格式化，可以手动触发：

**Windows/Linux**: `Shift + Alt + F`  
**macOS**: `Shift + Option + F`

### 2. 批量格式化

使用我们的Python脚本批量处理：

```bash
python format_docs.py 01-核心基础/ 02-查询处理/
```

### 3. 忽略特定规则

在文档中添加注释：

```markdown
<!-- markdownlint-disable MD033 -->
这里允许使用HTML
<div>...</div>
<!-- markdownlint-enable MD033 -->
```

### 4. 查看格式问题

在VS Code中：
- 查看 **问题面板**（Ctrl+Shift+M）
- 黄色波浪线表示警告
- 红色波浪线表示错误

---

## 📊 Markdown Lint规则说明

### 启用的规则

| 规则 | 说明 | 原因 |
|------|------|------|
| MD001 | 标题层级增量为1 | 确保结构清晰 |
| MD003 | 使用ATX风格标题 | 统一标题格式 |
| MD004 | 统一无序列表标记 | 使用 `-` |
| MD022 | 标题周围需要空行 | 提高可读性 |
| MD025 | 只能有一个H1标题 | 文档标题唯一 |
| MD040 | 代码块指定语言 | 语法高亮 |
| MD041 | 首行是H1标题 | 文档结构 |
| MD047 | 文件末尾空行 | 标准格式 |

### 禁用的规则

| 规则 | 说明 | 原因 |
|------|------|------|
| MD013 | 行长度限制 | 中文不好控制 |
| MD033 | 禁止HTML | 我们需要表格等 |
| MD014 | 命令前缀$ | bash示例需要 |

---

## 🐛 常见问题

### Q1: 保存后没有自动格式化？

**检查项**：
1. ✅ 是否安装了markdownlint扩展？
2. ✅ 是否在.md文件中？
3. ✅ 设置中`formatOnSave`是否为true？
4. ✅ 重启VS Code试试

**解决方案**：
```bash
# 1. 检查扩展
Ctrl+Shift+X 搜索 "markdownlint"

# 2. 检查设置
Ctrl+, 搜索 "format on save"

# 3. 重新加载窗口
Ctrl+Shift+P → "Reload Window"
```

### Q2: 格式化破坏了我的内容？

**原因**：某些规则可能不适合特定内容

**解决方案**：
```markdown
<!-- 在特定区域禁用规则 -->
<!-- markdownlint-disable MD033 -->
<table>...</table>
<!-- markdownlint-enable MD033 -->

<!-- 或禁用整个文件 -->
<!-- markdownlint-disable -->
```

### Q3: 代码块里的内容被修改了？

**原因**：不应该发生，代码块内容应该被保护

**解决方案**：
- 确保代码块使用\`\`\`包裹
- 确保指定了语言标识符
- 如果问题持续，禁用该规则

### Q4: 其他编辑器怎么使用？

**IntelliJ IDEA / WebStorm**：
- 自动读取`.editorconfig`
- 安装Markdown插件

**Sublime Text**：
- 安装EditorConfig插件
- 安装MarkdownLint插件

**Vim / Neovim**：
- 安装vim-editorconfig
- 安装ale或coc-markdownlint

---

## 🔄 与格式化脚本的关系

| 工具 | 用途 | 时机 | 优势 |
|------|------|------|------|
| **编辑器配置** | 实时格式化 | 编辑和保存时 | 即时反馈 |
| **format_docs.py** | 批量处理 | 手动执行 | 批量高效 |

**推荐工作流**：
1. 使用编辑器配置进行日常编辑
2. 定期运行脚本进行批量检查
3. 提交前最后检查一次

---

## 📚 参考资源

### Markdown Lint规则
- [官方规则文档](https://github.com/DavidAnson/markdownlint/blob/main/doc/Rules.md)
- [规则详细说明](https://github.com/DavidAnson/markdownlint/blob/main/doc/md001.md)

### EditorConfig
- [官方网站](https://editorconfig.org/)
- [支持的编辑器](https://editorconfig.org/#download)

### VS Code
- [Markdown支持](https://code.visualstudio.com/docs/languages/markdown)
- [工作区设置](https://code.visualstudio.com/docs/getstarted/settings)

---

## 🎉 总结

### 配置完成后的效果

✅ **保存即格式化**
- 无需手动调整格式
- 自动修复常见问题
- 统一团队编码风格

✅ **实时反馈**
- 波浪线提示问题
- 悬停显示解释
- 一键快速修复

✅ **跨编辑器支持**
- `.editorconfig`通用
- 团队协作无障碍
- 无需额外培训

---

## ✨ 下一步

1. **安装扩展**：
   - 打开VS Code
   - 查看推荐扩展提示
   - 点击"安装所有"

2. **测试效果**：
   - 打开任意.md文件
   - 故意写一些不规范的格式
   - 保存后观察自动修复

3. **开始使用**：
   - 正常编辑文档
   - 保存时自动格式化
   - 享受高效编辑体验！

---

**配置状态**: ✅ 完成  
**生效范围**: 当前项目（1.1-PostgreSQL目录）  
**维护者**: Documentation Team

**最后更新**: 2025-10-30  
**版本**: 1.0


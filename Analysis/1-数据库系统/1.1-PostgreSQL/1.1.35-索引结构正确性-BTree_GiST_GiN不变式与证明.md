---
title: 1.1.35-索引结构正确性-BTree_GiST_GiN不变式与证明
slug: 1.1.35-索引结构正确性-BTree_GiST_GiN不变式与证明
tags: []
pg_version: 16
status: draft
last_review: 2025-09-12
owner: TBD
---

# 1.1.35 索引结构正确性：B-Tree/GiST/GIN 不变式与证明（纯形式化）

## 目录

1. B-Tree 不变式与查找/插入正确性
2. GiST 抽象接口与不变式
3. GIN 倒排结构与合取/析取语义

## 1. B-Tree

- 不变式：
  - 节点键有序；区间不交且覆盖；
  - 所有叶子同深；
  - 父子区间一致性：子键域 ⊆ 父分隔区间。
- 定理 1.1（查找正确性）：沿分支依据分隔键选择唯一子树，叶命中当且仅当键存在。
  证明纲要：由有序与覆盖不变式归纳。
- 定理 1.2（插入后不变式保持）：分裂与提升维持区间覆盖与高度平衡。

## 2. GiST

- 抽象：统一索引接口；谓词 Consistent/Union/Penalty/Split。
- 不变式：每节点存包围区域；子项域包含于父区域；
- 定理 2.1：若 Consistent/Union 满足覆盖/单调，查找的完全性与最小假阴成立。

## 3. GIN

- 倒排映射：项→包含项的主键集合；
- 定理 3.1（布尔检索语义）：AND/OR 查询的结果等价于集合交/并；
- 定理 3.2（更新正确性）：插入/删除在倒排表的增量维护保持语义不变。

---
title: 08.02-知识图谱构建
slug: 08.02-知识图谱构建
tags: []
pg_version: 16
status: draft
last_review: 2025-09-12
owner: TBD
---

﻿# 08.02-知识图谱构建

## 概述

- 目标：以 PostgreSQL 为后端实现轻量级知识图谱（实体/关系/属性）存储、查询与对齐。

## 流程

1) 抽取：从文档/日志/结构化表抽取实体与关系；
2) 对齐：标准化命名，对齐外部词表/ID（Wikidata/自有词库）；
3) 存储：实体、关系、属性三表或属性图两表；
4) 查询：路径查询、邻域聚合、属性过滤；
5) 维护：去重、合并、版本化与审计。

## 表结构示例

```sql
CREATE TABLE kg_entity (
  id bigserial PRIMARY KEY,
  type text NOT NULL,
  name text,
  attrs jsonb NOT NULL DEFAULT '{}'
);

CREATE TABLE kg_relation (
  id bigserial PRIMARY KEY,
  src bigint NOT NULL REFERENCES kg_entity(id) ON DELETE CASCADE,
  dst bigint NOT NULL REFERENCES kg_entity(id) ON DELETE CASCADE,
  type text NOT NULL,
  attrs jsonb NOT NULL DEFAULT '{}'
);

CREATE INDEX idx_kg_entity_type ON kg_entity(type);
CREATE INDEX idx_kg_rel_src ON kg_relation(src);
CREATE INDEX idx_kg_rel_dst ON kg_relation(dst);
```

## 查询示例

```sql
-- 两跳邻接
SELECT e2.*
FROM kg_entity e1
JOIN kg_relation r1 ON r1.src = e1.id AND r1.type = 'works_at'
JOIN kg_relation r2 ON r2.src = e1.id AND r2.type = 'lives_in'
JOIN kg_entity e2 ON e2.id = r1.dst
WHERE e1.name = 'Alice';
```

## 实践建议

- 标准化：统一实体类型/关系类型字典；
- 数据质量：去重规则、相似度阈值、人工校验通道；
- 索引与分区：大型图分区与热点索引；
- 可视化：对接图谱可视化工具（Gephi、Graphistry）导出视图。

## 参考

- `03-高级特性/03.06-图数据库功能.md`
- `1.1.98-数据库JSON数据模型-JSON查询与模式验证的形式化.md`

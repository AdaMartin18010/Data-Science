---
title: 查询重写与代价边界-规范纲要
slug: 查询重写与代价边界-规范纲要
tags: []
pg_version: 16
status: draft
last_review: 2025-09-12
owner: TBD
---

# 规范纲要：查询重写与代价边界（占位）

## 目标

总结可证明/可验证的查询重写等价条件与代价模型边界，关注 JSON/MERGE 等 17.x 新特性。

## 元素

- 代数：选择、投影、连接、聚合、半连接、反连接
- 特性影响：JSON_TABLE、MERGE RETURNING 对计划与物化的影响

## 等价骨架（示例）

- 选择下推条件与谓词独立性
- 连接交换/结合的前提条件
- 视图可更新性与 MERGE 的交互约束

## 代价边界（示例）

- 多列相关导致选择率估计误差上界
- IN 列表大小与索引访问策略切换点

## 验证与反例

- 最小反例集合与可复现实验脚本占位

### 最小 SQL 片段（占位）

```sql
-- 选择下推前后等价验证
EXPLAIN (ANALYZE, BUFFERS)
SELECT * FROM t1 JOIN t2 ON t1.k = t2.k WHERE t1.a > 10;

-- IN 策略切换点验证（结合基准）
-- 列表规模：10/100/1000，观测计划与耗时变化
```

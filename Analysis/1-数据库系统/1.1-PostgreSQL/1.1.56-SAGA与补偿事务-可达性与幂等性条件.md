# 1.1.56 SAGA 与补偿事务：可达性与幂等性条件（纯形式化）

## 目录

1. 模型与序列化图
2. 补偿与回滚条件
3. 可达性与幂等性

## 1. 模型

- SAGA = ⟨T1,…,Tn; C1,…,Cn⟩，Ti 正向步骤，Ci 补偿步骤；

## 2. 正确性

- 不变式：每一步要么提交 Ti，要么执行 Ci 使不变式回到上一阶段；
- 定理 2.1：若每个 Ci 为 Ti 的左逆（在可观察等价下），则序列在失败时可回到一致状态。

## 3. 可达性/幂等

- 定理 3.1：若每个 Ti 与 Ci 幂等，且补偿图无环依赖，则补偿策略可终止且最终一致。

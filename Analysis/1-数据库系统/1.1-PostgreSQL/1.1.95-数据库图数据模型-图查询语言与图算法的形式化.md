# 1.1.95-数据库图数据模型-图查询语言与图算法的形式化

## 摘要

- 目标：以属性图模型刻画顶点/边与属性，讨论图查询（路径、邻域）与基础算法在PostgreSQL生态的落地实践。

## 问题定义（形式化）

- 图 G=(V,E,AV,AE)。查询语言包含邻接遍历与路径约束；算法如BFS、PageRank等在关系代数上实现需迭代/递归。

## 最小示例（可运行）

```sql
-- 顶点与边（关系化表示）
CREATE TABLE vertex (id bigint primary key, label text, props jsonb);
CREATE TABLE edge (
  src bigint, dst bigint, label text, props jsonb,
  primary key (src, dst, label)
);

-- 一跳邻居
SELECT v2.* FROM edge e JOIN vertex v2 ON e.dst = v2.id WHERE e.src = 1;

-- 递归查询（示意：多跳）
WITH RECURSIVE reach(id, depth) AS (
  SELECT 1, 0
  UNION ALL
  SELECT e.dst, r.depth+1 FROM reach r JOIN edge e ON e.src = r.id WHERE r.depth < 3
)
SELECT * FROM reach;
```

## 实务要点

- 存储权衡：关系化建模+递归SQL适合中小规模；大规模考虑外部图引擎或扩展。
- 索引：边表(src,dst)，顶点属性表达式索引；热点图可做分区或社区切分。
- 算法：迭代算法在SQL用递归CTE/临时表；性能敏感时在外部批处理。

## 交叉引用

- `1.1.3-数据模型.md`
- `1.1.20-PostgreSQL与AI模型深度集成架构.md`
- `03-高级特性/03.03-扩展与自定义类型.md`

---
title: 1.1.97-数据库空间数据模型-空间索引与空间查询的形式化
slug: 1.1.97-数据库空间数据模型-空间索引与空间查询的形式化
tags: []
pg_version: 16
status: draft
last_review: 2025-09-12
owner: TBD
---

﻿# 1.1.97-数据库空间数据模型-空间索引与空间查询的形式化

## 摘要

- 目标：以PostGIS为例，刻画空间对象与R-Tree/GiST索引的查询语义与最小实践。

## 问题定义（形式化）

- 空间对象集 S 上定义谓词（相交、包含、距离≤r）。索引结构近似包围盒（MBR）层级，查询以剪枝+精确判定两阶段执行。

## 最小示例（可运行）

```sql
-- PostGIS 示例：点在多边形内
CREATE EXTENSION IF NOT EXISTS postgis;
CREATE TABLE poi (id serial primary key, geom geometry(Point, 4326));
CREATE INDEX idx_poi_geom ON poi USING gist (geom);

-- 范围查询（与多边形相交）
SELECT id FROM poi
WHERE ST_Intersects(geom, ST_GeomFromText('POLYGON((0 0,0 1,1 1,1 0,0 0))', 4326));
```

## 实务要点

- 坐标系：统一SRID；投影选择影响距离/面积计算。
- 索引维护：批量导入后再建索引；更新频繁对象考虑聚簇或分区。
- 精度与性能：先粗过滤（索引MBR），后精确判定（ST_*）。

## 交叉引用

- `1.1.3-数据模型.md`
- `02-查询处理/02.01-查询优化器原理.md`
- `03-高级特性/03.03-扩展与自定义类型.md`

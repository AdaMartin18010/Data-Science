---
title: 1.1.90-数据库安全模型-访问控制与信息流安全的形式化
slug: 1.1.90-数据库安全模型-访问控制与信息流安全的形式化
tags: []
pg_version: 16
status: draft
last_review: 2025-09-12
owner: TBD
---

﻿# 1.1.90 数据库安全模型：访问控制与信息流安全的形式化

## 1. 模型概述

- 访问控制：基于角色/权限（GRANT/REVOKE）、对象级/列级/函数级；
- 行级安全（RLS）：基于策略的行过滤与写入检查；
- 信息流安全：限制高敏感级别数据向低敏感级别通道泄露（非干扰）。

## 2. 访问控制要点

- 最小权限：仅授予必要的对象权限；
- 架构隔离：按业务域划分 schema 与所有权；
- 审计留痕：启用审计扩展/日志策略（见 1.1.91）。

```sql
-- 角色与授权示例
CREATE ROLE app_user LOGIN;
GRANT USAGE ON SCHEMA app TO app_user;
GRANT SELECT, INSERT ON app.orders TO app_user;
```

## 3. RLS 策略

- 启用：`ALTER TABLE ... ENABLE ROW LEVEL SECURITY;`；
- 读写策略：`USING` 控制可见行，`WITH CHECK` 控制可写行；
- 多租户：基于 `tenant_id = current_setting('app.tenant')::int` 的策略。

```sql
ALTER TABLE orders ENABLE ROW LEVEL SECURITY;
CREATE POLICY p_orders_read ON orders 
  FOR SELECT USING (tenant_id = current_setting('app.tenant')::int);
CREATE POLICY p_orders_write ON orders 
  FOR INSERT WITH CHECK (tenant_id = current_setting('app.tenant')::int);
```

## 4. 信息流安全（摘要形式化）

- 安全级 \(L\) 的偏序 \(\sqsubseteq\)；标签函数 \(\lambda: Obj\to L\)；
- 非干扰：若 \(u_1 \sqsubset u_2\)，则 \(u_1\) 的可观测结果不应受 \(u_2\) 专属数据影响；
- 实务：通过视图/RLS/存储过程边界实现“降级”点的白名单化。

## 5. 工程建议

- 密钥与凭据：使用外部密钥管理，避免明文；
- 审批与分权：区分管理员/应用/只读角色；
- 加密：传输/静态加密，列级敏感字段加密或脱敏；
- 合规：与审计策略、数据保留/删除策略联动。

## 6. 交叉引用

- `1.1.71-外连接与NULL-三值逻辑的形式语义.md`
- `1.1.70-行级安全-RLS策略语义与不可逃逸性证明.md`
- `1.1.91-数据库审计与合规-完整性约束与审计轨迹的形式化.md`

# 1.1.70 行级安全（RLS）：策略语义与不可逃逸性证明（纯形式化）

## 目录

1. 策略语义与上下文
2. 组合性与可达查询
3. 不可逃逸性（non-bypass）

## 1. 语义

- 每表赋予谓词 P_u(r,c) 判定用户 u、上下文 c 对行 r 的可见性；
- 查询语义以 P_u 作为选择前置：Q_RLS = Q∘σ_{P_u}。

## 2. 组合性

- 定理 2.1：在SPJ片段，RLS前置与查询组合满足同态性：Q(σ_{P_u} R) 与 σ_{P_u'} Q(R) 等价，当且仅当 P_u' 为 P_u 的自然提升到输出域。

## 3. 不可逃逸

- 定理 3.1：若所有数据进入查询前均经 σ_{P_u}，且禁止任意副通道（如错误信息泄露、计时侧信道），则用户对结果可观察集受 P_u 上界约束，不能绕过策略。
  证明纲要：以观测等价关系 ~_u，证明 Q_RLS 在 ~_u 下为同态，任何替换不改变观测。□

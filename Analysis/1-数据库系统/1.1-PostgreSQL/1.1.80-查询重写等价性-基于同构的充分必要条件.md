# 1.1.80 查询重写等价性：基于同构的充分必要条件（纯形式化）

## 目录

1. 查询图模型
2. 同构与等价
3. 充分必要条件

## 1. 模型

- 查询表示为有向图：节点为关系/谓词，边为连接条件；
- 同构：存在双射保持节点标签与边属性。

## 2. 等价

- 定义：两查询在所有数据库实例上返回相同结果；
- 同构蕴含等价（结构相同则语义相同）。

## 3. 条件

- 定理：SPJ查询等价当且仅当存在同构（充分性：同构→等价；必要性：等价→同构）；
- 证明纲要：充分性显然；必要性通过构造反例数据库，若不同构则存在实例区分两查询。□
